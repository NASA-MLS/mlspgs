#!/bin/sh
#    README.tests        Instructions about building the mls software
# Copyright (c) 2001, California Institute of Technology.  ALL RIGHTS RESERVED.
# U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.

# "$Id$"
# A self-reading guide to testing the mls software;
# usage: README.tests
# related documents:
#  README.MakeFC     a self-reading guide to building the software
#  BEFORE.mls        a self-reading guide to prerequisites to the software

        more << EOF
tests--A set of subdirectories for testing the different levels of the mls
software during development. Also a special subdirectory misc to allow you to
build and run stand-alone software without reference to the mls software.

SUMMARY
To test the mls software first make sure that you have properly built each of
the levels with the following set of names: {l1 l2 l3 l3m fwdmdl cloudfwdm lib}.
These are the subdirectories in the parent directory to tests, which is the one
where you are reading this. For more information on building the mls software,
enter ../README.MakeFC. Sub-directories with the same set of names are
contained in tests, and they are intended to allow easy testing of the
corresponding level of the mls software.

INTRODUCTION
During development it may be necessary to test portions of the mls software
apart from its driver, PCF files, or other complicating circumstances that may
prevent a clear picture of where a problem is occurring. For example, a simple
case might be to test reading a L2GP vector from a template file using the
modules in lib. Another example might be to test coordination among the parts
of the retrieval algorithm with the modules in fwdmdl.

To make this easy, most of the steps have been automated, so you are required
to do only the following:

METHOD
(1) Choose which of the levels {l1 l2 l3 l3m fwdmdl cloudfwdm lib} contains what
    needs to be tested; call this _level_

(2) Write a test program that USE's the modules of _level_ to be tested

(3) Copy that test program to tests/_level_ 
    (if there are any sources there already, hide or remove them)

(4) cd tests/_level_

(5) make depends ghostbuster

(6) make

and run the resulting test program with suitable data.

If instead you simply wish to build and test stand-alone software, copy the
sources into tests/misc (after hiding or removing any sources already there)
and carry out (4)-(6) above. Note that from misc you can access the toolkit and
its full panoply. You will not "see" any of the mls lib or any other level,
however If you need any modules out of any mls level, you should probably be
building in the tests counterpart of that level.

WARNINGS
Since the modules of level to be USE'd by test will not include _level_'s own
driver, any internal subprograms inside that driver may have to copied to the
test program if they are needed during the test. Don't forget to make any
needed declarations, assignments, allocations, and so on.

No debugging flags have been set among the the compiler switches. Setting them
for the test program might not accomplish what is really desired, anyway, which
might be intermediate data within a module of _level_. For a future refinement
of this automatic build and test procedure, a debug option may be set during
configuration which would facilitate obtaining the immediate results upon
passing steps defined as milestones in the course of computation.

The lib test requires a special word of warning. A copy of init_tables_module
is required to link properly with the test program and modules in the source
library. By default, this copy of init_tables_module is taken from l2. If not
appropriate for the test case you are considering, you have two choices:
(1) Carry out the test in another level, i.e. l1 or l3

(2) Edit the file tests/lib/platforms/\$(MLSCONFG)
at the following lines: (line 27)

  # This is the directory name from which we will get init_tables_module
  # (one of l1, l2, or l3)
  init_m_dir = l2

and change the assignment to l1 or l3. Then 
	make mostlyclean 
to remake the file tests/lib/\$(MLSCONFG)/Makefile in accord with this change,
and then
	make

Similar warnings and procedures apply to fwdmdl and cloudfwdm. l3m gets its
init_tables_module from mlspgs/l3, just like its counterpart mlspgs/l3m.

What about testing a new init_tables_module? Say you want to get the
init_tables_module, not from init_m_dir but from tests/_level_ itself? I
haven't tested this yet. In general, substituting a much-USEd module for the
original in mlspgs/_level_ is unsafe because the modules that USE it are
not being recompiled. Rather than a mere warning, this last point should
perhaps be elevated to being a bug.

-pw                           2001-Feb-01 to 2001-July-24
EOF
exit
# $Log$
# Revision 1.4  2001/07/16 20:57:46  pwagner
# Mentions tests/misc
#
# Revision 1.3  2001/05/19 00:06:25  pwagner
# Changes to reflect new ways to invoke MakeFC
#
# Revision 1.2  2001/03/06 18:17:57  pwagner
# clean more amitious--rms * from MLSCONFGl[13]/MakeFC
#
# Revision 1.1  2001/02/01 23:09:33  pwagner
# First commit
#
