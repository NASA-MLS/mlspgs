head	1.3;
access;
symbols
	v5-02-NRT-19:1.3
	v6-00:1.3
	v5-02-NRT-18:1.3
	v5-02:1.3
	v5-01-NRT-17:1.3
	v5-01-NRT-16:1.3
	v5-01-NRT-15:1.3
	v5-01-NRT-14:1.3
	neuralnetworks-1-0:1.3.0.10
	cfm-single-freq-0-1:1.3.0.8
	v5-01:1.3
	v5-00:1.3
	v4-23-TA133:1.3.0.6
	mus-emls-1-70:1.3.0.4
	rel-1-0-englocks-work:1.3.0.2
	VUMLS1-00:1.3
	VPL1-00:1.3
	V4-22-NRT-08:1.3
	VAM1-00:1.2
	V4-21:1.2.0.2
	V4-13:1.2
	V4-12:1.2
	V4-11:1.2
	V4-10:1.2
	M4-00:1.2
	V3-33:1.2;
locks; strict;
comment	@# @;


1.3
date	2016.02.04.23.10.08;	author pwagner;	state Exp;
branches;
next	1.2;

1.2
date	2011.09.07.06.33.35;	author honghanh;	state Exp;
branches;
next	1.1;

1.1
date	2011.06.08.21.24.36;	author honghanh;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Added notation about sig_fwdmdl
@
text
@; This subroutine utilize some subroutines in AtGod
; Use pvm to send input, receive output, and contact
; the Fortran library's Forward Model server (addressable by its tid)
pro ForwardModel, tid, info, mafNo, state, stateExtra, outputTemplate, output, jacobian=jacobian, doDerivative=doDerivative
    if keyword_set(doDerivative) then doDerivative = 1L else doDerivative = 0L

    bufid = pvm_initsend()

    pvm_pack_idltypeinfo, 2L ;sig_fwdmdl
    pvm_pack_idlvariable, 2L

    icfm_sendvector, state, /packonly
    icfm_sendvector, stateExtra, /packonly
    icfm_sendvector, outputTemplate, /packonly

    pvm_pack_idltypeinfo, doDerivative
    pvm_pack_idlvariable, doDerivative

    mafNo = long(mafNo)
    pvm_pack_idltypeinfo, mafNo
    pvm_pack_idlvariable, mafNo

    msgtag = 200L

    if n_elements(tid) eq 1 then info = pvm_send(tid=tid(0), msgtag=msgtag) $
    else info = pvm_mcast(tids=tid, msgtag=msgtag)

    ; using AtMatrix requires using AtGod
    icfm_receivequantities, output, tid=tid, msgtag=msgtag
    ;createvector, output, measurement.name
    ;for i=0, n_tags(quantities)-1 do begin
    ;    addquantity2vector, output, quantities.(i), /overwrite
    ;endfor

    msgtag = 202L ; different for receiving matrix
    if doDerivative then icfm_receivematrix, jacobian, tid, msgtag
end
; $Log: PVMIDL.f90,v $
@


1.2
log
@Add 3 more procedures to receive matrix
Add 'stacked' concept to createquantity, and icfm_sendquantity
and related procedures.
@
text
@d2 2
d9 1
a9 1
    pvm_pack_idltypeinfo, 2L
d38 1
@


1.1
log
@Initial import of the IDL portion of IDLCFM (a.k.a. ICFM)
@
text
@d2 3
a4 1
pro ForwardModel, tid, info, mafNo, state, stateExtra, measurement, output
d12 4
a15 1
    icfm_sendvector, measurement, /packonly
d26 2
a27 1
    icfm_receivequantities, output, tid, msgtag
d32 3
@

