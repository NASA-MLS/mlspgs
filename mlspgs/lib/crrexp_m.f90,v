head	2.3;
access;
symbols
	v5-02-NRT-19:2.3
	v6-00:2.3
	v5-02-NRT-18:2.3
	v5-02:2.3
	v5-01-NRT-17:2.3
	v5-01-NRT-16:2.3
	v5-01-NRT-15:2.3
	v5-01-NRT-14:2.3
	neuralnetworks-1-0:2.3.0.14
	cfm-single-freq-0-1:2.3.0.12
	v5-01:2.3
	v5-00:2.3
	v4-23-TA133:2.3.0.10
	mus-emls-1-70:2.3.0.8
	rel-1-0-englocks-work:2.3.0.6
	VUMLS1-00:2.3
	VPL1-00:2.3
	V4-22-NRT-08:2.3
	VAM1-00:2.3
	V4-21:2.3.0.4
	V4-13:2.3
	V4-12:2.3
	V4-11:2.3
	V4-10:2.3
	V3-43:2.3
	M4-00:2.3
	V3-41:2.3
	V3-40-PlusGM57:2.3.0.2
	V2-24-NRT-04:2.2
	V3-33:2.3
	V2-24:2.2
	V3-31:2.3
	V3-30-NRT-05:2.3
	cfm-01-00:2.3
	V3-30:2.3
	V3-20:2.3
	V3-10:2.3
	V2-23-NRT-02:2.2
	V2-23:2.2
	V2-22-NRT-01:2.2
	V2-22:2.2
	V2-21:2.2
	V2-20:2.2
	V2-11:2.2
	V2-10:2.2
	V2-00:2.2
	V1-51:2.1
	V1-50:2.1
	V1-45:2.1
	V1-44:2.1
	V1-43:2.1
	V1-42:2.1
	V1-41:2.1
	V1-32:2.1
	V1-40:2.1
	V1-31:2.1
	V1-30:2.1
	newfwm-feb03:1.1.0.2;
locks; strict;
comment	@# @;


2.3
date	2009.06.23.18.25.43;	author pwagner;	state Exp;
branches;
next	2.2;

2.2
date	2005.06.22.17.25.48;	author pwagner;	state Exp;
branches;
next	2.1;

2.1
date	2003.05.05.23.00.05;	author livesey;	state Exp;
branches;
next	1.1;

1.1
date	2003.04.16.19.59.22;	author vsnyder;	state dead;
branches
	1.1.2.1;
next	;

1.1.2.1
date	2003.04.16.19.59.22;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.3
log
@Prevent Intel from optimizing ident string away
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

module CRREXP_M

  implicit NONE
  private
  public CRREXP, CRREXP_1, REXP, RREXP, SREXP

  interface CRREXP;   module procedure CRREXP_,   ZRREXP_;   end interface
  interface CRREXP_1; module procedure CRREXP_1_, ZRREXP_1_; end interface
  interface REXP;     module procedure SREXP,     DREXP;     end interface
  interface RREXP;    module procedure SRREXP,    DRREXP;    end interface


!---------------------------- RCS Module Info ------------------------------
  character (len=*), private, parameter :: ModuleName= &
       "$RCSfile: $"
  private :: not_used_here 
!---------------------------------------------------------------------------

contains

  pure function CRREXP_ ( Z ) result ( CRREXP )

!{ Evaluate $\frac{e^z-1}z$ as
!  $\frac{\overline{z}}{|z|^2} \left[ e^{i y} ( e^x - 1 ) + e^{i y} - 1 \right ] =
!   \frac{\overline{z}}{|z|^2}
!    \left[ e^{i y} ( e^x - 1 ) + \cos y - 1 + i \sin y \right ]$.  The
!  reason to arrange the computation in this way is that both $e^x-1$ and
!  $\cos y -1$ can be computed without cancellation if care is taken (write
!  a few terms of their Taylor series and you'll agree).

    integer, parameter :: RK = kind(0.0e0)
    complex(rk) :: CRREXP
    complex(rk), intent(in) :: Z
    include 'crrexp.f9h'
  end function CRREXP_

  pure function ZRREXP_ ( Z ) result ( CRREXP )

!{ Evaluate $\frac{e^z-1}z$ as
!  $\frac{\overline{z}}{|z|^2} \left[ e^{i y} ( e^x - 1 ) + e^{i y} - 1 \right ] =
!   \frac{\overline{z}}{|z|^2}
!    \left[ e^{i y} ( e^x - 1 ) + \cos y - 1 + i \sin y \right ]$.  The
!  reason to arrange the computation in this way is that both $e^x-1$ and
!  $\cos y -1$ can be computed without cancellation if care is taken (write
!  a few terms of their Taylor series and you'll agree).

    integer, parameter :: RK = kind(0.0d0)
    complex(rk) :: CRREXP
    complex(rk), intent(in) :: Z
    include 'crrexp.f9h'
  end function ZRREXP_

  pure function CRREXP_1_ (X) result ( CRREXP_1 )
!>> 2002-12-27 WVSnyder  Adapted from SRREXP
!--S replaces "?": ?REXP
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION ( EXP(X) - 1 ) / X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0e0)
    complex(rk) :: CRREXP_1
    complex(rk), intent(in) :: X
    include 'crrexp_1.f9h'
  end function CRREXP_1_

  pure function ZRREXP_1_ (X) result ( CRREXP_1 )
!>> 2002-12-27 WVSnyder  Adapted from SRREXP
!--S replaces "?": ?REXP
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION ( EXP(X) - 1 ) / X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0d0)
    complex(rk) :: CRREXP_1
    complex(rk), intent(in) :: X
    include 'crrexp_1.f9h'
  end function ZRREXP_1_

  elemental function SREXP (X) result ( REXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION EXP(X) - 1
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0e0)
    real(rk) :: REXP
    real(rk), intent(in) :: X
    include 'rexp.f9h'
  end function SREXP

  elemental function DREXP (X) result ( REXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION EXP(X) - 1
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0d0)
    real(rk) :: REXP
    real(rk), intent(in) :: X
    include 'rexp.f9h'
  end function DREXP

  elemental function SRREXP (X) result ( RREXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION (EXP(X) - 1)/X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0e0)
    real(rk) :: RREXP
    real(rk), intent(in) :: X
    include 'rrexp.f9h'
  end function SRREXP

  elemental function DRREXP (X) result ( RREXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION (EXP(X) - 1)/X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0d0)
    real(rk) :: RREXP
    real(rk), intent(in) :: X
    include 'rrexp.f9h'
  end function DRREXP

!-----------------------------------------------------------------------
!--------------------------- end bloc --------------------------------------
  logical function not_used_here()
  character (len=*), parameter :: IdParm = &
       "$Id: read_apriori.f90 is it here $"
  character (len=len(idParm)) :: Id = idParm
    not_used_here = (id(1:1) == ModuleName(1:1))
    print *, Id ! .mod files sometimes change if PRINT is added
  end function not_used_here
!---------------------------------------------------------------------------

end module CRREXP_M

! $Log: crrexp_m.f90,v $
! Revision 2.2  2005/06/22 17:25:48  pwagner
! Reworded Copyright statement, moved rcs id
!
! Revision 2.1  2003/05/05 23:00:05  livesey
! Merged in feb03 newfwm branch
!
! Revision 1.1.2.1  2003/04/16 19:59:22  vsnyder
! Moved from ../fwdmdl
!
! Revision 2.1.2.3  2003/04/16 18:54:37  vsnyder
! Make more stuff public
!
! Revision 2.1.2.2  2003/04/16 18:03:37  vsnyder
! Make several functions elemental
!
! Revision 2.1.2.1  2003/04/16 17:57:32  vsnyder
! Add SRREXP and DRREXP
!
! Revision 2.1  2003/02/04 01:27:32  vsnyder
! Initial commit
!
@


2.2
log
@Reworded Copyright statement, moved rcs id
@
text
@d129 1
a130 1
!---------------------------- RCS Ident Info -------------------------------
d132 2
a133 3
       "$Id: $"
  character (len=len(idParm)), save :: Id = idParm
!---------------------------------------------------------------------------
d135 1
d137 1
d142 3
@


2.1
log
@Merged in feb03 newfwm branch
@
text
@d1 11
d24 3
a26 6
!---------------------------- RCS Ident Info -------------------------------
  character (len=*), parameter :: IdParm = &
    &  "$Id: crrexp_m.f90,v 1.1.2.1 2003/04/16 19:59:22 vsnyder Exp $"
  character (len=len(idParm)) :: Id = idParm
  character (len=*), parameter :: ModuleName= &
    &  "$RCSfile: crrexp_m.f90,v $"
d130 5
d141 3
@


1.1
log
@file crrexp_m.f90 was initially added on branch newfwm-feb03.
@
text
@d1 142
@


1.1.2.1
log
@Moved from ../fwdmdl
@
text
@a0 139
module CRREXP_M

  implicit NONE
  private
  public CRREXP, CRREXP_1, REXP, RREXP, SREXP

  interface CRREXP;   module procedure CRREXP_,   ZRREXP_;   end interface
  interface CRREXP_1; module procedure CRREXP_1_, ZRREXP_1_; end interface
  interface REXP;     module procedure SREXP,     DREXP;     end interface
  interface RREXP;    module procedure SRREXP,    DRREXP;    end interface


!---------------------------- RCS Ident Info -------------------------------
  character (len=*), parameter :: IdParm = &
    &  "$Id: crrexp_m.f90,v 2.1.2.3 2003/04/16 18:54:37 vsnyder Exp $"
  character (len=len(idParm)) :: Id = idParm
  character (len=*), parameter :: ModuleName= &
    &  "$RCSfile: crrexp_m.f90,v $"
  private :: not_used_here 
!---------------------------------------------------------------------------

contains

  pure function CRREXP_ ( Z ) result ( CRREXP )

!{ Evaluate $\frac{e^z-1}z$ as
!  $\frac{\overline{z}}{|z|^2} \left[ e^{i y} ( e^x - 1 ) + e^{i y} - 1 \right ] =
!   \frac{\overline{z}}{|z|^2}
!    \left[ e^{i y} ( e^x - 1 ) + \cos y - 1 + i \sin y \right ]$.  The
!  reason to arrange the computation in this way is that both $e^x-1$ and
!  $\cos y -1$ can be computed without cancellation if care is taken (write
!  a few terms of their Taylor series and you'll agree).

    integer, parameter :: RK = kind(0.0e0)
    complex(rk) :: CRREXP
    complex(rk), intent(in) :: Z
    include 'crrexp.f9h'
  end function CRREXP_

  pure function ZRREXP_ ( Z ) result ( CRREXP )

!{ Evaluate $\frac{e^z-1}z$ as
!  $\frac{\overline{z}}{|z|^2} \left[ e^{i y} ( e^x - 1 ) + e^{i y} - 1 \right ] =
!   \frac{\overline{z}}{|z|^2}
!    \left[ e^{i y} ( e^x - 1 ) + \cos y - 1 + i \sin y \right ]$.  The
!  reason to arrange the computation in this way is that both $e^x-1$ and
!  $\cos y -1$ can be computed without cancellation if care is taken (write
!  a few terms of their Taylor series and you'll agree).

    integer, parameter :: RK = kind(0.0d0)
    complex(rk) :: CRREXP
    complex(rk), intent(in) :: Z
    include 'crrexp.f9h'
  end function ZRREXP_

  pure function CRREXP_1_ (X) result ( CRREXP_1 )
!>> 2002-12-27 WVSnyder  Adapted from SRREXP
!--S replaces "?": ?REXP
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION ( EXP(X) - 1 ) / X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0e0)
    complex(rk) :: CRREXP_1
    complex(rk), intent(in) :: X
    include 'crrexp_1.f9h'
  end function CRREXP_1_

  pure function ZRREXP_1_ (X) result ( CRREXP_1 )
!>> 2002-12-27 WVSnyder  Adapted from SRREXP
!--S replaces "?": ?REXP
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION ( EXP(X) - 1 ) / X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0d0)
    complex(rk) :: CRREXP_1
    complex(rk), intent(in) :: X
    include 'crrexp_1.f9h'
  end function ZRREXP_1_

  elemental function SREXP (X) result ( REXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION EXP(X) - 1
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0e0)
    real(rk) :: REXP
    real(rk), intent(in) :: X
    include 'rexp.f9h'
  end function SREXP

  elemental function DREXP (X) result ( REXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION EXP(X) - 1
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0d0)
    real(rk) :: REXP
    real(rk), intent(in) :: X
    include 'rexp.f9h'
  end function DREXP

  elemental function SRREXP (X) result ( RREXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION (EXP(X) - 1)/X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0e0)
    real(rk) :: RREXP
    real(rk), intent(in) :: X
    include 'rrexp.f9h'
  end function SRREXP

  elemental function DRREXP (X) result ( RREXP )
! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION (EXP(X) - 1)/X
!-----------------------------------------------------------------------
    integer, parameter :: RK = kind(0.0d0)
    real(rk) :: RREXP
    real(rk), intent(in) :: X
    include 'rrexp.f9h'
  end function DRREXP

!-----------------------------------------------------------------------
  logical function not_used_here()
    not_used_here = (id(1:1) == ModuleName(1:1))
  end function not_used_here

end module CRREXP_M

! $Log: crrexp_m.f90,v $
! Revision 2.1.2.3  2003/04/16 18:54:37  vsnyder
! Make more stuff public
!
! Revision 2.1.2.2  2003/04/16 18:03:37  vsnyder
! Make several functions elemental
!
! Revision 2.1.2.1  2003/04/16 17:57:32  vsnyder
! Add SRREXP and DRREXP
!
! Revision 2.1  2003/02/04 01:27:32  vsnyder
! Initial commit
!
@

