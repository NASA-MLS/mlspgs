head	2.5;
access;
symbols;
locks; strict;
comment	@# @;


2.5
date	2000.11.16.02.42.47;	author vsnyder;	state dead;
branches;
next	2.4;

2.4
date	2000.10.31.18.14.49;	author pwagner;	state Exp;
branches;
next	2.3;

2.3
date	2000.10.12.22.32.27;	author vsnyder;	state Exp;
branches;
next	2.2;

2.2
date	2000.10.12.20.10.36;	author vsnyder;	state Exp;
branches;
next	2.1;

2.1
date	2000.10.11.19.10.33;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.5
log
@Moved to tests/multiply
@
text
@! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.

! $Id: test_multiply.f90,v 2.4 2000/10/31 18:14:49 pwagner Exp $

program TEST_MULTIPLY

  use Machine ! at least HP and GETARG
  use MatrixModule_0, only: Densify, Dump, MatrixElement_T, &
    & operator(.TX.), Sparsify
  use MLSCommon, only: R8

  implicit NONE

  real(r8), dimension(:,:), allocatable :: A, B, Z, ZT
  type(MatrixElement_T) :: AB, BB, ZB
  logical :: DUMP_IT = .true., DUMP_SPARSE = .false., QUIET = .false.
  integer :: I
  character(len=127) :: LINE
  integer :: NDIFF

  integer :: NRA, NCA, NCB

  i = hp
  do
    i = i + 1
    call getarg ( i, line )
    if ( line == " " ) exit
    if ( line == "-s " ) then
      dump_sparse = .true.
    else if ( line == "-n " ) then
      dump_it = .false.
    else if ( line == "-d " ) then
      dump_it = .true.
    else if ( line == "-q " ) then
      quiet = .true.
    end if
  end do
  if ( .not. quiet ) &
  &  write(0,*) "Enter numbers of rows and columns of A, and columns of B: "
  read *, NRA, NCA, NCB
  allocate ( A(NRA,NCA), B(NRA,NCB) )
  if ( .not. quiet ) &
  &  write(0,*) "Enter A, a column at a time: "
  read *, A
  if ( .not. quiet ) &
  &  write(0,*) "Enter B, a column at a time: "
  read *, B
  call sparsify ( a, ab )
  call sparsify ( b, bb )
  if ( dump_it ) then
    if ( dump_sparse ) then
      call dump ( ab, name = "Input A =" )
      call dump ( bb, name = "Input B =" )
    else
      call dump ( a, name = "Input A =" )
      call dump ( b, name = "Input B =" )
    end if
  end if
  zb = ab .tx. bb
  allocate ( z(zb%nrows,zb%ncols), zt(zb%nrows,zb%ncols) )
  call densify ( z, zb )
  zt = matmul(transpose(a),b)
  ndiff = count(z-zt > 0.0)
  if ( dump_it .or. ndiff > 0 ) then
    if ( dump_sparse ) then
      call dump ( zb, name = "Output Z = A^T B =" )
    else
      call dump ( z, name = "Output Z = A^T B =" )
    end if
  end if
  print *, "Kinds =", ab%kind, bb%kind, &
    & "Number of differences to correct answer = ", ndiff
  if ( ndiff > 0 ) then
    call dump ( zt, "True answer =" )
    call dump ( z-zt, "Z - ZT =" )
  end if
end program TEST_MULTIPLY

! $Log: test_multiply.f90,v $
! Revision 2.4  2000/10/31 18:14:49  pwagner
! changed .xt. -> .tx.
!
! Revision 1.1  2000/10/24 20:59:56  pwagner
! first commit
!
! Revision 2.3  2000/10/12 22:32:27  vsnyder
! Add "use machine" to get NAG's getarg
!
! Revision 2.2  2000/10/12 20:10:36  vsnyder
! Get R8 from MLSCommon instead of MatrixMultiply_0
!
! Revision 2.1  2000/10/11 19:10:33  vsnyder
! Initial entry
!
@


2.4
log
@changed .xt. -> .tx.
@
text
@d4 1
a4 1
! $Id: test_multiply.f90,v 1.1 2000/10/24 20:59:56 pwagner Exp $
d81 3
@


2.3
log
@Add "use machine" to get NAG's getarg
@
text
@d4 1
a4 1
! $Id: test_multiply.f90,v 2.2 2000/10/12 20:10:36 vsnyder Exp $
d10 1
a10 1
    & operator(.XT.), Sparsify
d60 1
a60 1
  zb = ab .xt. bb
d81 6
@


2.2
log
@Get R8 from MLSCommon instead of MatrixMultiply_0
@
text
@d4 1
a4 1
! $Id: test_multiply.f90,v 2.1 2000/10/11 19:10:33 vsnyder Exp $
d8 1
d24 1
a24 1
  i = 0
d81 3
@


2.1
log
@Initial entry
@
text
@d4 1
a4 1
! $Id: $
d8 1
a8 1
  use MatrixModule_0, only: Densify, Dump, MatrixElement_T, R8, &
d10 1
a61 2
  print *, 'Shape(a) =', shape(a), ", Shape(b) =", shape(b), &
           'Shape(zt) =', shape(zt)
d79 4
a82 1
! $Log: $
@

