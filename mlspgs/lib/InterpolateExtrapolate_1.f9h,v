head	2.2;
access;
symbols
	v5-02-NRT-19:2.2
	v6-00:2.2
	v5-02-NRT-18:2.2
	v5-02:2.2
	v5-01-NRT-17:2.2
	v5-01-NRT-16:2.2
	v5-01-NRT-15:2.2
	v5-01-NRT-14:2.2
	neuralnetworks-1-0:2.2.0.10
	cfm-single-freq-0-1:2.2.0.8
	v5-01:2.2
	v5-00:2.2
	v4-23-TA133:2.2.0.6
	mus-emls-1-70:2.2.0.4
	rel-1-0-englocks-work:2.2.0.2
	VUMLS1-00:2.1
	VPL1-00:2.1
	V4-22-NRT-08:2.1
	VAM1-00:2.1;
locks; strict;
comment	@# @;


2.2
date	2017.10.31.23.46.29;	author vsnyder;	state Exp;
branches;
next	2.1;

2.1
date	2015.07.29.00.23.19;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.2
log
@Make Coefficients and UnifDiscreteFn parameterized types
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

! $Id: InterpolateExtrapolate_1.f9h,v 2.1 2015/07/29 00:23:19 vsnyder Exp $

! subroutine InterpolateExtrapolate ( OldX, OldY, NewX, NewY, Second )

!   ! Interpolate ( OldX(:), OldY(:) ) to ( NewX(:), NewY(:) ).
!   ! Extrapolate outside the range of OldX using the average slope, not
!   ! the slope nearest the end where NewX is outside the range of OldX.

!   use MLSNumerics, only: Coefficients, InterpolateArraySetup, &
!     & InterpolateArrayTeardown, InterpolateValues

!   integer, parameter :: RK = kind(0.0e0)
!   real(rk), intent(in) :: OldX(:), OldY(:,:), NewX(:)
!   real(rk), intent(out) :: NewY(:,:)
!   logical, intent(in) :: Second
!   type(coefficients(r?)) :: Coeffs

    real(rk) :: AvgDiff
    integer :: Bot, Top

    bot = minloc(oldX,1)
    top = maxloc(oldX,1)

    ! Calculate the average slope of oldY/oldX using the extremes of oldX.
    ! Alternatives are a least-squares fit to a straight line, or averaging
    ! the individual difference quotients.
    avgDiff = ( oldY(top) - oldY(bot) ) / ( oldX(top) - oldX(bot) )

    ! Do the interpolations with clamped extrapolation.
    call interpolateArraySetup ( oldX, newX, &
      & Method='L', coeffs=coeffs, extrapolate='C' )
    call interpolateValues ( coeffs, oldX, oldY, &
      & newX, newY, Method='L', extrapolate='C' )
    call interpolateArrayTeardown ( coeffs )

    ! Do the extrapolations
    where ( newX < oldX(bot) ) &
      & newY = oldY(bot) + avgDiff * ( newX - oldX(bot) )
    where ( newX > oldX(top) ) &
      & newY = oldY(top) + avgDiff * ( newX - oldX(top) )

! $Log: InterpolateExtrapolate_1.f9h,v $
! Revision 2.1  2015/07/29 00:23:19  vsnyder
! Initial commit
!
@


2.1
log
@Initial commit
@
text
@d12 1
a12 1
! $Id: InterpolateExtrapolate.f9h,v 2.3 2015/04/11 01:27:25 vsnyder Exp $
d20 1
a20 1
!   use MLSNumerics, only: Coefficients_r4, InterpolateArraySetup, &
d27 1
a27 1
!   type(coefficients_r?) :: Coeffs
d53 4
a56 1
! $Log: $
@

