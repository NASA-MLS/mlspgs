head	2.4;
access;
symbols
	v5-02-NRT-19:2.4
	v6-00:2.4
	v5-02-NRT-18:2.4
	v5-02:2.4
	v5-01-NRT-17:2.4
	v5-01-NRT-16:2.4
	v5-01-NRT-15:2.4
	v5-01-NRT-14:2.4
	neuralnetworks-1-0:2.4.0.12
	cfm-single-freq-0-1:2.4.0.10
	v5-01:2.4
	v5-00:2.4
	v4-23-TA133:2.4.0.8
	mus-emls-1-70:2.4.0.6
	rel-1-0-englocks-work:2.4.0.4
	VUMLS1-00:2.4
	VPL1-00:2.4
	V4-22-NRT-08:2.4
	VAM1-00:2.4
	V4-21:2.4.0.2;
locks; strict;
comment	@# @;


2.4
date	2015.02.05.21.41.14;	author vsnyder;	state Exp;
branches;
next	2.3;

2.3
date	2014.11.14.23.56.56;	author vsnyder;	state Exp;
branches;
next	2.2;

2.2
date	2014.11.04.01.26.32;	author vsnyder;	state Exp;
branches;
next	2.1;

2.1
date	2014.11.04.01.25.45;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.4
log
@Move dummy argument declarations from the include file.
@
text
@! subroutine Rotate_3d_* ( Original_Vector, Phi, About_Vector, Rotated_Vector )

  ! Rotate Original_Vector by Phi radians about About_Vector giving
  ! Rotated_Vector.

! real(rk), intent(in) :: Original_Vector(3) ! in XYZ coordinates
! real(rk), intent(in) :: Phi                ! to rotate, Radians
! real(rk), intent(in) :: About_Vector(3)    ! in XYZ coordinates
!                                            ! An unit vector parallel to it
!                                            ! is constructed.
! real(rk), intent(out) :: Rotated_Vector(3) ! in XYZ coordinates

  real(rk) :: About_U(3)
  real(rk) :: CP, One_m_CP, SP ! Cos(phi), (1-cos(phi)), sin(phi)
  integer :: I, J
  real(rk) :: R(3,3) ! The rotation matrix

  ! Compute an unit vector parallel to About.
  About_U = about_vector / norm2(about_vector)

  !{ Construct the rotation matrix:
  !  $R_{ij} = \cos\phi\, \delta_{ij} + ( 1 - \cos\phi ) \, n_i n_j -
  !            \sin\phi\, \epsilon_{ijk}\, n_k$
  !  where $\phi$ is the rotation angle, $\hat{\mathbf{n}}$ is the unit
  !  vector about which the rotation occurs, $\delta_{ij}$ is the
  !  Kronecker symbol, $\epsilon_{ijk}$ is the Levi-Civita completely
  !  antisymmetric tensor, and there is summation on $k$; the summand has
  !  only one nonzero element.  In
  !  expanded form, $R$ is
  !  %
  !  \begin{equation*}
  !  R = \left( \begin{array}{ccc}
  !  \cos\phi + \hat{\eta}_1^2(1-\cos\phi) &
  !    \hat{\eta}_1 \hat{\eta}_2 ( 1 - \cos\phi ) - \hat{\eta}_3 \sin\phi &
  !      \hat{\eta}_1 \hat{\eta}_3 ( 1 - \cos\phi ) + \hat{\eta}_2 \sin\phi \\
  !  \hat{\eta}_1 \hat{\eta}_2 ( 1 - \cos\phi ) + \hat{\eta}_3 \sin\phi &
  !    \cos\phi + \hat{\eta}_2^2(1-\cos\phi) &
  !      \hat{\eta}_2 \hat{\eta}_3 ( 1 - \cos\phi ) - \hat{\eta}_1 \sin\phi \\
  !  \hat{\eta}_1 \hat{\eta}_3 ( 1 - \cos\phi ) - \hat{\eta}_2 \sin\phi &
  !    \hat{\eta}_2 \hat{\eta}_3 ( 1 - \cos\phi ) + \hat{\eta}_1 \sin\phi &
  !      \cos\phi + \hat{\eta}_3^2(1-\cos\phi) \\
  !  \end{array} \right)
  !  \end{equation*}
  !  %
  !  This is derived in, e.g., {\tt
  !  http://scipp.ucsc.edu/$\sim$haber/ph216/rotation_12.pdf}.

  cp = cos(phi)
  one_m_cp = 1.0_rk - cos(phi)
  sp = sin(phi)

  do i = 1, 3
    do j = 1, 3
      r(i,j) = d(i,j) * cp + one_m_cp * about_u(i) * about_u(j) - &
             & sp * l(i,j) * about_u(k(i,j))
    end do
  end do

  rotated_vector = matmul ( r, original_vector )

! end subroutine Rotate_3d_*

! $Id: Rotate_3d.f9h,v 2.3 2014/11/14 23:56:56 vsnyder Exp $

! $Log: Rotate_3d.f9h,v $
! Revision 2.3  2014/11/14 23:56:56  vsnyder
! Add more LaTeX
!
! Revision 2.2  2014/11/04 01:26:32  vsnyder
! Add the CVS comments
!
@


2.3
log
@Add more LaTeX
@
text
@d3 2
a4 1
    ! Rotate Original_Vector by Phi about About_Vector giving Rotated_Vector.
d6 50
a55 51
    real(rk), intent(in) :: Original_Vector(3) ! in XYZ coordinates
    real(rk), intent(in) :: Phi                ! to rotate, Radians
    real(rk), intent(in) :: About_Vector(3)    ! in XYZ coordinates
                                               ! An unit vector parallel to it
                                               ! is constructed.
    real(rk), intent(out) :: Rotated_Vector(3) ! in XYZ coordinates

    real(rk) :: About_U(3)
    real(rk) :: CP, One_m_CP, SP ! Cos(phi), (1-cos(phi)), sin(phi)
    integer :: I, J
    real(rk) :: R(3,3) ! The rotation matrix

    ! Compute an unit vector parallel to About.
    About_U = about_vector / norm2(about_vector)

    !{ Construct the rotation matrix:
    !  $R_{ij} = \cos\phi\, \delta_{ij} + ( 1 - \cos\phi ) \, n_i n_j -
    !            \sin\phi\, \epsilon_{ijk}\, n_k$
    !  where $\phi$ is the rotation angle, $\hat{\mathbf{n}}$ is the unit
    !  vector about which the rotation occurs, $\delta_{ij}$ is the
    !  Kronecker symbol, $\epsilon_{ijk}$ is the Levi-Civita completely
    !  antisymmetric tensor, and there is summation on $k$; the summand has
    !  only one nonzero element.  In
    !  expanded form, $R$ is
    !  %
    !  \begin{equation*}
    !  R = \left( \begin{array}{ccc}
    !  \cos\phi + \hat{\eta}_1^2(1-\cos\phi) &
    !    \hat{\eta}_1 \hat{\eta}_2 ( 1 - \cos\phi ) - \hat{\eta}_3 \sin\phi &
    !      \hat{\eta}_1 \hat{\eta}_3 ( 1 - \cos\phi ) + \hat{\eta}_2 \sin\phi \\
    !  \hat{\eta}_1 \hat{\eta}_2 ( 1 - \cos\phi ) + \hat{\eta}_3 \sin\phi &
    !    \cos\phi + \hat{\eta}_2^2(1-\cos\phi) &
    !      \hat{\eta}_2 \hat{\eta}_3 ( 1 - \cos\phi ) - \hat{\eta}_1 \sin\phi \\
    !  \hat{\eta}_1 \hat{\eta}_3 ( 1 - \cos\phi ) - \hat{\eta}_2 \sin\phi &
    !    \hat{\eta}_2 \hat{\eta}_3 ( 1 - \cos\phi ) + \hat{\eta}_1 \sin\phi &
    !      \cos\phi + \hat{\eta}_3^2(1-\cos\phi) \\
    !  \end{array} \right)
    !  \end{equation*}
    !  %
    !  This is derived in, e.g., {\tt
    !  http://scipp.ucsc.edu/$\sim$haber/ph216/rotation_12.pdf}.

    cp = cos(phi)
    one_m_cp = 1.0_rk - cos(phi)
    sp = sin(phi)

    do i = 1, 3
      do j = 1, 3
        r(i,j) = d(i,j) * cp + one_m_cp * about_u(i) * about_u(j) - &
               & sp * l(i,j) * about_u(k(i,j))
      end do
d57 1
d59 1
a59 1
    rotated_vector = matmul ( r, original_vector )
d63 1
a63 1
! $Id: Rotate_3d.f9h,v 2.2 2014/11/04 01:26:32 vsnyder Exp $
d66 3
@


2.2
log
@Add the CVS comments
@
text
@d3 2
d25 21
a45 3
    !  Kronecker symbol, $\epsilon_{ijk}$ is the Levi_Civita completely
    !  asymmetric symbol, and there is summation on $k$; the summand has
    !  only one nonzero element.
d62 1
a62 1
! $Id: Rotation_m.f90,v 2.1 2014/11/04 01:25:45 vsnyder Exp $
d64 4
a67 1
! $Log: $
@


2.1
log
@Initial commit
@
text
@d41 4
@

