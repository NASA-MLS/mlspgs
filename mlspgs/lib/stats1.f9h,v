head	2.4;
access;
symbols
	v5-02-NRT-19:2.4
	v6-00:2.4
	v5-02-NRT-18:2.4
	v5-02:2.4
	v5-01-NRT-17:2.4
	v5-01-NRT-16:2.4
	v5-01-NRT-15:2.4
	v5-01-NRT-14:2.4
	neuralnetworks-1-0:2.4.0.12
	cfm-single-freq-0-1:2.4.0.10
	v5-01:2.4
	v5-00:2.4
	v4-23-TA133:2.4.0.8
	mus-emls-1-70:2.4.0.6
	rel-1-0-englocks-work:2.4.0.4
	VUMLS1-00:2.4
	VPL1-00:2.4
	V4-22-NRT-08:2.4
	VAM1-00:2.4
	V4-21:2.4.0.2
	V4-13:2.4
	V4-12:2.4
	V4-11:2.4
	V4-10:2.4
	V3-43:2.3
	M4-00:2.4
	V3-41:2.3
	V3-40-PlusGM57:2.3.0.2
	V2-24-NRT-04:2.3
	V3-33:2.3
	V2-24:2.3
	V3-31:2.3
	V3-30-NRT-05:2.3
	cfm-01-00:2.3
	V3-30:2.3
	V3-20:2.3
	V3-10:2.3
	V2-23-NRT-02:2.3
	V2-23:2.3
	V2-22-NRT-01:2.3
	V2-22:2.3
	V2-21:2.3
	V2-20:2.3
	V2-11:2.3
	V2-10:2.3
	V2-00:2.3
	V1-51:2.1
	V1-50:2.1;
locks; strict;
comment	@# @;


2.4
date	2013.01.02.20.57.51;	author pwagner;	state Exp;
branches;
next	2.3;

2.3
date	2005.06.22.17.44.11;	author pwagner;	state Exp;
branches;
next	2.2;

2.2
date	2005.03.24.21.13.39;	author pwagner;	state Exp;
branches;
next	2.1;

2.1
date	2004.09.13.20.40.37;	author pwagner;	state Exp;
branches;
next	;


desc
@@


2.4
log
@Avoid using undefined variables
@
text
@!      subroutine SSTAT1(XTAB, NX, STATS, IHIST, NCELLS, X1, X2)
!>> 1997-04-25 SSTAT1 Krogh Simplified code (WVS suggestion)
!>> 1994-11-11 SSTAT1 Krogh Declared all vars.
!>> 1994-10-20 SSTAT1 Krogh Changes to use M77CON
!>> 1989-10-20 SSTAT1 CLL
!>> 1987-05-01 SSTAT1 Lawson  Initial code.
!--S replaces "?": ?STAT1, ?STAT2
!
!        This subr computes basic statistics for X, storing them is
!     STATS() as follows:
!
!             STATS(1) = Total count
!             STATS(2) = Min
!             STATS(3) = Max
!             STATS(4) = Mean
!             STATS(5) = Standard deviation
!
!     This subr also accumulates counts in IHIST() to develop a
!     histogram of values of X.
!
!        The data to be treated is given in XTAB(1:NX).  If the
!     value of STATS(1) on entry is positive , say = COUNT, it is
!     assumed that COUNT data values have been processed previously
!     and results from that processing are in IHIST() and STATS().
!     These results will be updated to reflect the additional set of
!     NX values.
!
!        Alternatively, if STATS(1) is zero, the initial contents of
!     STATS(2:5) and IHIST() will be ignored and results will be
!     computed just for the present data set XTAB(1:NX).
!
!        The user must specify the range and resolution of the histogram
!     by setting X1, X2, and NCELLS.  The end cells, IHIST(1) and
!     IHIST(NCELLS) will be used to count occurences of X less than X1
!     or greater than X2 respectively.
!     The cells IHIST(2) through IHIST(NCELLS-1) will
!     be used to count occurences of X in NCELLS-2 equal-length
!     subintervals of [X1, X2].
!
!        Define h = (X2 - X1)/(NCELLS-2).  X-intervals will be
!     associated with elements of IHIST() as follows.
!
!          X interval                   Counting cell
!
!          (-Infinity, X1)              IHIST(1)
!          [X1+(i-2)*h, X1+(i-1)*h)     IHIST(i), i = 2,...,NCELLS-2
!          [X2-h, X2]                   IHIST(NCELLS-1)
!          (X2, Infinity)               IHIST(NCELLS)
!
!        After use of this subroutine, the user can call
!     SSTAT2, to produce a printer-plot of the histogram and print the
!     statistics.
!
!        Remark:  It is more efficient to call this subroutine one
!     time giving it N points rather than calling it N times giving it
!     one point each time, but the results will be the same to within
!     arithmetic limitations either way.
!     ------------------------------------------------------------------
!                    Subroutine arguments
!
!     XTAB()  [in]  Array of NX values whose statistics are to be
!           computed.
!     NX     [in]  Number of values given in XTAB().
!           Require NX .ge. 1.
!     STATS()  [inout]  Array of length 5 into which statistics are or
!           will be stored.  Initial value of STATS(1) must be positive
!           if IHIST() and STATS() contain prior results that are to be
!           updated.  Otherwise the initial value of STATS(1) must be
!           zero.
!     IHIST()  [inout]  Integer array of length at least NCELLS into
!           which counts will be accumulated.
!     NCELLS   [in]  Total number of classification regions.
!           Require NCELLS .ge. 3.
!     X1,X2  [in]  Lower and upper boundaries, respectively defining
!           the range of y values to be classified into NCELLS-2 equal
!           intervals.  Require X1 < X2.
!     ------------------------------------------------------------------
!        The value of FAC is not critical.  It should be greater than
!     one.  The program does less computation each time the test
!     (abs(DELTA) .lt. TEST) is satisfied.  It will be true more
!     frequently if FAC is larger.  There is probably not much advantage
!     in setting FAC larger than 4, so 64 is probably more than ample.
!     ------------------------------------------------------------------
!     C. L. Lawson and S. Y. Chiu, JPL, Apr 1987.
!     1989-10-20 CLL Moved integer declaration earlier to avoid warning
!     msg from Cray compiler.
!     ------------------------------------------------------------------
! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

! $Id: stats1.f9h,v 2.3 2005/06/22 17:44:11 pwagner Exp $
      integer NCELLS, NX
!      integer IHIST(NCELLS)
      integer, optional, intent(inout) :: IHIST(:)
      integer I, INDEX, J
!     real             COUNT, DELTA, FAC, PREV
!     real             SCALE, RSCALE, SCLNEW, STATS(5), SUMSCL
!     real             TEMP, TEST, X, X1, X2, XMAX, XMEAN, XMIN
!     real             XTAB(NX)
!     parameter(FAC = 64.0E0)
!     ------------------------------------------------------------------
      if(NX .lt. 1) return
      COUNT = STATS(1)
      SCALE = STATS(5)
      RSCALE = 1.
!     if(COUNT .eq. 0.E0) then
      if(COUNT .lt. 0.5) then   ! To rule out potential problem
        if ( present(IHIST) ) then
         do 10 I=1,NCELLS
            IHIST(I) = 0
   10    continue
        endif
!
!                    Begin: Special for first point
!
         PREV = 0.E0
         X = XTAB(1)
         XMIN = X
         XMAX = X
         XMEAN = 0.E0
         TEST = -1.0E0
         SUMSCL = 0.E0
!                    End: Special for first point
!
      else
!                    Here when COUNT is > zero on entry.
         XMIN = STATS(2)
         XMAX = STATS(3)
         XMEAN = STATS(4)
!
         if(STATS(5) .eq. 0.E0) then
            TEST = -1.0E0
            SUMSCL = 0.E0
         else
!
!              STATS(5) contains the old value of Sigma.  Since it is
!              nonzero (positive) here, COUNT must be at least 2.
!
            SCALE =  STATS(5)
            RSCALE = 1.0E0/SCALE
            TEST = FAC * SCALE
            SUMSCL = COUNT - 1.0E0
         endif
      endif
!
      do 30 J = 1, NX
         PREV = COUNT
         COUNT = COUNT + 1.0E0
         X = XTAB(J)
         XMIN = min(X, XMIN)
         XMAX = max(X, XMAX)
!        .                             Begin: Tally in histogram.
         if ( .not. present(IHIST) ) then
         elseif(X .lt. X1) then
            IHIST(1) = IHIST(1) + 1
         elseif(X .gt. X2) then
            IHIST(NCELLS) = IHIST(NCELLS) + 1
         else
!                          Following stmt converts integer to float.
            TEMP = NCELLS-2
!                          Following stmt converts float to integer.
            INDEX = TEMP*(X-X1)/(X2-X1)
            IHIST(INDEX + 2) = IHIST(INDEX + 2) + 1
         endif
!        .                             End: Tally in histogram.
!
         DELTA = X - XMEAN
!
!              Expect abs(DELTA) .le. TEST most of the time.
!
         if(abs(DELTA) .gt. TEST) then
            if( DELTA .eq. 0.E0 ) go to 20
!
!                     Here  abs(DELTA) .gt. TEST  and  DELTA .ne. 0.E0
!                     Must compute new SCALE, RSCALE and TEST
!                     and update SUMSCL if it is nonzero.
!
            SCLNEW = abs(DELTA)
            RSCALE = 1.0E0 / SCLNEW
            TEST = FAC * SCLNEW
            if(SUMSCL .ne. 0.E0) SUMSCL = SUMSCL * (SCALE * RSCALE)**2
            SCALE = SCLNEW
         endif
         XMEAN = XMEAN + DELTA / COUNT
         SUMSCL = SUMSCL + (PREV/COUNT) * (DELTA*RSCALE)**2
   20    continue
   30 continue
!
      STATS(1) = COUNT
      STATS(2) = XMIN
      STATS(3) = XMAX
      STATS(4) = XMEAN
      if(PREV .eq. 0.E0) then
         STATS(5) = 0.E0
      else
         STATS(5) = SCALE * sqrt( SUMSCL / PREV )
      endif
!      return
!      end subroutine
!
! $Log: stats1.f9h,v $
! Revision 2.3  2005/06/22 17:44:11  pwagner
! Reworded Copyright statement, moved rcs id
!
! Revision 2.2  2005/03/24 21:13:39  pwagner
! Perhaps unneeded change
!
! Revision 2.1  2004/09/13 20:40:37  pwagner
! First commit
!
@


2.3
log
@Reworded Copyright statement, moved rcs id
@
text
@d99 1
a99 1
! $Id: stats1.f9h,v 2.2 2005/03/24 21:13:39 pwagner Exp $
d112 2
d210 3
@


2.2
log
@Perhaps unneeded change
@
text
@d88 4
a91 2
! Copyright (c) 2004, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
d93 7
a99 1
! $Id: stats1.f9h,v 2.1 2004/09/13 20:40:37 pwagner Exp $
d208 3
@


2.1
log
@First commit
@
text
@d91 1
a91 1
! $Id: l3ascii_interp_field.f9h,v 2.2 2003/02/28 02:26:59 livesey Exp $
d104 2
a105 1
      if(COUNT .eq. 0.E0) then
d199 4
a202 1
! $Log: L2GPData.f90,v $
@

