head	2.1;
access;
symbols
	V0_1:1.2;
locks; strict;
comment	@# @;


2.1
date	2000.11.15.01.55.36;	author vsnyder;	state dead;
branches;
next	2.0;

2.0
date	2000.09.05.17.42.08;	author dcuddy;	state Exp;
branches;
next	1.2;

1.2
date	2000.07.06.18.04.08;	author vsnyder;	state Exp;
branches;
next	1.1;

1.1
date	2000.07.06.01.43.17;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.1
log
@Moved to mlspgs/lib/NAG
@
text
@module MACHINE
  use F90_UNIX_ENV, only: IARGC, NAG_GETARG => GETARG
  implicit none

  character(LEN=2) :: END_LINE = ' ' // char(10)
  character(LEN=1) :: FILSEP = '/'      ! '/' for Unix, '\' for DOS or NT
  integer, parameter :: HP = 0          ! Offset for first argument for GETARG

  interface IO_ERROR; module procedure IO_ERROR_; end interface
  private IO_ERROR_

!---------------------------- RCS Ident Info -------------------------------
  character (len=256), private :: Id = &
       "$Id: machine.f90,v 2.0 2000/09/05 17:42:08 dcuddy Exp $"
  character (len=*), private, parameter :: ModuleName= &
       "$RCSfile: machine.f90,v $"
!---------------------------------------------------------------------------

contains

  subroutine IO_ERROR_ ( MESSAGE, IOSTAT, FILE )
  ! Print MESSAGE and FILE, and then do something reasonable with IOSTAT.
    character(LEN=*), intent(in) :: MESSAGE
    integer, intent(in) :: IOSTAT
    character(LEN=*), intent(in), optional :: FILE

    integer :: L
!   character(LEN=127) :: MSG

    write (*,*) message(:len_trim(message))
    if ( present(file) ) then
      l = len_trim(file)
      if ( l /= 0 ) write (*,*) file(:l)
    end if
!   call iostat_msg (iostat, msg)       ! Lahey intrinsic
!   write (*,*) file(:len_trim(msg))    ! Print the error message
    write (*,*) 'Error status code =', iostat
    return
  end subroutine IO_ERROR_

  subroutine GETARG ( ARGNUM, ARGVAL )
    integer, intent(in) :: ARGNUM  ! 0 = command name, 1 = first arg, etc.
    character(len=*), intent(out) :: ARGVAL   ! Blank if argnum out-of-range
    integer :: STATUS
    call nag_getarg ( argnum, argval, errno = status )
    if ( status /= 0 ) argval = ' '
  end subroutine GETARG

end module MACHINE

! $Log: machine.f90,v $
! Revision 2.0  2000/09/05 17:42:08  dcuddy
! Change revision to 2.0
!
! Revision 1.2  2000/07/06 18:04:08  vsnyder
! Insert CVS "variables"
!
@


2.0
log
@Change revision to 2.0
@
text
@d14 1
a14 1
       "$Id: machine.f90,v 1.2 2000/07/06 18:04:08 vsnyder Exp $"
d52 3
@


1.2
log
@Insert CVS "variables"
@
text
@d14 1
a14 1
       "$Id: machine.f90,v 1.2 2000/07/06 18:04:08 vsnyder Exp $"
d52 3
@


1.1
log
@Initial check-in
@
text
@d12 7
d50 5
@


