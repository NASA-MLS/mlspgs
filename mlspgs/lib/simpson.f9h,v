head	2.1;
access;
symbols
	v5-02-NRT-19:2.1
	v6-00:2.1
	v5-02-NRT-18:2.1
	v5-02:2.1
	v5-01-NRT-17:2.1
	v5-01-NRT-16:2.1
	v5-01-NRT-15:2.1
	v5-01-NRT-14:2.1
	neuralnetworks-1-0:2.1.0.12
	cfm-single-freq-0-1:2.1.0.10
	v5-01:2.1
	v5-00:2.1
	v4-23-TA133:2.1.0.8
	mus-emls-1-70:2.1.0.6
	rel-1-0-englocks-work:2.1.0.4
	VUMLS1-00:2.1
	VPL1-00:2.1
	V4-22-NRT-08:2.1
	VAM1-00:2.1
	V4-21:2.1.0.2
	V4-13:2.1
	V4-12:2.1
	V4-11:2.1
	V4-10:2.1
	M4-00:2.1
	V3-33:2.1;
locks; strict;
comment	@# @;


2.1
date	2011.08.26.00.22.02;	author pwagner;	state Exp;
branches;
next	;


desc
@@


2.1
log
@Moved here from fwdmdl
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

! subroutine *Simps ( F, DX, N, R )

! $Id: simpson.f9h,v 2.6 2005/10/24 20:13:11 vsnyder Exp $
! $RCSfile: simpson.f9h,v $

    integer(i4), intent(in) :: N

    real(rk), intent(in) :: F(*)
    real(rk), intent(in) :: DX
    real(rk), intent(out) :: R

    real(rk) :: S

    real(rk), parameter :: K13 = 1.0_rk / 3.0_rk
    real(rk), parameter :: K38 = 3.0_rk / 8.0_rk
    real(rk), parameter :: KSN = k13 + k38   ! Bndry Simpson with Newton-Cotes

! See e.g. F. B. Hildebrand, "Introduction to Numerical Analysis," Second
! edition, Dover (1987), p. 93.

    select case ( N )
    case ( :0 )                              ! Nothing to do
      r = 0.0_rk
    case ( 1 )                               ! Midpoint rule
      r = f(1) * dx
    case ( 2 )                               ! Trapezoid rule
      r = 0.5_rk * dx * (f(1) + f(2))
    case ( 3 )                               ! Simpson's rule
      r = k13 * dx * ( f(1) + 4.0_rk * f(2) + f(3) )
    case ( 4 )                               ! Newton-Cotes 3/8 rule
      r = k38 * dx * ( f(1) + 3.0_rk * ( f(2) + f(3) ) + f(4) )
    case ( 5: )
      if ( mod(n,2) /= 0 ) then              ! Parabolic rule
        s = sum(f(3:n-2:2)) ! Assume s+s cheaper than 2*s
        r = k13 * dx * ( f(1) + f(n) + 4.0_rk * sum(f(2:n-1:2)) + s + s )
      else       ! Parabolic rule with Newton-Cotes 3/8 rule on first 4 points
        s = sum(f(6:n-2:2)) ! Assume s+s cheaper than 2*s
        r = dx * (                                             &                
          & k38 * ( f(1) + 3.0_rk * ( f(2) + f(3) ) ) +        & ! Newton-Cotes 
          & ksn * f(4)   +                                     & ! Both         
          & k13 * (4.0_rk * sum(f(5:n-1:2)) + s + s + f(n) ) )   ! Parabolic
      end if
    end select
    return
! end subroutine *Simps

! $Log: simpson.f9h,v $
! Revision 2.6  2005/10/24 20:13:11  vsnyder
! Added a comment about where to find quadrature formulae
!
! Revision 2.5  2005/06/22 18:14:01  pwagner
! Reworded Copyright statement, moved rcs id
!
! Revision 2.4  2002/10/15 00:12:19  vsnyder
! Use Newton-Cotes 3/8 instead of trapezoid for extra panel in even number
! of points (odd number of panels) case.  Copyright notice.  Channge CVS
! variables to CVS comments.  Cosmetic changes.
!
! Revision 2.3  2002/10/02 15:50:23  bwknosp
! Added Id and RCS info
!
! Revision 2.2  2002/04/18 10:46:27  zvi
! Fix a minor bug for N Odd
!
! Revision 2.1  2002/03/21 23:35:36  zvi
! Fixing minor bug & making it more efficient
!
! Revision 2.0  2001/09/17 20:26:27  livesey
! New forward model
!
! Revision 1.3  2001/06/07 23:39:32  pwagner
! Added Copyright statement
!
! Revision 1.2  2001/01/31 01:08:48  zvi
! New version of forward model
!
@
