head	2.3;
access;
symbols
	v5-02-NRT-19:2.3
	v6-00:2.3
	v5-02-NRT-18:2.3
	v5-02:2.3
	v5-01-NRT-17:2.3
	v5-01-NRT-16:2.3
	v5-01-NRT-15:2.3
	v5-01-NRT-14:2.3
	neuralnetworks-1-0:2.3.0.14
	cfm-single-freq-0-1:2.3.0.12
	v5-01:2.3
	v5-00:2.3
	v4-23-TA133:2.3.0.10
	mus-emls-1-70:2.3.0.8
	rel-1-0-englocks-work:2.3.0.6
	VUMLS1-00:2.3
	VPL1-00:2.3
	V4-22-NRT-08:2.3
	VAM1-00:2.3
	V4-21:2.3.0.4
	V4-13:2.3
	V4-12:2.3
	V4-11:2.3
	V4-10:2.3
	V3-43:2.3
	M4-00:2.3
	V3-41:2.3
	V3-40-PlusGM57:2.3.0.2
	V2-24-NRT-04:2.3
	V3-33:2.3
	V2-24:2.3
	V3-31:2.3
	V3-30-NRT-05:2.3
	cfm-01-00:2.3
	V3-30:2.3
	V3-20:2.3
	V3-10:2.3
	V2-23-NRT-02:2.3
	V2-23:2.3
	V2-22-NRT-01:2.3
	V2-22:2.3
	V2-21:2.3
	V2-20:2.3
	V2-11:2.3
	V2-10:2.3
	V2-00:2.3
	V1-51:2.2
	V1-50:2.2
	V1-45:2.2
	V1-44:2.2
	V1-43:2.2
	V1-42:2.2
	V1-41:2.2
	V1-32:2.2
	V1-40:2.2
	V1-31:2.2
	V1-30:2.2
	V1-13:2.1
	V1-12:2.1
	V1-11:2.1
	V1-10:2.1
	newfwm-feb03:2.1.0.2;
locks; strict;
comment	@# @;


2.3
date	2005.06.22.17.44.10;	author pwagner;	state Exp;
branches;
next	2.2;

2.2
date	2003.05.05.23.00.05;	author livesey;	state Exp;
branches;
next	2.1;

2.1
date	2002.10.10.20.35.22;	author vsnyder;	state Exp;
branches
	2.1.2.1;
next	;

2.1.2.1
date	2003.04.16.20.12.15;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.3
log
@Reworded Copyright statement, moved rcs id
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

!     function *REXP ( X ) result ( REXP )
!>> 2002-10-10 REXP  WVS    Adapted to Fortran 95
!>> 1998-10-29 SREXP Krogh  Moved external statement up for mangle.
!>> 1994-10-20 SREXP Krogh  Changes to use M77CON
!>> 1994-05-20 SREXP WVS JPL Make SP and DP alike using CHGTYP
!>> 1993-05-06 SREXP WVS JPL Convert from NSWC to Math 77
!--S replaces "?": ?REXP

! $Id: rexp.f9h,v 2.2 2003/05/05 23:00:05 livesey Exp $
! $RCSfile: rexp.f9h,v $

! ----------------------------------------------------------------------
!            EVALUATION OF THE FUNCTION EXP(X) - 1
!-----------------------------------------------------------------------

!     ROUND is the smallest number such that ROUND + 1 > 1.
      real(rk), parameter :: ROUND = epsilon(1.0_rk)
!---------------------------
      real(rk), parameter :: A0 =  .248015873015873015873016E-04_rk
      real(rk), parameter :: A1 = -.344452080605731005808147E-05_rk
      real(rk), parameter :: A2 =  .206664230430046597475413E-06_rk
      real(rk), parameter :: A3 = -.447300111094328162971036E-08_rk
      real(rk), parameter :: A4 =  .114734027080634968083920E-11_rk
!---------------------------
      real(rk), parameter :: B1 = -.249994190011341852652396E+00_rk
      real(rk), parameter :: B2 =  .249987228833107957725728E-01_rk
      real(rk), parameter :: B3 = -.119037506846942249362528E-02_rk
      real(rk), parameter :: B4 =  .228908693387350391768682E-04_rk
!---------------------------
!     CI = 1/FACTORIAL(I + 2)
!---------------------------
      real(rk), parameter :: C1 = 1.0E0/6.0E0_rk
      real(rk), parameter :: C2 = 1.0E0/24.0E0_rk
      real(rk), parameter :: C3 = 1.0E0/120.0E0_rk
      real(rk), parameter :: C4 = 1.0E0/720.0E0_rk
      real(rk), parameter :: C5 = 1.0E0/5040.0E0_rk
!---------------------------
      real(rk), parameter :: P1 = .914041914819518E-09_rk
      real(rk), parameter :: P2 = .238082361044469E-01_rk
!-----------------------
      real(rk), parameter :: Q1 =-.499999999085958E+00_rk
      real(rk), parameter :: Q2 = .107141568980644E+00_rk
      real(rk), parameter :: Q3 =-.119041179760821E-01_rk
      real(rk), parameter :: Q4 = .595130811860248E-03_rk
!-----------------------
      real(rk) :: Z

      if ( abs(x) <= 0.15e0_rk ) then
         if ( round < 1.0e-14_rk ) then

!           Z is a minimax approximation of the series

!                C6 + C7*X + C8*X**2 + ....

!           This approximation is accurate to within
!           1 unit of the 23-rd significant digit.
!           The resulting value for REXP is accurate to
!           within 1 unit of the 33-rd significant
!           digit.

            z = ((((a4*x + a3)*x + a2)*x + a1)*x + a0) /                 &
     &          ((((b4*x + b3)*x + b2)*x + b1)*x + 1.0e0_rk)
            rexp = x * (((((((z*x + c5)*x + c4)*x + c3)*x + c2)*x +      &
     &                  c1)*x + 0.5e0_rk)*x + 1.0e0_rk)
            return
         end if
         rexp = x*(((p2*x + p1)*x + 1.0e0)/((((q4*x + q3)*x + q2)*x +    &
     &           q1)*x + 1.0e0_rk))
         return
      end if

      if (x >= 0.0e0_rk ) then
         z = exp(x)
         rexp = z*(0.5e0_rk + (0.5e0_rk - 1.0e0_rk/z))
         return
      end if
      if (x >= log(round) ) then
         rexp = (exp(x) - 0.5e0_rk) - 0.5e0_rk
         return
      end if
      rexp = -1.0e0_rk
      return
!     end function *REXP

! $Log: rexp.f9h,v $
! Revision 2.2  2003/05/05 23:00:05  livesey
! Merged in feb03 newfwm branch
!
! Revision 2.1.2.1  2003/04/16 20:12:15  vsnyder
! Remove save variable and argument declarations
!
! Revision 2.1  2002/10/10 20:35:22  vsnyder
! Initial conversion from Math77
!
@


2.2
log
@Merged in feb03 newfwm branch
@
text
@d1 10
a10 2
! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
d20 2
a21 2
! $Id$
! $RCSfile$
d96 4
a99 1
! $Log$
@


2.1
log
@Initial conversion from Math77
@
text
@d1 3
d12 2
a13 2
! $Id: $
! $RCSfile: $
a18 4
      real(rk), intent(in) :: X
      real(rk) :: REXP

!     EXMIN is the smallest number such that EXP(EXMIN) - 1 > -1.
d20 1
a20 2
      real(rk), save :: EXMIN = 1.0_rk
      real(rk), parameter :: ROUND = epsilon(round)
a50 1
      if ( exmin > 0.0e0_rk )  exmin = log(round)
d80 1
a80 1
      if (x >= exmin ) then
d88 7
a94 1
! $Log: $
@


2.1.2.1
log
@Remove save variable and argument declarations
@
text
@a0 3
! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.

d9 2
a10 2
! $Id: rexp.f9h,v 2.1 2002/10/10 20:35:22 vsnyder Exp $
! $RCSfile: rexp.f9h,v $
d16 4
d21 2
a22 1
      real(rk), parameter :: ROUND = epsilon(1.0_rk)
d53 1
d83 1
a83 1
      if (x >= log(round) ) then
d91 1
a91 4
! $Log: rexp.f9h,v $
! Revision 2.1  2002/10/10 20:35:22  vsnyder
! Initial conversion from Math77
!
@

