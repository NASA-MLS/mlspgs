head	2.7;
access;
symbols
	v5-02-NRT-19:2.7
	v6-00:2.7
	v5-02-NRT-18:2.7
	v5-02:2.7
	v5-01-NRT-17:2.7
	v5-01-NRT-16:2.7
	v5-01-NRT-15:2.7
	v5-01-NRT-14:2.7
	neuralnetworks-1-0:2.7.0.16
	cfm-single-freq-0-1:2.7.0.14
	v5-01:2.7
	v5-00:2.7
	v4-23-TA133:2.7.0.12
	mus-emls-1-70:2.7.0.10
	rel-1-0-englocks-work:2.7.0.8
	VUMLS1-00:2.7
	VPL1-00:2.7
	V4-22-NRT-08:2.7
	whdrel10_merged_to_here:2.7
	merge_whdrel10_from_here:2.7
	TAG_TRUNK_AFTER_PW_CHANGES:2.7
	TAG_TRUNK_BEFORE_PW_CHANGES:2.7
	VAM1-00:2.7
	whd-rel-1-0:2.7.0.6
	V4-21:2.7.0.4
	V4-13:2.7
	V4-12:2.7
	V4-11:2.7
	V4-10:2.7
	V3-43:2.7
	M4-00:2.7
	V3-41:2.7
	V3-40-PlusGM57:2.7.0.2
	V2-24-NRT-04:2.7
	V3-33:2.7
	V2-24:2.7
	V3-31:2.7
	V3-30-NRT-05:2.7
	cfm-01-00:2.7
	V3-30:2.7
	V3-20:2.7
	V3-10:2.7
	V2-23-NRT-02:2.7
	V2-23:2.7
	V2-22-NRT-01:2.7
	V2-22:2.7
	V2-21:2.7
	V2-20:2.7
	V2-11:2.7
	V2-10:2.7
	V2-00:2.7
	V1-51:2.4
	V1-50:2.4
	V1-45:2.4
	V1-44:2.4
	V1-43:2.4
	V1-42:2.3
	V1-41:2.3
	V1-32:2.2
	V1-40:2.3
	V1-31:2.2
	V1-30:2.2
	V1-13:2.1
	V1-12:2.1
	V1-11:2.1
	V1-10:2.1
	newfwm-feb03:2.1.0.2;
locks; strict;
comment	@# @;


2.7
date	2006.04.05.18.09.12;	author perun;	state Exp;
branches;
next	2.6;

2.6
date	2006.03.24.15.20.53;	author perun;	state Exp;
branches;
next	2.5;

2.5
date	2005.06.23.18.41.36;	author pwagner;	state Exp;
branches;
next	2.4;

2.4
date	2004.05.14.15.59.11;	author perun;	state Exp;
branches;
next	2.3;

2.3
date	2004.01.09.17.46.23;	author perun;	state Exp;
branches;
next	2.2;

2.2
date	2003.09.15.17.15.54;	author perun;	state Exp;
branches;
next	2.1;

2.1
date	2003.01.31.18.13.34;	author perun;	state Exp;
branches;
next	;


desc
@@


2.7
log
@Remove unused variables
@
text
@! Copyright 2006, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

!=============================================================================
MODULE THzUtils
!=============================================================================

  IMPLICIT NONE

  PRIVATE

  PUBLIC :: LLO_Bias, Bias_err, LLO_Label, ConvertLLO

!---------------------------- RCS Module Info ------------------------------
  CHARACTER (len=*), PRIVATE, PARAMETER :: ModuleName= &
       "$RCSfile: THzUtils.f90,v $"
  PRIVATE :: not_used_here 
!---------------------------------------------------------------------------

  REAL, PARAMETER :: Bias_err = 10.0

  CHARACTER (LEN=*), PARAMETER, DIMENSION(16) :: LLO_Label = (/ &
       "Pump MC PZT      ", "Pump CC PZT      ", "FIR IC PZT       ", &
       "FIR OC PZT       ", "Pump Temperature ", "RF PS Temperature", &
       "FIR Temperature  ", "Pump Thermopile  ", "Bias Signal      ", &
       "RF Forward Power ", "Max FIR Power    ", "RFPA AGC         ", &
       "FIR Thermopile   ", "+5 V Supply      ", "+12 V Supply     ", &
       "-12 V Supply     " /)
  CHARACTER (LEN=5), PARAMETER :: ack7 = CHAR(250)//CHAR(250)//CHAR(3)// &
       CHAR(0)//CHAR(7)

CONTAINS

!=============================================================================
  FUNCTION LLO_Bias (LLO_DN) RESULT (Bias)
!=============================================================================

    CHARACTER (LEN=80), INTENT (IN) :: LLO_DN
    REAL :: Bias

    CHARACTER (LEN=80) :: DN
    CHARACTER (LEN=5), PARAMETER :: msg01 = CHAR(250)//CHAR(250)//CHAR(11)//&
         CHAR(1)//CHAR(28)
    CHARACTER (LEN=5), PARAMETER :: msg02 = CHAR(250)//CHAR(250)//CHAR(35)//&
         CHAR(2)//CHAR(7)
    INTEGER :: dindx

    DN = LLO_DN
    Bias = Bias_err

    dindx = 0
    IF (DN(1:5) == ack7) THEN
       dindx = 28
    ELSE
       IF (DN(7:11) == msg01 .AND. DN(16:16) == CHAR(1) .AND. &
            DN(27:31) == msg02) dindx = 48
    ENDIF

    IF (dindx > 0) Bias = (ICHAR(DN(dindx:dindx)) + 256 * &
         ICHAR(DN(dindx+1:dindx+1))) / 409.6

  END FUNCTION LLO_Bias

!=============================================================================
  SUBROUTINE ConvertLLO (DN, EU)
!=============================================================================

    USE MLSL1Utils, ONLY: BigEndianStr, QNan

    CHARACTER (LEN=80), INTENT (IN) :: DN
    REAL, INTENT (OUT) :: EU(16)

! coefficients:

    REAL, DIMENSION(16), PARAMETER :: c0 = (/ &
         0.0, 0.0, 0.0, 0.0, -23.2, -19.655, -23.2, -0.1124, &
         0.0, 0.0, 0.0, -0.1124, -0.02, 0.0, 0.0, -30.0 /)
    REAL, DIMENSION(16), PARAMETER :: c1 = (/ &
         0.1, 0.1, 0.1, 0.1, 16.155, 18.414, 16.155, 3.5636, &
         1.0, 1.0, 1.0, 3.5636, 6.84, 1.0, 2.0, 6.0 /)

    CHARACTER (LEN=2) :: cdat

    INTEGER :: i, n1
    REAL :: xdn

    EU = QNan()
    IF (DN(1:5) == ack7) THEN

       DO i = 1, 16
          n1 = (i - 1) * 2 + 1
          cdat(1:1) = DN(n1+12:n1+12)
          cdat(2:2) = DN(n1+11:n1+11)
          IF (i == 11) THEN
             EU(i) = BigEndianStr (cdat)
          ELSE IF (i == 12) THEN
             EU(i) = BigEndianStr (DN(n1+11:n1+12))
          ELSE
             xdn = BigEndianStr (cdat)
             IF (i /= 11) xdn = xdn / 409.6
             xdn = c0(i) + c1(i) * xdn
             IF (i /= 6) THEN
                EU(i) = xdn
             ELSE
                EU(i) = xdn + xdn * xdn * (-5.606) + &
                     xdn * xdn * xdn * 1.509
             ENDIF
          ENDIF
       ENDDO

    ENDIF

  END SUBROUTINE ConvertLLO

  LOGICAL FUNCTION not_used_here()
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (len=*), PARAMETER :: IdParm = &
       "$Id: THzUtils.f90,v 2.6 2006/03/24 15:20:53 perun Exp $"
  CHARACTER (len=LEN(idParm)), SAVE :: Id = idParm
!---------------------------------------------------------------------------
    not_used_here = (id(1:1) == ModuleName(1:1))
  END FUNCTION not_used_here
END MODULE THzUtils

! $Log: THzUtils.f90,v $
! Revision 2.6  2006/03/24 15:20:53  perun
! Remove MIF 141 test for re-optimizing
!
! Revision 2.5  2005/06/23 18:41:36  pwagner
! Reworded Copyright statement, moved rcs id
!
! Revision 2.4  2004/05/14 15:59:11  perun
! Version 1.43 commit
!
! Revision 2.3  2004/01/09 17:46:23  perun
! Version 1.4 commit
!
! Revision 2.2  2003/09/15 17:15:54  perun
! Version 1.3 commit
!
! Revision 2.1  2003/01/31 18:13:34  perun
! Version 1.1 commit
!
!
@


2.6
log
@Remove MIF 141 test for re-optimizing
@
text
@d43 1
a43 1
  FUNCTION LLO_Bias (LLO_DN, MIF) RESULT (Bias)
a46 1
    INTEGER, INTENT (IN) :: MIF
d126 1
a126 1
       "$Id: THzUtils.f90,v 2.5 2005/06/23 18:41:36 pwagner Exp $"
d134 3
@


2.5
log
@Reworded Copyright statement, moved rcs id
@
text
@d1 1
a1 1
! Copyright 2005, by the California Institute of Technology. ALL
d23 3
a25 3
  character (len=*), private, parameter :: ModuleName= &
       "$RCSfile: $"
  private :: not_used_here 
d55 1
d60 4
a63 2
    IF (MIF == 141) THEN    ! Could be re-optimizing

d65 1
a65 2
            DN(27:31) == msg02) DN = DN(21:80)

a66 1
    IF (DN(1:5) == ack7) THEN
d68 2
a69 3
       Bias = (ICHAR(DN(28:28)) + 256 * ICHAR(DN(29:29))) / 409.6

    ENDIF
d124 1
a124 1
  logical function not_used_here()
d126 3
a128 3
  character (len=*), parameter :: IdParm = &
       "$Id: $"
  character (len=len(idParm)), save :: Id = idParm
d131 1
a131 1
  end function not_used_here
d135 3
@


2.4
log
@Version 1.43 commit
@
text
@d1 10
a10 2
! Copyright (c) 2004, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
d22 5
a26 5
  !------------------------------- RCS Ident Info ------------------------------
  CHARACTER(LEN=130) :: id = &
       "$Id: THzUtils.f90,v 2.3 2004/01/09 17:46:23 perun Exp $"
  CHARACTER(LEN=*), PARAMETER :: ModuleName="$RCSfile: THzUtils.f90,v $"
  !-----------------------------------------------------------------------------
d124 8
d135 3
@


2.3
log
@Version 1.4 commit
@
text
@d1 1
a1 1
! Copyright (c) 2003, California Institute of Technology.  ALL RIGHTS RESERVED.
d16 1
a16 1
       "$Id: THzUtils.f90,v 2.2 2003/09/15 17:15:54 perun Exp $"
d29 2
a42 2
    CHARACTER (LEN=5), PARAMETER :: ack7 = CHAR(250)//CHAR(250)//CHAR(3)//&
         CHAR(0)//CHAR(7)
d53 2
a54 2
       IF (DN(7:11) == msg01 .AND. DN(16:16) == CHAR(1) .AND. DN(27:31) == &
            msg02) DN = DN(21:80)
a83 2
    CHARACTER (LEN=5), PARAMETER :: ack7 = CHAR(250)//CHAR(250)//CHAR(3)//&
         CHAR(0)//CHAR(7)
d119 3
@


2.2
log
@Version 1.3 commit
@
text
@d12 1
a12 1
  PUBLIC :: LLO_Bias, Bias_err, MaxBias, LLO_Label, ConvertLLO
d16 1
a16 1
       "$Id: THzUtils.f90,v 2.1 2003/01/31 18:13:34 perun Exp $"
a20 1
  REAL, PARAMETER :: MaxBias = 2.0
d121 3
@


2.1
log
@Version 1.1 commit
@
text
@d1 1
a1 1
! Copyright (c) 2002, California Institute of Technology.  ALL RIGHTS RESERVED.
d12 1
a12 1
  PUBLIC :: LLO_Bias, Bias_err, MaxBias
d16 2
a17 2
       "$Id: $"
  CHARACTER(LEN=*), PARAMETER :: ModuleName="$RCSfile: $"
d23 8
d66 53
d121 4
a124 1
! $Log: $
@

