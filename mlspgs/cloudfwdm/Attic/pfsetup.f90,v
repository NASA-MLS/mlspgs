head	1.3;
access;
symbols
	newfwm-sep01:1.2.0.2
	V0-7:1.2;
locks; strict;
comment	@# @;


1.3
date	2001.09.20.22.07.25;	author jonathan;	state dead;
branches;
next	1.2;

1.2
date	2001.07.25.23.44.01;	author jonathan;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.25.17.59.34;	author jonathan;	state Exp;
branches;
next	;


desc
@@


1.3
log
@*** empty log message ***
@
text
@	subroutine pfsetup(n,p,dp,u,nu)

        use MLSCommon, only: r8
	implicit none
	
	integer :: i,j,n,nu
	real(r8) :: u(nu)
	real(r8) :: p(n,nu)
	real(r8) :: dp(n,nu)
	real(r8) :: w1, w2, v1, v2, us

	do 100 i=1,nu
	us = sqrt(1-u(i)*u(i))
	w1 = us
	w2 = 3*u(i)*w1
	p(1,i)=w1
	p(2,i)=w2
	v1 = u(i)
	v2 = 6*u(i)*u(i) - 3
	dp(1,i)=v1
	dp(2,i)=v2
	  do j=3,n
	  p(j,i)=(2.*j-1.)/(j-1.)*w2*u(i) - j/(j-1.)*w1
	  dp(j,i)=(2*j-1.)/(j-1.)*(u(i)*v2-w2*us)-j/(j-1.)*v1
	  w1 = w2
	  w2 = p(j,i)
	  v1 = v2
	  v2 = dp(j,i)
	  enddo
 100	continue
	return
	end

! $Log: pfsetup.f90,v      
@


1.2
log
@new f90 version of cloudfwm, jonathan
@
text
@@


1.1
log
@new .f90 version, jonathan
@
text
@d2 2
d6 5
a10 5
	integer i,j,n,nu
	real u(nu)
	real p(n,nu)
	real dp(n,nu)
	real w1, w2, v1, v2, us
@

