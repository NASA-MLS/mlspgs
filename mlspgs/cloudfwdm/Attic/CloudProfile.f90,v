head	1.4;
access;
symbols
	V1-13:1.3
	V1-12:1.3
	V1-11:1.3
	V1-10:1.3
	newfwm-feb03:1.3.0.2
	V1-04:1.2
	V1-03:1.2
	V1-02:1.2
	JointForwardModel:1.2.0.2
	V1-00:1.2;
locks; strict;
comment	@# @;


1.4
date	2003.05.14.22.32.42;	author jonathan;	state dead;
branches;
next	1.3;

1.3
date	2002.10.08.17.08.07;	author pwagner;	state Exp;
branches;
next	1.2;

1.2
date	2001.10.19.00.01.33;	author jonathan;	state Exp;
branches;
next	1.1;

1.1
date	2001.10.07.23.41.40;	author jonathan;	state Exp;
branches;
next	;


desc
@@


1.4
log
@removed
@
text
@
! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
 
module CloudProfile

! -------------------------------------------------------------------------  
! MODULE TO GENERATE ICE WATER CONTENT PROFILE IF NEEDED
! -------------------------------------------------------------------------

  use MLSCommon,only: NameLen,    FileNameLen, r8

      IMPLICIT NONE
      private
      public :: CLOUD_MODEL

 !---------------------------- RCS Ident Info -------------------------------
  character (len=*), private, parameter :: IdParm =                          &
    "$Id: CloudProfile.f90,v 1.3 2002/10/08 17:08:07 pwagner Exp $"
  character (len=len(idParm)), private :: Id = idParm
  character (len=*), private, parameter :: ModuleName=                       &
    "$RCSfile: CloudProfile.f90,v $"
  private :: not_used_here 
 !---------------------------------------------------------------------------

contains 

      SUBROUTINE CLOUD_MODEL(ITYPE,CHT,YZ,NH,WC)

!=========================================================================C
!  DEFINE VERTICAL PROFILES OF CLOUD ICE-WATER-CONTENT                    C
!  J.JIANG -05/18/2001                                                    C
!          -10/05/2001, MODIFIED TO FIT CLOUD RETREVIAL REQUIREMENTS      C
!=========================================================================C

      CHARACTER :: ITYPE

      INTEGER :: NH,I

      REAL(r8) :: YZ(NH)
      REAL(r8) :: WC(2,NH)

      REAL(r8) :: CLD_TOP
      REAL(r8) :: CLD_BASE
      REAL(r8) :: UPPER_LAG
      REAL(r8) :: LOWER_LAG
      REAL(r8) :: HT, CHT, WCscale

!--------------------------------------------------------------------

      IF (CHT .EQ. 0._r8) THEN
         HT = 16000._r8 + CHT*1000._r8
      ELSE
         HT=CHT
      ENDIF

      WCscale=0.1_r8

      IF(ITYPE .EQ. 'C') THEN

!         PRINT*,' '
!         PRINT*,' -> CLOUD-TYPE: DEEP-CONVECTIVE SYSTEM '

         CLD_TOP   = HT + 1000._r8         ! CONVECTIVE CLOUD-TOP
         CLD_BASE  = HT - 11600._r8        ! CONVECTIVE CLOUD-BASE
         UPPER_LAG = HT - 8000._r8
         LOWER_LAG = HT - 10000._r8

         DO I=1,NH

            IF (YZ(I) .GT. CLD_TOP .OR. YZ(I) .LT. CLD_BASE) THEN
               WC(1,I) = 0.0_r8
            ELSE IF (YZ(I).LE.UPPER_LAG .AND. YZ(I).GE.LOWER_LAG) THEN
               WC(1,I) = 1.0_r8
            ELSE IF (YZ(I).GT.UPPER_LAG .AND. YZ(I).LE.CLD_TOP) THEN
               WC(1,I) = 1.0*EXP(-(YZ(I)-UPPER_LAG)/5000.)
            ELSE IF (YZ(I).LT.LOWER_LAG .AND. YZ(I).GE.CLD_BASE) THEN
               WC(1,I) = 1.0*EXP(-(LOWER_LAG-YZ(I))/500.)
            else
              WC(1,I) =0.0_r8
            ENDIF

            ! LIQUID WATER CLOUD
            
!            IF (YZ(I).GT.5000. .AND. YZ(I).LT. 10000.) THEN
               WC(2,I) = 0.1*0._r8
!            ENDIF
         ENDDO


      ELSE IF (ITYPE .EQ. 'F') THEN

!         PRINT*,' '
!         PRINT*,' -> CLOUD-TYPE: FRONTAL SYSTEM '

         CLD_TOP   = HT - 5000._r8         ! FRONTAL CLOUD-TOP
         CLD_BASE  = HT - 11000._r8        ! FRONTAL CLOUD-BASE
         UPPER_LAG = HT - 7000._r8
         LOWER_LAG = HT - 9000._r8

         DO I=1,NH
            IF (YZ(I) .GT. CLD_TOP .OR. YZ(I) .LT. CLD_BASE) THEN
               WC(1,I) = 0.0_r8
            ELSE IF (YZ(I).LE.UPPER_LAG .AND. YZ(I).GE.LOWER_LAG) THEN
               WC(1,I) = 1.0_r8
            ELSE IF (YZ(I).GT.UPPER_LAG .AND. YZ(I).LE.CLD_TOP) THEN
               WC(1,I) = 1.0*EXP(-(YZ(I)-UPPER_LAG)/500.)
            ELSE IF (YZ(I).LT.LOWER_LAG .AND. YZ(I).GE.CLD_BASE) THEN
               WC(1,I) = 1.0*EXP(-(LOWER_LAG-YZ(I))/500.)

            else
               WC(1,I) = 0._r8
            ENDIF
            WC(2,I) = 0.0_r8
         ENDDO

      ELSE IF (ITYPE .EQ. 'A') THEN

!         PRINT*,' '
!         PRINT*,' -> CLOUD-TYPE: ANVILS'

         CLD_TOP   = HT - 4000._r8         !ANVIL CLOUD-TOP
         CLD_BASE  = HT - 11000._r8        !ANVIL CLOUD-BASE
         UPPER_LAG = HT - 5000._r8
         LOWER_LAG = HT - 6000._r8

         DO I=1,NH
            IF (YZ(I) .GT. CLD_TOP .OR. YZ(I) .LT. CLD_BASE) THEN
               WC(1,I) = 0.0_r8
            ELSE IF (YZ(I).LE.UPPER_LAG .AND. YZ(I).GE.LOWER_LAG) THEN
               WC(1,I) = 1.0_r8
            ELSE IF (YZ(I).GT.UPPER_LAG .AND. YZ(I).LE.CLD_TOP) THEN
               WC(1,I) = 1.0*EXP(-(YZ(I)-UPPER_LAG)/500.)
            ELSE IF (YZ(I).LT.LOWER_LAG .AND. YZ(I).GE.CLD_BASE) THEN
               WC(1,I) = 1.0*EXP(-(LOWER_LAG-YZ(I))/600.)
            ENDIF
            WC(2,I) = 0.0_r8
         ENDDO

      ELSE IF (ITYPE .EQ. 'T') THEN

!         PRINT*,' '
!         PRINT*,' -> CLOUD-TYPE: THIN-LAYER CIRRUS'

         CLD_TOP   = HT + 500.         !1KM THICK CLOUD LAYER
         CLD_BASE  = HT - 500.
         UPPER_LAG = HT + 200.
         LOWER_LAG = HT - 200.

         DO I=1,NH
            IF (YZ(I) .GT. CLD_TOP .OR. YZ(I) .LT. CLD_BASE) THEN
               WC(1,I) = 0.0
            ELSE IF (YZ(I).LE.UPPER_LAG .AND. YZ(I).GE.LOWER_LAG) THEN
               WC(1,I) = 1.0
            ELSE IF (YZ(I).GT.UPPER_LAG .AND. YZ(I).LE.CLD_TOP) THEN
               WC(1,I) = 1.0*EXP(-(YZ(I)-HT)/500.)
            ELSE IF (YZ(I).LT.LOWER_LAG .AND. YZ(I).GE.CLD_BASE) THEN
               WC(1,I) = 1.0*EXP(-(HT-YZ(I))/500.)
            ENDIF
            WC(2,I)=0.0
         ENDDO
 
      ELSE

        PRINT*, 'NO CLOUDS'
       
        DO I=1,NH
            WC(1,I)=0.0
            WC(2,I)=0.0
        ENDDO

      ENDIF


        DO I=1,NH
            WC(1,I)=WCscale*WC(1,I)
            WC(2,I)=WCscale*WC(2,I)
        ENDDO


!------------------------------------------------------

      END SUBROUTINE CLOUD_MODEL

  logical function not_used_here()
    not_used_here = (id(1:1) == ModuleName(1:1))
  end function not_used_here

end module CloudProfile

! $Log: CloudProfile.f90,v $
! Revision 1.3  2002/10/08 17:08:07  pwagner
! Added idents to survive zealous Lahey optimizer
!
! Revision 1.2  2001/10/19 00:01:33  jonathan
! minor
!
! Revision 1.1  2001/10/07 23:41:40  jonathan
! cloud ice-water-content profile
!     



@


1.3
log
@Added idents to survive zealous Lahey optimizer
@
text
@d19 1
a19 1
    "$Id: CloudProfile.f90,v 1.2 2001/10/19 00:01:33 jonathan Exp $"
d192 3
@


1.2
log
@minor
@
text
@d19 1
a19 1
    "$Id: CloudProfile.f90,v 1.1 2001/10/07 23:41:40 jonathan Exp $"
d23 1
d185 4
d192 3
@


1.1
log
@cloud ice-water-content profile
@
text
@d19 1
a19 1
    "$Id: CloudProfile.f90,v 1.14 2001/10/04 23:35:05 jonathan Exp $"
d51 1
a51 1
         HT = 16000. + CHT*1000.
d56 1
a56 1
      WCscale=0.1
d63 4
a66 4
         CLD_TOP   = HT + 1000.         ! CONVECTIVE CLOUD-TOP
         CLD_BASE  = HT - 11600.        ! CONVECTIVE CLOUD-BASE
         UPPER_LAG = HT - 8000.
         LOWER_LAG = HT - 10000.
d71 1
a71 1
               WC(1,I) = 0.0
d73 1
a73 1
               WC(1,I) = 1.0
d78 2
d84 3
a86 3
            IF (YZ(I).GT.5000. .AND. YZ(I).LT. 10000.) THEN
               WC(2,I) = 0.1*0.
            ENDIF
d95 4
a98 4
         CLD_TOP   = HT - 5000.         ! FRONTAL CLOUD-TOP
         CLD_BASE  = HT - 11000.        ! FRONTAL CLOUD-BASE
         UPPER_LAG = HT - 7000.
         LOWER_LAG = HT - 9000.
d102 1
a102 1
               WC(1,I) = 0.0
d104 1
a104 1
               WC(1,I) = 1.0
d109 3
d113 1
a113 1
            WC(2,I) = 0.0
d121 4
a124 4
         CLD_TOP   = HT - 4000.         !ANVIL CLOUD-TOP
         CLD_BASE  = HT - 11000.        !ANVIL CLOUD-BASE
         UPPER_LAG = HT - 5000.
         LOWER_LAG = HT - 6000.
d128 1
a128 1
               WC(1,I) = 0.0
d130 1
a130 1
               WC(1,I) = 1.0
d136 1
a136 1
            WC(2,I) = 0.0
d186 4
a189 1
! $Log: CloudProfile.f90,v $     
@

