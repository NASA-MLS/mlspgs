head	1.5;
access;
symbols
	newfwm-sep01:1.4.0.2
	V0-7:1.4;
locks; strict;
comment	@# @;


1.5
date	2001.09.20.21.50.27;	author jonathan;	state dead;
branches;
next	1.4;

1.4
date	2001.08.17.16.01.52;	author jonathan;	state Exp;
branches;
next	1.3;

1.3
date	2001.07.27.15.17.58;	author jonathan;	state Exp;
branches;
next	1.2;

1.2
date	2001.07.25.23.44.01;	author jonathan;	state Exp;
branches;
next	1.1;

1.1
date	2001.07.25.17.59.34;	author jonathan;	state Exp;
branches;
next	;


desc
@@


1.5
log
@*** empty log message ***
@
text
@!         p ---- mb
!         t,td ---- K
!         RH --- %
!         SD --- g/m3
    
          SUBROUTINE RHtoSD(p,t,RH,SD)
          ES=6.10779*EXP(17.28*(t-273.15)/(t-36.))
          if (ES.lt.0.) ES=0
	  rou=p/2.87/t
          SD=622*ES/(p-ES)*RH*0.01*rou
          RETURN
          END

          SUBROUTINE RHtoQV(p,t,RH,QV)
          ES=6.10779*EXP(17.28*(t-273.15)/(t-36.))
          if (ES.lt.0.) ES=0
          QV=622*ES/(p-ES)*RH*0.01
          RETURN
          END

          SUBROUTINE SDtoRH(p,t,RH,SD)
          ES=6.10779*EXP(17.28*(t-273.15)/(t-36.))                    
          QS=622*ES/(p-ES) 
	  rou=p/2.87/t
	  Q=SD/rou 
          RH=Q/QS*100
          RETURN
          END

          SUBROUTINE TDtoRH(td,t,RH)                                      
          ES=6.10779*EXP(17.28*(t-273.15)/(t-36.))                        
          E=6.10779*EXP(17.28*(td-273.15)/(td-36.))                       
          RH=E/ES*100                                                     
          RETURN                                                          
          END 

!          SUBROUTINE TDtoQV(td,t,QV)
!          E=6.10779*EXP(17.28*(td-273.15)/(td-36.))
!          if (E.lt.0.) E=0
!          QV=622*E/(P-E)
!          RETURN
!          END 

!          SUBROUTINE RHtoEV(p,t,RH,EV)
          SUBROUTINE RHtoEV(t,RH,EV) 
          use MLSCommon, only: r8            
          REAL(r8) :: es, t, RH, EV
!... relative to water
!         ES=6.10779*EXP(17.28*(t-273.15)/(t-36.))
!... relative to ice

	  es=10**(-2667./t+10.555)
          if (ES.lt.0._r8) ES=0._r8
          EV=ES*0.01*RH
          RETURN
          END

          SUBROUTINE SDtoEV(p,t,EV,SD)
          ES=6.10779*EXP(17.28*(t-273.15)/(t-36.))                    
          QS=622*ES/(p-ES) 
	  rou=p/2.87/t
	  Q=SD/rou 
          RH=Q/QS
          EV=RH*ES
          RETURN
          END

! $Log: water.f90,v      

@


1.4
log
@*** empty log message ***
@
text
@@


1.3
log
@First Successful f90 runs
@
text
@d37 6
a42 6
          SUBROUTINE TDtoQV(td,t,QV)
          E=6.10779*EXP(17.28*(td-273.15)/(td-36.))
          if (E.lt.0.) E=0
          QV=622*E/(P-E)
          RETURN
          END 
d44 2
a45 1
          SUBROUTINE RHtoEV(p,t,RH,EV)
d47 1
a47 1
          REAL(r8) :: es, t, RH, EV, p
@


1.2
log
@new f90 version of cloudfwm, jonathan
@
text
@d46 1
a46 1
          REAL(r8) :: es, t, RH, EV
@


1.1
log
@new .f90 version, jonathan
@
text
@d45 2
d52 1
a52 1
          if (ES.lt.0.) ES=0
@

