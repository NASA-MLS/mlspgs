head	1.5;
access;
symbols;
locks; strict;
comment	@c @;


1.5
date	2001.07.25.17.58.00;	author jonathan;	state dead;
branches;
next	1.4;

1.4
date	2001.06.08.22.31.42;	author jonathan;	state Exp;
branches;
next	1.3;

1.3
date	2001.06.04.19.07.15;	author jonathan;	state Exp;
branches;
next	1.2;

1.2
date	2001.06.04.18.22.25;	author jonathan;	state Exp;
branches;
next	1.1;

1.1
date	2001.05.29.21.18.39;	author livesey;	state Exp;
branches;
next	;


desc
@@


1.5
log
@deleted .f files, jonathan
@
text
@
      SUBROUTINE CLEAR_SKY(L,NU,TS,S,LORS,SWIND,XZ,XP,XT,XQ,VMR,
     >                     F,RS,U,T,TAU,Z,TAU100)

C======================================================
C     >>>>>>>>CLEAR-SKY RADIATION SCHEME<<<<<<<<<<
C
C     CALCULATE BACKGROUND ATMOSPHERIC RADIATION
C     LATEST UPDATE, J.JIANG, MAY 18, 2001
C======================================================

C-------------------------------------------------
C     ATMOSPHERIC PROFILE PARAMETERS
C-------------------------------------------------

      INCLUDE 'spectra.h'
      INTEGER L,NU,NP,I
      REAL RS(NU/2),T(L),TAU(L),U(NU),Z(L),TAU100(L)
      REAL XZ(L+1),XP(L+1),XT(L+1),XQ(L+1)
      REAL VMR(2,L+1),VMR1(5)

C-------------------------------------------------
C     SURFACE REFLECTIVITY
C-------------------------------------------------

      PARAMETER(NP=800)                   ! DEMENSION OF WORKING ARRAYS
      REAL RH(NP)                         ! HORIZONTAL
      REAL RV(NP)                         ! VERTICAL
      REAL X(NP)                          ! SCATTERING ANGLES

C------------------------------------------------------------------------
      CALL HEADER(2)

      CALL SETUP_SPECTRA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,
     >                   GAMMA,N2,MOL,NMOL,NCNT)

C-------------------------------------------------
C     GET SURFACE REFLECTIVITY
C-------------------------------------------------

      DO I=1,NU/2
         X(I)=U(I)
      ENDDO
      CALL SURFACE(F,TS,LORS,S,WIND,X,NU/2,NP,RH,RV)
      DO I=1,NU/2
         RS(I)=RH(I)
      ENDDO

      DO I=1,L
         Z(I)=XZ(I+1)-XZ(I)
         T(I)=(XT(I+1)+XT(I))*0.5
         P=(XP(I+1)+XP(I))*0.5               !!! NEED TO CHANGE TO P(I)
         DQ=(XQ(I+1)+XQ(I))*0.5

         DO J=1,5
            VMR1(J)=(VMR(J,I+1)+VMR(J,I))*0.5
         ENDDO

         CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,
     >                 MOL,NMOL,NCNT,T(I),P,F,DQ,VMR1,DR)   
                                             ! HERE DQ IS H2O MIXING RATIO
         TAU(I)=DR*Z(I)

         CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,
     >                 MOL,NMOL,NCNT,T(I),P,F,100.,VMR1,DR) 
                                             ! HERE DQ IS RELATIVE HUMIDITY!
         TAU100(I)=DR*Z(I)


      ENDDO
      RETURN
      END

! $Log: Clear_sky.f,v      



@


1.4
log
@First working version
@
text
@@


1.3
log
@FIRST WORKING VERSION OF FULL_CLOUD_FORWARD_MODEL
@
text
@d20 1
a20 1
      REAL VMR(5,L+1),VMR1(5)
@


1.2
log
@Fixed wrong comment forwat
@
text
@d74 3
@


1.1
log
@First version
@
text
@d1 4
d9 1
a10 3

      SUBROUTINE CLEAR_SKY(L,NU,TS,S,LORS,SWIND,XZ,XP,XT,XQ,VMR,
     >                     F,RS,U,T,TAU,Z,TAU100)
@

