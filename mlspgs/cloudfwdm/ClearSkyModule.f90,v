head	1.27;
access;
symbols
	v5-02-NRT-19:1.27
	v6-00:1.27
	v5-02-NRT-18:1.27
	v5-02:1.27
	v5-01-NRT-17:1.27
	v5-01-NRT-16:1.27
	v5-01-NRT-15:1.27
	v5-01-NRT-14:1.27
	neuralnetworks-1-0:1.27.0.14
	cfm-single-freq-0-1:1.27.0.12
	v5-01:1.27
	v5-00:1.27
	v4-23-TA133:1.27.0.10
	mus-emls-1-70:1.27.0.8
	rel-1-0-englocks-work:1.27.0.6
	VUMLS1-00:1.27
	VPL1-00:1.27
	V4-22-NRT-08:1.27
	VAM1-00:1.27
	V4-21:1.27.0.4
	V4-13:1.27
	V4-12:1.27
	V4-11:1.27
	V4-10:1.27
	V3-43:1.27
	M4-00:1.27
	V3-41:1.27
	V3-40-PlusGM57:1.27.0.2
	V2-24-NRT-04:1.25
	V3-33:1.27
	V2-24:1.25
	V3-31:1.27
	V3-30-NRT-05:1.27
	cfm-01-00:1.27
	V3-30:1.27
	V3-20:1.27
	V3-10:1.27
	V2-23-NRT-02:1.25
	V2-23:1.25
	V2-22-NRT-01:1.25
	V2-22:1.25
	V2-21:1.25
	V2-20:1.25
	V2-11:1.25
	V2-10:1.25
	V2-00:1.25
	V1-51:1.24
	V1-50:1.24
	V1-45:1.24
	V1-44:1.24
	V1-43:1.24
	V1-32:1.24
	V1-31:1.24
	V1-30:1.24
	V1-13:1.22
	V1-12:1.22
	V1-11:1.22
	V1-10:1.22
	newfwm-feb03:1.22.0.2
	V1-04:1.15
	V1-03:1.15
	V1-02:1.15
	JointForwardModel:1.15.0.2
	V1-00:1.15;
locks; strict;
comment	@# @;


1.27
date	2009.06.23.18.26.19;	author pwagner;	state Exp;
branches;
next	1.26;

1.26
date	2008.10.03.21.04.26;	author livesey;	state Exp;
branches;
next	1.25;

1.25
date	2005.06.22.18.27.38;	author pwagner;	state Exp;
branches;
next	1.24;

1.24
date	2003.05.07.23.14.22;	author jonathan;	state Exp;
branches;
next	1.23;

1.23
date	2003.04.10.20.25.35;	author dwu;	state Exp;
branches;
next	1.22;

1.22
date	2003.02.01.06.43.06;	author dwu;	state Exp;
branches;
next	1.21;

1.21
date	2003.01.30.23.48.02;	author dwu;	state Exp;
branches;
next	1.20;

1.20
date	2003.01.23.00.19.09;	author pwagner;	state Exp;
branches;
next	1.19;

1.19
date	2002.12.18.16.08.58;	author jonathan;	state Exp;
branches;
next	1.18;

1.18
date	2002.10.08.17.08.07;	author pwagner;	state Exp;
branches;
next	1.17;

1.17
date	2002.08.22.00.13.29;	author jonathan;	state Exp;
branches;
next	1.16;

1.16
date	2002.08.08.22.45.57;	author jonathan;	state Exp;
branches;
next	1.15;

1.15
date	2001.11.20.19.36.46;	author jonathan;	state Exp;
branches;
next	1.14;

1.14
date	2001.11.16.00.40.52;	author jonathan;	state Exp;
branches;
next	1.13;

1.13
date	2001.11.15.23.53.02;	author jonathan;	state Exp;
branches;
next	1.12;

1.12
date	2001.11.15.23.52.28;	author jonathan;	state Exp;
branches;
next	1.11;

1.11
date	2001.11.15.00.54.14;	author jonathan;	state Exp;
branches;
next	1.10;

1.10
date	2001.11.14.00.39.42;	author jonathan;	state Exp;
branches;
next	1.9;

1.9
date	2001.11.09.22.06.56;	author jonathan;	state Exp;
branches;
next	1.8;

1.8
date	2001.11.09.18.07.36;	author jonathan;	state Exp;
branches;
next	1.7;

1.7
date	2001.10.04.23.35.15;	author dwu;	state Exp;
branches;
next	1.6;

1.6
date	2001.09.21.15.51.37;	author jonathan;	state Exp;
branches;
next	1.5;

1.5
date	2001.09.20.23.39.51;	author jonathan;	state Exp;
branches;
next	1.4;

1.4
date	2001.09.20.21.21.47;	author jonathan;	state Exp;
branches;
next	1.3;

1.3
date	2001.09.20.20.20.00;	author jonathan;	state Exp;
branches;
next	1.2;

1.2
date	2001.09.20.19.55.17;	author jonathan;	state Exp;
branches;
next	1.1;

1.1
date	2001.09.20.16.36.09;	author jonathan;	state Exp;
branches;
next	;


desc
@@


1.27
log
@Prevent Intel from optimizing ident string away
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

module ClearSkyModule

! -------------------------------------------------------------------------  
! MLS CLEAR SKY RADIANCE MODEL
! -------------------------------------------------------------------------

      use Bill_GasAbsorption, only: get_beta_bill
      use GasAbsorption, only: GET_BETA
      use MLSCommon, only: r8
      use SpectraLines, only: SETUP_SPECTRA
      use SurfaceModel, only: SURFACE
      use SpectroscopyCatalog_m, only: CATALOG_T
      USE Intrinsic,    only: l_clear

      IMPLICIT NONE
      Private
      Public :: CLEAR_SKY

!---------------------------- RCS Module Info ------------------------------
  character (len=*), private, parameter :: ModuleName= &
       "$RCSfile: $"
  private :: not_used_here 
!---------------------------------------------------------------------------
      
contains

      SUBROUTINE CLEAR_SKY(L,NU,TS,S,LORS,WIND,XZ,XP,XT,XQ,VMR, NS, &
                 &         F,FLO,RS,U,T,Z,TAU,tau_wet, tau_dry, Catalog, &
                 &         Bill_Spectra,LosVel, i_saturation )

!======================================================
!     >>>>>>>>CLEAR-SKY RADIATION SCHEME<<<<<<<<<<
!
!     CALCULATE BACKGROUND ATMOSPHERIC RADIATION
!     LATEST UPDATE, J.JIANG, MAY 18, 2001
!======================================================

      INCLUDE 'spectra.f9h' 

!-------------------------------------------------
!     ATMOSPHERIC PROFILE PARAMETERS
!-------------------------------------------------

      INTEGER, intent(in) :: NS                ! NO. OF CHEMICAL SPECIES
      INTEGER, intent(in) :: NU                ! 2 x NO. OF pts
      INTEGER, intent(in) :: L                 ! NO. OF (levels?)
      INTEGER, intent(in) :: LORS              ! Surface type index (land/sea)
      REAL(r8), intent(in) :: U(NU)            ! Scattering angles
      REAL(r8), intent(in) :: F                ! Frequency
      REAL(r8), intent(in) :: FLO              ! LO Frequency
      REAL(r8), intent(in) :: TS               ! Surface temperature
      REAL(r8), intent(in) :: S                ! Salinity
      REAL(r8), intent(in) :: WIND             ! Wind speed
      REAL(r8), intent(in) :: LosVel
      REAL(r8), intent(in) :: XZ(L+1)
      REAL(r8), intent(in) :: XP(L+1)
      REAL(r8), intent(in) :: XT(L+1)
      REAL(r8), intent(in) :: XQ(L+1)
      REAL(r8), intent(in) :: VMR(NS-1,L+1)
      REAL(r8), intent(out) :: RS(NU/2)        ! Surface reflectivity
      REAL(r8), intent(out) :: tau_wet(L)
      REAL(r8), intent(out) :: tau_dry(L)
      REAL(r8), intent(out) :: TAU(L)
      REAL(r8), intent(out) :: T(L)
      REAL(r8), intent(out) :: Z(L)
      Integer, intent(in) :: i_saturation           ! clear-sky flag

!-----------------------------------------------------
! Spectra Catalog 
!----------------------------------------------------

      Type(Catalog_T), INTENT(IN) :: Catalog(:)

      Logical, INTENT(IN) :: Bill_Spectra

!-------------------------------------------------
!     SURFACE REFLECTIVITY
!-------------------------------------------------
! local variables

      ! Reflectivities
      REAL(r8):: RH(NU)                   ! HORIZONTAL
      REAL(r8):: RV(NU)                   ! VERTICAL
      ! Other stuff
      REAL(r8) :: P
      REAL(r8) :: DQ
      REAL(r8) :: DR
      REAL(r8) :: VMR1(NS-1)
      REAL(r8):: X(NU)                    ! SCATTERING ANGLES
      integer :: I
      integer :: J


!-------------------------Begin Execution--------------------------------------

!      CALL HEADER(2)

      QLG   = 0.0_r8
      V0    = 0.0_r8
      GSE   = 0.0_r8
      IST   = 0.0_r8
      WTH   = 0.0_r8
      NTH   = 0.0_r8
      DELTA = 0.0_r8
      N1    = 0.0_r8
      GAMMA = 0.0_r8
      N2    = 0.0_r8
      tau   = 0.0_r8
      tau_wet = 0.0_r8
      tau_dry = 0.0_r8

      If ( .not. Bill_Spectra ) then

        CALL SETUP_SPECTRA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,   &
                    &      GAMMA,N2,MOL,NMOL,NCNT)
      Endif
!-------------------------------------------------
!     GET SURFACE REFLECTIVITY
!-------------------------------------------------

      DO I=1,NU/2
         X(I)=U(I)
      ENDDO

      CALL SURFACE(F,TS,LORS,S,WIND,X,NU/2,NU,RH,RV)
      DO I=1,NU/2
         RS(I)=RH(I)
      ENDDO

      DO I=1,L

         Z(I)=XZ(I+1)-XZ(I)
         T(I)=(XT(I+1)+XT(I))*0.5

         P=(LOG10(XP(I+1))+LOG10(XP(I)))*0.5     
         P=10**P

         DQ=(LOG10( max(1.e-8_r8, XQ(I+1)) )+ &
         &         LOG10( max(1.e-8_r8, XQ(I)) ) )*0.5
         DQ= 10**DQ

         DO J=1,NS-1
            VMR1(J)=(LOG10( max(1.e-19_r8, VMR(J,I+1)) )+ &
                   & LOG10( max(1.e-19_r8, VMR(J,I))  )  )*0.5   ! vmr cannot
            VMR1(J)=10**VMR1(J)                                  ! be zero
         ENDDO

         If ( .not. Bill_Spectra ) then
           !---------------------------------
           ! Using default spectroscopy data
           ! --------------------------------
           CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,  &
                &        NMOL,NCNT,T(I),P,F,DQ,VMR1,DR,NS )   
                                             ! HERE DQ IS H2O MIXING RATIO
           TAU(I)=DR*Z(I)

           IF (i_saturation /= l_clear ) then       ! save time for clear sky
           CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,  &
                &        NMOL,NCNT,T(I),P,F,110._r8,VMR1,DR,NS ) 
                                             ! HERE 110 IS RELATIVE HUMIDITY!
           tau_wet(I)=DR*Z(I)
         
           CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,  &
                &        NMOL,NCNT,T(I),P,F,0.0_r8,VMR1,DR,NS ) 
                                             ! HERE DQ IS vmr
           tau_dry(I)=DR*Z(I)
           Endif
         
         else
           !--------------------------------
           ! Using bill's spectroscopy data
           !--------------------------------
           call get_beta_bill (T(I), P, F, FLO, DQ, VMR1, &
            & NS, DR, Catalog, LosVel)           
           TAU(I)=DR*Z(I)
           
           IF (i_saturation /= l_clear) then    ! save time for clear sky
           call get_beta_bill (T(I), P, F, FLO, 110._r8, VMR1, &
            & NS, DR, Catalog, LosVel)
           tau_wet(I)=DR*Z(I)

           call get_beta_bill (T(I), P, F, FLO, 0.0_r8, VMR1, &
            & NS, DR, Catalog, LosVel)
           tau_dry(I)=DR*Z(I)
           Endif
         endif

      ENDDO

      END SUBROUTINE CLEAR_SKY

!--------------------------- end bloc --------------------------------------
  logical function not_used_here()
  character (len=*), parameter :: IdParm = &
       "$Id: read_apriori.f90 is it here $"
  character (len=len(idParm)) :: Id = idParm
    not_used_here = (id(1:1) == ModuleName(1:1))
    print *, Id ! .mod files sometimes change if PRINT is added
  end function not_used_here
!---------------------------------------------------------------------------

end module ClearSkyModule

! $Log: ClearSkyModule.f90,v $
! Revision 1.26  2008/10/03 21:04:26  livesey
! Added fixes to support EXTINCTIONV2 stuff
!
! Revision 1.25  2005/06/22 18:27:38  pwagner
! Cant have access declared outside module scope
!
! Revision 1.24  2003/05/07 23:14:22  jonathan
! some clean-ups
!
! Revision 1.23  2003/04/10 20:25:35  dwu
! make i_saturation as a verbal argument
!
! Revision 1.22  2003/02/01 06:43:06  dwu
! some fixes
!
! Revision 1.21  2003/01/30 23:48:02  dwu
! add icon=-4 for min Tb and some clearups
!
! Revision 1.20  2003/01/23 00:19:09  pwagner
! Some cosmetic only (or so I hope) changes
!
! Revision 1.19  2002/12/18 16:08:58  jonathan
! minor changes
!
! Revision 1.18  2002/10/08 17:08:07  pwagner
! Added idents to survive zealous Lahey optimizer
!
! Revision 1.17  2002/08/22 00:13:29  jonathan
! upgrade to include more molecules
!
! Revision 1.16  2002/08/08 22:45:57  jonathan
! newly improved version
!
! Revision 1.15  2001/11/20 19:36:46  jonathan
! some changes to save CPU
!
! Revision 1.14  2001/11/16 00:40:52  jonathan
! add losVel
!
! Revision 1.13  2001/11/15 23:53:02  jonathan
! clean log
!
! Revision 1.12  2001/11/15 23:52:28  jonathan
! add default_spectroscopy
!
! Revision 1.11  2001/11/15 00:54:14  jonathan
! minor changes
!
! Revision 1.10  2001/11/14 00:39:42  jonathan
! switch to use bill'd data
!
! Revision 1.9  2001/11/09 22:06:56  jonathan
! add Bill_GasAbsorption Module
!
! Revision 1.8  2001/11/09 18:07:36  jonathan
! add spectra catalog
!
! Revision 1.7  2001/10/04 23:35:15  dwu
! *** empty log message ***
!
! Revision 1.6  2001/09/21 15:51:37  jonathan
! modified F95 version
!

@


1.26
log
@Added fixes to support EXTINCTIONV2 stuff
@
text
@d32 1
a32 1
       "$RCSfile: ClearSkyModule.f90,v $"
d203 1
a204 1
!---------------------------- RCS Ident Info -------------------------------
d206 2
a207 3
       "$Id: ClearSkyModule.f90,v 1.25 2005/06/22 18:27:38 pwagner Exp $"
  character (len=len(idParm)), save :: Id = idParm
!---------------------------------------------------------------------------
d209 1
d211 1
d216 3
@


1.25
log
@Cant have access declared outside module scope
@
text
@d32 1
a32 1
       "$RCSfile: $"
d39 1
a39 1
                 &         F,RS,U,T,Z,TAU,tau_wet, tau_dry, Catalog, &
d61 1
d184 1
a184 1
           call get_beta_bill (T(I), P, F, DQ, VMR1, &
d189 1
a189 1
           call get_beta_bill (T(I), P, F, 110._r8, VMR1, &
d193 1
a193 1
           call get_beta_bill (T(I), P, F, 0.0_r8, VMR1, &
d206 1
a206 1
       "$Id: $"
d215 3
@


1.24
log
@some clean-ups
@
text
@d1 10
a10 2
! Copyright (c) 2003, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
d30 3
a32 6
 !---------------------------- RCS Ident Info -------------------------------
  character (len=*), private, parameter :: IdParm =                          &
    "$Id: ClearSkyModule.f90,v 1.23 2003/04/10 20:25:35 dwu Exp $"
  character (len=len(idParm)), private :: Id = idParm
  character (len=*), private, parameter :: ModuleName=                       &
    "$RCSfile: ClearSkyModule.f90,v $"
d34 1
a34 1
 !---------------------------------------------------------------------------
d203 5
d214 3
@


1.23
log
@make i_saturation as a verbal argument
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.22 2003/02/01 06:43:06 dwu Exp $"
a158 1
!               &        MOL,NMOL,NCNT,T(I),P,F,DQ,VMR1,DR,NS )   
d165 1
a165 2
!               &        MOL,NMOL,NCNT,T(I),P,F,110._r8,VMR1,DR,NS ) 
                                             ! HERE DQ IS RELATIVE HUMIDITY!
a169 1
!               &        MOL,NMOL,NCNT,T(I),P,F,0.0_r8,VMR1,DR,NS ) 
d204 3
@


1.22
log
@some fixes
@
text
@d16 1
d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.21 2003/01/30 23:48:02 dwu Exp $"
d35 1
a35 1
                 &         Bill_Spectra,LosVel, ICON )
d71 1
a71 1
      INTEGER, intent(in) :: ICON              ! CONTROL SWITCH
d163 1
a163 1
           IF (ICON .ne. 0) then             ! save time for clear sky
d185 1
a185 1
           IF (ICON .ne. 0) then            ! save time for clear sky
d207 3
@


1.21
log
@add icon=-4 for min Tb and some clearups
@
text
@d23 1
a23 1
    "$Id: ClearSkyModule.f90,v 1.20 2003/01/23 00:19:09 pwagner Exp $"
a155 1
           IF (ICON .eq. 0) then             ! save time for clear sky
d162 1
a162 1
           Else
d170 3
a172 3
                &        NMOL,NCNT,T(I),P,F,1.e-3_r8,VMR1,DR,NS ) 
!               &        MOL,NMOL,NCNT,T(I),P,F,1.e-3_r8,VMR1,DR,NS ) 
                                             ! HERE DQ IS RELATIVE HUMIDITY!
a179 1
           IF (ICON .eq. 0) then            ! save time for clear sky
d184 1
a184 1
           Else
d189 1
a189 1
           call get_beta_bill (T(I), P, F, 1.e-3_r8, VMR1, &
d206 3
@


1.20
log
@Some cosmetic only (or so I hope) changes
@
text
@d23 1
a23 1
    "$Id: ClearSkyModule.f90,v 1.19 2002/12/18 16:08:58 jonathan Exp $"
d33 2
a34 1
                 &         F,RS,U,T,TAU,Z,TAU100, Catalog, Bill_Spectra,LosVel )
d65 2
a66 1
      REAL(r8), intent(out) :: TAU100(L)
d70 1
d112 3
d156 1
d163 1
d165 2
a166 2
                &        NMOL,NCNT,T(I),P,F,100._r8,VMR1,DR,NS ) 
!               &        MOL,NMOL,NCNT,T(I),P,F,100._r8,VMR1,DR,NS ) 
d168 8
a175 1
           TAU100(I)=DR*Z(I)
d181 1
d183 5
d189 1
a189 2
           
           TAU(I)=DR*Z(I)
d191 1
a191 1
           call get_beta_bill (T(I), P, F, 100._r8, VMR1, &
d193 2
a194 3

           TAU100(I)=DR*Z(I)

d208 3
@


1.19
log
@minor changes
@
text
@d1 1
a1 1
! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
a12 1
      use PrtMsg, only: HEADER
d15 1
a15 1
      use SpectroscopyCatalog_m, only: CATALOG_T, LINE_T, LINES, CATALOG
d23 1
a23 1
    "$Id: ClearSkyModule.f90,v 1.18 2002/10/08 17:08:07 pwagner Exp $"
d48 20
a67 1
      INTEGER :: L, NU, I, J, LORS, NS, n_sps, Spectag
d69 7
a75 4
      REAL(r8) :: RS(NU/2),T(L),TAU(L),U(NU),Z(L),TAU100(L)
      REAL(r8) :: XZ(L+1),XP(L+1),XT(L+1),XQ(L+1)
      REAL(r8) :: VMR(NS-1,L+1),VMR1(NS-1)
      REAL(r8) :: DQ, P, DR, TS, S, WIND, F, LosVel
d82 1
d85 5
d91 2
a93 7
!-----------------------------------------------------
! Spectra Catalog 
!----------------------------------------------------

      Type(Catalog_T), INTENT(IN) :: Catalog(:)

      Logical :: Bill_Spectra
d95 1
a95 1
!-------------------------Begin Execution----------------------------------------
d142 2
a143 2
                   & LOG10( max(1.e-19_r8, VMR(J,I))  )  )*0.5   !vmr cannot be zero
            VMR1(J)=10**VMR1(J)
d151 2
a152 1
                &        MOL,NMOL,NCNT,T(I),P,F,DQ,VMR1,DR,NS )   
d157 2
a158 1
                &        MOL,NMOL,NCNT,T(I),P,F,100._r8,VMR1,DR,NS ) 
d166 2
a167 1
           call get_beta_bill (T(I), P, F, DQ, VMR1, NS, DR, Catalog, LosVel)
d171 2
a172 1
           call get_beta_bill (T(I), P, F, 100._r8, VMR1, NS, DR, Catalog, LosVel)
d189 3
@


1.18
log
@Added idents to survive zealous Lahey optimizer
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.17 2002/08/22 00:13:29 jonathan Exp $"
d114 2
a115 2
         DQ=(LOG10( max(1.e-39_r8, XQ(I+1)) )+ &
         &         LOG10( max(1.e-39_r8, XQ(I)) ) )*0.5
d119 2
a120 2
            VMR1(J)=(LOG10( max(1.e-29_r8, VMR(J,I+1)) )+ &
                   & LOG10( max(1.e-29_r8, VMR(J,I))  )  )*0.5   !vmr cannot be zero
d163 3
@


1.17
log
@upgrade to include more molecules
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.16 2002/08/08 22:45:57 jonathan Exp $"
d28 1
d156 4
d163 3
@


1.16
log
@newly improved version
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.15 2001/11/20 19:36:46 jonathan Exp $"
d52 1
a52 1
      REAL(r8) :: VMR(NS,L+1),VMR1(NS)
d117 1
a117 1
         DO J=1,NS
d141 1
a141 1
           call get_beta_bill (T(I), P, F, DQ, VMR1(1), DR, Catalog, LosVel)
d145 1
a145 1
           call get_beta_bill (T(I), P, F, 100._r8, VMR1(1), DR, Catalog, LosVel)
d158 3
@


1.15
log
@some changes to save CPU
@
text
@d16 1
a16 1
      use SpectroscopyCatalog_m, only: CATALOG_T, LINES
d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.14 2001/11/16 00:40:52 jonathan Exp $"
d128 1
a128 1
                &        MOL,NMOL,NCNT,T(I),P,F,DQ,VMR1,DR,NS)   
d133 1
a133 1
                &        MOL,NMOL,NCNT,T(I),P,F,100._r8,VMR1,DR,NS) 
d158 3
@


1.14
log
@add losVel
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.13 2001/11/15 23:53:02 jonathan Exp $"
d76 16
a91 3
      CALL SETUP_SPECTRA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,   &
                  &      GAMMA,N2,MOL,NMOL,NCNT)

d158 3
@


1.13
log
@clean log
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.12 2001/11/15 23:52:28 jonathan Exp $"
d33 1
a33 1
                 &         F,RS,U,T,TAU,Z,TAU100, Catalog, Bill_Spectra )
d53 1
a53 1
      REAL(r8) :: DQ, P, DR, TS, S, WIND, F
d128 1
a128 1
           call get_beta_bill (T(I), P, F, DQ, VMR1(1), DR, Catalog)
d132 1
a132 1
           call get_beta_bill (T(I), P, F, 100._r8, VMR1(1), DR, Catalog)
d145 3
@


1.12
log
@add default_spectroscopy
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.11 2001/11/15 00:54:14 jonathan Exp $"
a75 6
      if (.not. Bill_Spectra) print*, 'bill is not true'
      if (Bill_Spectra) print*, 'bill is true'
      stop

!      Bill_Spectra = .false.

d145 3
@


1.11
log
@minor changes
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.10 2001/11/14 00:39:42 jonathan Exp $"
d33 1
a33 1
                 &         F,RS,U,T,TAU,Z,TAU100, Catalog )
d76 5
a80 1
      Bill_Spectra = .false.
d151 3
@


1.10
log
@switch to use bill'd data
@
text
@d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.9 2001/11/09 22:06:56 jonathan Exp $"
a77 6
!      n_sps = Size(Catalog)

!      DO i = 1, n_sps
!        Spectag = Catalog(i)%Spec_Tag
!      Enddo
      
d147 3
@


1.9
log
@add Bill_GasAbsorption Module
@
text
@d16 1
a16 1
      use SpectroscopyCatalog_m, only: CATALOG_T
d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.8 2001/11/09 18:07:36 jonathan Exp $"
d119 1
a119 1

d121 1
a121 1

d133 10
a143 2
           ! Using bill's spectroscopy data
           call get_beta_bill (T(I), P, F, DQ, VMR1, DR, NS, Catalog)
d153 3
@


1.8
log
@add spectra catalog
@
text
@d10 1
d16 1
a16 1
      use SpectroscopyCatalog_m, only: CATALOG_T, LINES
d24 1
a24 1
    "$Id: ClearSkyModule.f90,v 1.7 2001/10/04 23:35:15 dwu Exp $"
d48 2
a49 1
      INTEGER :: L, NU, I, J, LORS, NS
d59 1
d70 4
a73 1
!------------------------------------------------------------------------
d75 8
d105 1
a105 1
         P=(LOG10(XP(I+1))+LOG10(XP(I)))*0.5     !!! NEED TO CHANGE TO P(I)
a107 2
!         DQ=(XQ(I+1)+XQ(I))*0.5

d118 6
a123 2
         CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,  &
              &        MOL,NMOL,NCNT,T(I),P,F,DQ,VMR1,DR,NS)   
d125 1
a125 1
         TAU(I)=DR*Z(I)
d127 2
a128 2
         CALL GET_BETA(QLG,V0,GSE,IST,WTH,NTH,DELTA,N1,GAMMA,N2,  &
              &        MOL,NMOL,NCNT,T(I),P,F,100._r8,VMR1,DR,NS) 
d130 7
a136 1
         TAU100(I)=DR*Z(I)
d145 3
@


1.7
log
@*** empty log message ***
@
text
@d15 1
d23 1
a23 1
    "$Id: ClearSkyModule.f90,v 1.6 2001/09/21 15:51:37 jonathan Exp $"
d32 1
a32 1
                 &         F,RS,U,T,TAU,Z,TAU100)
d61 6
d123 3
@


1.6
log
@modified F95 version
@
text
@d22 1
a22 1
    "$Id: ClearSkyModule.f90,v 1.5 2001/09/20 23:39:51 jonathan Exp $"
d61 1
a61 1
      CALL HEADER(2)
d116 3
@


1.5
log
@*** empty log message ***
@
text
@d22 1
a22 1
    "$Id: ClearSkyModule.f90,v 1.4 2001/09/20 21:21:47 jonathan Exp $"
d115 1
a115 1
! $Log: ClearSkyModule.f90,v      
@


1.4
log
@*** empty log message ***
@
text
@d12 1
d22 1
a22 1
    "$Id: ClearSkyModule.f90,v 1.3 2001/09/20 20:20:00 jonathan Exp $"
@


1.3
log
@*** empty log message ***
@
text
@d13 1
d21 1
a21 1
    "$Id: ClearSkyModule.f90,v 1.2 2001/09/20 19:55:17 jonathan Exp $"
@


1.2
log
@*** empty log message ***
@
text
@d12 1
d20 1
a20 1
    "$Id: ClearSkyModule.f90,v 1.1 2001/09/20 16:36:09 jonathan Exp $"
@


1.1
log
@*** empty log message ***
@
text
@d10 1
d19 1
a19 1
    "$Id: ClearSkyModule.f90,v 1.1 2001/09/19 19:23:44 jonathan Exp $"
@

