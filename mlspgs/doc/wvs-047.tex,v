head	1.1;
access;
symbols
	v5-02-NRT-19:1.1
	v6-00:1.1
	v5-02-NRT-18:1.1
	v5-02:1.1
	v5-01-NRT-17:1.1
	v5-01-NRT-16:1.1
	v5-01-NRT-15:1.1
	v5-01-NRT-14:1.1
	neuralnetworks-1-0:1.1.0.14
	cfm-single-freq-0-1:1.1.0.12
	v5-01:1.1
	v5-00:1.1
	v4-23-TA133:1.1.0.10
	mus-emls-1-70:1.1.0.8
	rel-1-0-englocks-work:1.1.0.6
	VUMLS1-00:1.1
	VPL1-00:1.1
	V4-22-NRT-08:1.1
	VAM1-00:1.1
	V4-21:1.1.0.4
	V4-13:1.1
	V4-12:1.1
	V4-11:1.1
	V4-10:1.1
	V3-43:1.1
	M4-00:1.1
	V3-41:1.1
	V3-40-PlusGM57:1.1.0.2
	V3-33:1.1
	V3-31:1.1
	V3-30-NRT-05:1.1
	cfm-01-00:1.1
	V3-30:1.1
	V3-20:1.1
	V3-10:1.1;
locks; strict;
comment	@% @;


1.1
date	2008.06.11.20.14.53;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial commit
@
text
@\documentclass[11pt]{article}
\usepackage[fleqn]{amsmath}\textwidth 6.5in
\oddsidemargin -0.25in
%\evensidemargin -0.5in
\topmargin -0.25in
%\textheight 9.25in
\textheight 9in

\newcommand{\docname}{\bf wvs-047r2}
\newcommand{\docdate}{20 October 2006}

\newcommand{\diff}[2]{\frac{\text{d}#1}{\text{d}#2}}

\usepackage{longtable}

\begin{document}

%\tracingcommands=1
\newlength{\hW} % heading box width
\newlength{\pW} % page number field width
\settowidth{\hW}{\docname}
\settowidth{\pW}{Page \pageref{lastpage}\ of \pageref{lastpage}}
\ifdim \pW > \hW \setlength{\hW}{\pW} \fi
\makeatletter
\def\@@biblabel#1{#1.}
\newcommand{\ps@@twolines}{%
  \renewcommand{\@@oddhead}{%
    \docdate\hfill\parbox[t]{\hW}{{\hfill\docname}\newline
                          Page \thepage\ of \pageref{lastpage}}}%
\renewcommand{\@@evenhead}{}%
\renewcommand{\@@oddfoot}{}%
\renewcommand{\@@evenfoot}{}%
}%
\makeatother
\pagestyle{twolines}

%\vspace*{-40pt}
\begin{tabbing}
\phantom{References: }\= \\
To: \>Bill\\
Subject: \>Revised metrics plan\\
From: \>Van Snyder\\
\end{tabbing}
%\vspace*{-25pt}

\parindent 0pt \parskip 6pt

\begin{enumerate}

\item\label{one} Calculate an initial coarse $\zeta$ grid as the union of
the $\zeta$ grids for temperature, the tangent grid, and all species.  The
forward model already does this in {\tt Compute\_Z\_Grid\_m}.

\item Calculate tangent $\phi$ by interpolating from the initial coarse
$\zeta$ grid to {\tt ptan} in {\tt phitan}.  The forward model already
does this in {\tt Estimate\_tan\_phi} in {\tt FullForwardModel\_m}.

\item\label{hydro} Calculate reference arrays on the initial coarse
$\zeta$ grid and the temperature $\phi$ basis.  The forward model already
does this in the {\tt two\_d\_hydrostatic} routine.

\item For each pointing

\begin{enumerate}

\item Use the initial coarse $\zeta$ and height reference arrays as
current ones.

\item\label{zeta} Repeat

\begin{enumerate}

\item\label{current} Using the current $\zeta$ grid, a record of which
$\zeta$s appear on each side of the tangent, and the current reference
height array, calculate heights along the line of sight at each $\zeta$,
then calculate $\phi$ for each $\zeta$ along the line of sight using
those heights, similarly to how it is presently done in {\tt metrics}.

\item\label{inner} Calculate the minimum $\zeta$ and its corresponding
$\phi$ for the tangent height using the method in {\tt wvs-045}.  An
alternative, not to be used at this time, is to calculate the minimum
height for the tangent $\zeta$ and its corresponding $\phi$ using Hermite
interpolation in the reference height array ( see {\tt wvs-046}).

\item\label{three} After the remainder of the forward model is modified
to work with a path on which the tangent is not necessarily the one with
the central index, use the $\phi$s and heights calculated in steps
(\ref{current}) and (\ref{inner}) and inverse interpolation in the height
reference grid to calculate $\zeta$s for temperature basis $\phi$s (and
for the $\phi$ calculated in step (\ref{inner}) if the method from {\tt
wvs-046} is used).  Discard any $\zeta$ and its associated $\phi$ if it
is too close to one calculated in step (\ref{one}), and any $\phi$ and
it's associated $\zeta$ if it is too close to one calculated in step
(\ref{current}) or (\ref{inner}).

\item Until the forward model is modified to work with a path on which
the tangent is not necessarily the one with the central index, for each
$\phi$ calculated in step (\ref{current}) or (\ref{inner}) and not
discarded in step (\ref{three}), calculate a $\phi$ positioned
approximately symmetrically with respect to the tangent $\phi$ and use
inverse interpolation in the current reference height array to calculate
a corresponding $\zeta$.  Retain that $\zeta$ only if it is not near one
calculated in step (\ref{one}) or (\ref{inner}).  Unlike the current
version of metrics, this could result in a $\zeta$ array that is not
symmetric with respect to the tangent point.

\item\label{augment} When step (\ref{three}) is implemented, discard any
$\zeta$s calculated in step (\ref{inner}) or (\ref{three}) in a prior
iteration, then augment the $\zeta$ grid using the $\zeta$s newly
calculated in step (\ref{zeta}), giving a new current $\zeta$ grid.  Keep
track of which side(s) of the tangent a new $\zeta$ is used.

\item\label{h_ref} Calculate a new current height reference array by
interpolating in the original height reference array from the original
$\zeta$s to the ones added in step (\ref{augment}).

\end{enumerate}

until no new zetas are inserted and revised zetas are close to previously
inserted ones.  The first revision may be good enough.

\item\label{GL} Insert GL zetas into the $\zeta$ grid augmented by step
(\ref{augment}).

\item\label{fine_h} Calculate a new height reference array by
interpolating in the height reference array produced in step
(\ref{h_ref}) from the $\zeta$s calculated in step (\ref{zeta}) to the GL
$\zeta$s

\item\label{fine_t} Calculate a new temperature reference array by
interpolating in the temperature reference array produced in step
(\ref{hydro}) from the original zetas to the $\zeta$s added in steps
(\ref{augment}) and (\ref{GL}).

\item\label{final} Use the temperature and height reference arrays
calculated in steps (\ref{fine_h}) and (\ref{fine_t}), and a record of
which $\zeta$s appear on each side of the tangent, to calculate heights,
$\phi$s and derivatives at each $\zeta$ along each line of sight
similarly to how it is presently done in {\tt metrics}.

\end{enumerate}

\end{enumerate}

To see that $\zeta$s added in step (\ref{augment}) might not appear on
both sides of the tangent, consider adding one temperature-basis $\phi$
point to the line of sight.  In order to preserve the symmetry of the
number of points on each side of the tangent point along the line of
sight, we add one (roughly) symmetrically placed with respect to the
tangent.  There is no guarantee that the $\zeta$ value will be the same
on both sides.  If we use both $\zeta$s on both sides of the tangent, we
could have to add two $\phi$s on each side, not one.  Each $\phi$ added
to mirror another one could have a new $\zeta$.  There doesn't appear to
be a guarantee that this would be the end of the line:  We could go on
adding $\zeta$s and $\phi$s indefinitely.  If and when the forward model
is modified so as not to require the tangent point to be the one with
central index, this consideration will no longer be germane.

To provide for the possibility that $\zeta$s added in step
(\ref{augment}) might not appear on both sides of the tangent, {\tt
metrics} will have a $\zeta$-index array that maps from the augmented
$\zeta$ grid to the {\tt z\_grid} that is one of the {\tt metrics}
outputs.  Imagine that we eventually have 10 $\zeta$s, and of those, the
second one is $\zeta_{\text{min}}$, the third one is its $\phi$-symmetric
image (perhaps with different $\zeta$) on the other side of the tangent,
the fifth one arises from a temperature-basis $\phi$, and the sixth one
arises from its $\phi$-symmetric image on the other side of the tangent
(again possibly with different $\zeta$), while 1, 4, 7, 8, 9, 10 are from
the original coarse $\zeta$ grid.  Then on one side of the tangent, the
$\zeta$ indices would be 1, 2, 4, 5, 7, 8, 9, 10, while on the other side
they would be 1, 3, 4, 6, 7, 8, 9, 10.  The {\tt h\_ref} array would have
10 rows, but for the calculations in step (\ref{h_ref}) the $\zeta$-index
array would be used to interpolate in rows 10, 9, 8, 7, 6, 4, 3, 1, 1, 2,
4, 5, 7, 8, 9, 10 to calculate along the line of sight.

Ultimately, a similar $\zeta$-index, this one also accounting for GL
points, is needed in step (\ref{final}).

\label{lastpage}
\end{document}
% $Id: wvs-047r2.tex,v 1.1 2008/06/11 20:14:53 vsnyder Exp $
@
