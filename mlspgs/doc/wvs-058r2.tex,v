head	1.1;
access;
symbols
	v5-02-NRT-19:1.1
	v6-00:1.1
	v5-02-NRT-18:1.1
	v5-02:1.1
	v5-01-NRT-17:1.1
	v5-01-NRT-16:1.1
	v5-01-NRT-15:1.1
	v5-01-NRT-14:1.1
	neuralnetworks-1-0:1.1.0.14
	cfm-single-freq-0-1:1.1.0.12
	v5-01:1.1
	v5-00:1.1
	v4-23-TA133:1.1.0.10
	mus-emls-1-70:1.1.0.8
	rel-1-0-englocks-work:1.1.0.6
	VUMLS1-00:1.1
	VPL1-00:1.1
	V4-22-NRT-08:1.1
	VAM1-00:1.1
	V4-21:1.1.0.4
	V4-13:1.1
	V4-12:1.1
	V4-11:1.1
	V4-10:1.1
	V3-43:1.1
	M4-00:1.1
	V3-41:1.1
	V3-40-PlusGM57:1.1.0.2
	V3-33:1.1
	V3-31:1.1
	V3-30-NRT-05:1.1
	cfm-01-00:1.1
	V3-30:1.1
	V3-20:1.1
	V3-10:1.1;
locks; strict;
comment	@% @;


1.1
date	2008.06.11.20.14.54;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial commit
@
text
@\documentclass[11pt]{article}
\usepackage[fleqn]{amsmath}\textwidth 6.5in
\oddsidemargin -0.25in
%\evensidemargin -0.5in
\topmargin -0.25in
\textheight 9in

\newcommand{\docname}{\bf wvs-058r2}
\newcommand{\docdate}{22 October 2007}

\begin{document}

%\tracingcommands=1
\newlength{\hW} % heading box width
\newlength{\pW} % page number field width
\settowidth{\hW}{\docname}
\settowidth{\pW}{Page \pageref{lastpage}\ of \pageref{lastpage}}
\ifdim \pW > \hW \setlength{\hW}{\pW} \fi
\makeatletter
\def\@@biblabel#1{#1.}
\newcommand{\ps@@twolines}{%
  \renewcommand{\@@oddhead}{%
    \docdate\hfill\parbox[t]{\hW}{{\hfill\docname}\newline
                          Page \thepage\ of \pageref{lastpage}}}%
\renewcommand{\@@evenhead}{}%
\renewcommand{\@@oddfoot}{}%
\renewcommand{\@@evenfoot}{}%
}%
\makeatother
\pagestyle{twolines}

\vspace{-10pt}
\begin{tabbing}
\phantom{References: }\= \\
To: \>Dong, Van\\
Subject: \>Mie solution in terms of Bessel functions\\
From: \>Van Snyder\\
\end{tabbing}

\parindent 0pt \parskip 6pt
\vspace{-10pt}

The quantities in section 4.4.2.1 \emph{Mie efficiencies} in JPL D-19299,
EOS MLS Algorithm Theoretical Basis for Cloud Measurements, use $j$ for a
subscript.  To avoid confusion with the spherical Bessel function of the
first kind, $n$ is used here instead.

The recurrence and initial conditions given for $W_n$, \emph{viz.}
%
\begin{equation}\begin{split}\label{three}
W_n =\,& \left(\frac{2n-1}{\chi}\right) W_{n-1} - W_{n-2}\\
W_0 =\,& \sin\chi + i \cos\chi = i e^{-i \chi}\\
W_{-1} =\,& \cos\chi - i \sin\chi = e^{-i \chi}
\end{split}\end{equation}
%
define a Hankel function of the second kind of half-integer order, \emph{viz.}
%
\begin{equation}\label{four}
W_n = \sqrt{\frac{\pi \chi}2}
        \left( J_{n+\frac12} (\chi) - i Y_{n+\frac12}(\chi) \right) =
      \chi\, (j_n(\chi) - i\, y_n(\chi)) =
      \sqrt{\frac{\pi \chi}2}\, H^{(2)}_{n+\frac12}(\chi) =
      \chi\, h^{(2)}_n (\chi)\,.
\end{equation}
%
The subroutine {\tt MieCoeff} in the module {\tt MieTheory} evaluates
$W_n$ using this recurrence in the forward direction.

Every second-order recurrence has two solutions.  Typically, one grows in
magnitude as the index increases, and the other shrinks.  When the
recurrence is evaluated in finite arithmetic, a combination of its two
solutions is necessarily computed.  When it is evaluated in the forward
direction, the solution that grows as the index increases comes to
dominate the calculation.  When it is evaluated in the reverse direction,
the solution that grows as the index decreases comes to dominate the
solution.

The real part of $h^{(2)}_n(\chi)$ decreases as $n$ increases, and the
imaginary part increases.  Thus the recurrence in Equation (\ref{three})
is unstable in the forward direction for the real part of the solution,
and unstable in the reverse direction for the imaginary part of the
solution, unless $n \ll (\chi+1)/2$.  For $n > (\chi+1)/2$, forward
recurrence eventually computes $y_n(\chi)+i y_n(\chi)$, and backward
recurrence eventually computes $j_n(\chi)+i j_n(\chi)$, no matter what
initial conditions are given:  The real and imaginary parts need to be
computed separately, the real part by backward recurrence, and the
imaginary part by forward recurrence.

High-quality library routines ought to be used instead of the recurrence
in 4.4.2.1 to compute $W_n$.

The recurrence and initial condition given for $A_n$, \emph{viz.}
%
\begin{equation}\begin{split}\label{five}
A_n =\,& - \frac{n}{m \chi} + \left( \frac{n}{m \chi} - A_{n-1} \right) ^{-1} \\
A_0 =\,& \text{cot} (m \chi)
\end{split}\end{equation}
%
define an expression involving Bessel functions, \emph{viz.}
%
\begin{equation}\label{six}
A_n = - \frac{n}{m \chi} + \frac{J_{n-\frac12}(m \chi)}{J_{n+\frac12}(m \chi)}
    = - \frac{n}{m \chi} + \frac{j_{n-1}(m \chi)}{j_n(m \chi)}.
\end{equation}
%
Even though the recurrence for $A_n$ is a first-order
recurrence, it is not stable in both directions.  When evaluated in the
forward direction, no matter what initial conditions are used, it
eventually computes
%
\begin{equation}
A_n = - \frac{n}{m \chi} + \frac{Y_{n-\frac12}(m \chi)}{Y_{n+\frac12}(m \chi)}
    = - \frac{n}{m \chi} + \frac{y_{n-1}(m \chi)}{y_n(m \chi)}.
\end{equation}
%
There is furthermore the possibility that $\frac{n}{m \chi} - A_{n-1} =
0$ for some values of $n$, $m$ and $\chi$.  When evaluated in the reverse
direction, \emph{viz}.
\begin{equation}
A_{n-1} = \frac{n}{m \chi} - \left( \frac{n}{m \chi} + A_n \right)^{-1}\,,
\end{equation}
%
it quickly settles down to Equation (\ref{six}).  Using the
asymptotic approximation for $J_\nu(z)$ for fixed $z$ as $\nu$ grows,
\emph{viz}.
%
\begin{equation}
J_\nu(z) \sim \frac1{\sqrt{2\pi\nu}} \left(\frac{e}{\nu}\right)^\nu
                 \left(\frac{z}2\right)^\nu
\end{equation}
%
and for $\Gamma(\nu)$, \emph{viz}.
%
\begin{equation}
\Gamma(\nu) \sim \sqrt{\frac2{\pi\nu}} \left(\frac{\nu}e\right)^\nu
\end{equation}
%
one gets an asymptotic approximation for $A_n$, \emph{viz}.
\begin{equation}\label{asymp}
A_n \sim \frac{n+1}\chi\,.
\end{equation}
%
Starting with $n$ somewhat larger than the largest desired value, using
the asymptotic approximation for $A_n$ given in Equation (\ref{asymp})
gives slightly better results for the largest values of $n$ than does
starting with zero, but within a few iterations the results are
indistinguishable.

The quantities $a_n$ and $b_n$, \emph{viz.}
%
\begin{equation}
a_n = \frac{(A_n/m + n/\chi) \Re(W_n) - \Re(W_{n-1})}
           {(A_n/m + n/\chi) W_n - W_{n-1}}
\end{equation}
\begin{equation}
b_n= \frac{(m A_n + n/\chi) \Re(W_n) - \Re(W_{n-1})}
           {(m A_n + n/\chi) W_n - W_{n-1}}
\end{equation}
%
are expressions involving Bessel functions. Their reciprocals in terms of
spherical Bessel functions of the first and second kind are
%
\begin{equation}\begin{split}
\frac1{a_n} =\,& 1 - i \frac{\left(n(1-m^2) j_n(m \chi) -
                                   m \chi j_{n-1} (m \chi) \right) y_n(\chi) +
                              m^2 \chi j_n(m \chi) y_{n-1}(\chi)}
                            {\left(n(1-m^2) j_n (m \chi) +
                                   m \chi j_{n-1}(m \chi) \right) j_n(\chi) +
                              m^2 \chi j_n(m \chi) j_{n-1}(\chi)}
\\
\frac1{b_n} =\,& 1 - i \frac{m\, y_n(\chi) j_{n-1}(m \chi) -
                             y_{n-1}(\chi) j_n(m \chi)}
                            {m\, j_n(\chi) j_{n-1}(m \chi) -
                             j_{n-1}(\chi) j_n(m \chi)}
\end{split}\end{equation}
%
Assuming Equation (\ref{five}) is stable, and writing $A_n$ instead of
its equivalent in terms of Bessel functions, the reciprocals of $a_n$ and
$b_n$ can be written succinctly in terms of Bessel functions with real
arguments, i.e., that don't involve $m$, which is the complex index of
refraction.
%
\begin{equation}\begin{split}
\frac1{a_n} =\,& 1 - i \frac{(A_n/m + n/\chi) y_n(\chi) - y_{n-1}(\chi)}
                    {(A_n/m + n/\chi) j_n(\chi) - j_{n-1}(\chi)}
          = 1 - i \frac{(A_n/m + n/\chi) Y_{n+\frac12}(\chi) - Y_{n-\frac12}(\chi)}
                    {(A_n/m + n/\chi) J_{n+\frac12}(\chi) - J_{n-\frac12}(\chi)} \\
\frac1{b_n} =\,& 1 - i \frac{(A_n m + n/\chi) y_n(\chi) - y_{n-1}(\chi)}
                    {(A_n m + n/\chi) j_n(\chi) - j_{n-1}(\chi)}
          =1 - i \frac{(A_n m + n/\chi) Y_{n+\frac12}(\chi) - Y_{n-\frac12}(\chi)}
                    {(A_n m + n/\chi) J_{n+\frac12}(\chi) - J_{n-\frac12}(\chi)}
\,,
\end{split}\end{equation}
%
where factors of $\sqrt{\frac{\pi\chi}2}$ have been canceled in the latter
forms.  The minus signs arise from $h^{(2)}_n(\chi) =
j_n(\chi)-y_n(\chi)$.

This doesn't separate the real and imaginary parts, since $A_n$ and $m$
are complex.

Another approach to evaluating $W_n$ is to define $\Omega_n =
\frac{W_n}{W_{n-1}}$, and divide Equation (\ref{three}) by $W_{n-1}$
giving
%
\begin{equation}
\Omega_n = \frac{2n-1}\chi - \frac1{\Omega_{n-1}} ,\,\,
\Omega_0 = i
\end{equation}
%
For positive real $\chi$, the real and imaginary parts of $\Omega_n$ are
both positive and finite.  For fixed $n$ as $\chi \rightarrow \infty$,
$\Omega_n \sim n/\chi + i$.  $W_n$ can then be computed using $W_n =
\Omega_n W_{n-1}$.  The first four values of $\Omega_n$ are
%
\begin{equation}\begin{array}{c}
 i \\
 \\
 \frac1\chi+i \\
 \\
 2\frac{\chi^2+\frac32}{\chi(\chi^2+1)} + i \frac{\chi^2}{\chi^2+1} \\
 \\
 3\frac{\chi^4+4\chi^2+15}{\chi(\chi^4+3\chi^2+9)} +
   i \frac{\chi^4}{\chi^4+3\chi^2+9}\,.
\end{array}\end{equation}
%
Similarly, defining $\omega_n = \frac{W_{n-1}}{W_n}$ we have
\begin{equation}
\omega_n = \frac\chi{2 n - 1 - \chi \omega_{n-1}},\,\, \omega_0 = -i\,.
\end{equation}
%
For positive real $\chi$, the real and imaginary parts of $\omega_n$ are
both positive and finite.  For fixed $n$ as $\chi \rightarrow \infty$,
$\omega_n \sim n/\chi - i$.  $W_n$ can then be computed using $W_n =
\frac{\omega_n}{W_{n-1}}$.  The first four values of $\omega_n$ are
%
\begin{equation}\begin{array}{c}
 -i \\
 \\
 \frac\chi{\chi^2+1} - i \frac{\chi^2}{\chi^2+1}\\
 \\
 2 \chi \frac{\chi^2+\frac32}{\chi^4+3\chi^2+9} -
  i \frac{\chi^4}{\chi^4+3\chi^2+9}\\
 \\
 3 \chi \frac{\chi^4+4\chi^2+15}{\chi^6+6\chi^4+45=chi^2+225} -
  i \frac{\chi^6}{\chi^6+6\chi^4+45\chi^2+225}\,.
\end{array}\end{equation}

\label{lastpage}
\end{document}
% $Id: $
@
