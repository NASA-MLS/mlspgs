head	1.1;
access;
symbols
	v5-02-NRT-19:1.1
	v6-00:1.1
	v5-02-NRT-18:1.1
	v5-02:1.1
	v5-01-NRT-17:1.1
	v5-01-NRT-16:1.1
	v5-01-NRT-15:1.1
	v5-01-NRT-14:1.1
	neuralnetworks-1-0:1.1.0.14
	cfm-single-freq-0-1:1.1.0.12
	v5-01:1.1
	v5-00:1.1
	v4-23-TA133:1.1.0.10
	mus-emls-1-70:1.1.0.8
	rel-1-0-englocks-work:1.1.0.6
	VUMLS1-00:1.1
	VPL1-00:1.1
	V4-22-NRT-08:1.1
	VAM1-00:1.1
	V4-21:1.1.0.4
	V4-13:1.1
	V4-12:1.1
	V4-11:1.1
	V4-10:1.1
	V3-43:1.1
	M4-00:1.1
	V3-41:1.1
	V3-40-PlusGM57:1.1.0.2
	V2-24-NRT-04:1.1
	V3-33:1.1
	V2-24:1.1
	V3-31:1.1
	V3-30-NRT-05:1.1
	cfm-01-00:1.1
	V3-30:1.1
	V3-20:1.1
	V3-10:1.1
	V2-23-NRT-02:1.1
	V2-23:1.1
	V2-22-NRT-01:1.1
	V2-22:1.1
	V2-21:1.1
	V2-20:1.1
	V2-11:1.1
	V2-10:1.1
	V2-00:1.1;
locks; strict;
comment	@# @;


1.1
date	2005.10.01.00.36.28;	author pwagner;	state Exp;
branches;
next	;


desc
@@


1.1
log
@First commit
@
text
@#!/bin/sh
# --------------- pvmhost help
#pvmhost.sh
#add/delete the pvmhost[s] to/from the currently available ones
#
#Usage:
#pvmhost.sh option1 [option2] .. pvmhost1 [pvmhost2] ..
#
#    O p t i o n s
# -dryrun     don't run the actual pvm commands
# -add        add the pvmhosts to list
# -delete     delete the pvmhosts from list
# -mstat      print the whole status line of the pvmhost; e,g,
#              c0-181  No such host
# -s          show the status of the pvmhost [0 is ok, 1 is not]
#              (whose value can be used in tests conveniently)
# -h[elp]     print brief help message; exit
#
# Note:
# 
# Result:
# Won't try to spawn jobs to deficient nodes
# --------------- End pvmhost help
# Copyright 2005, by the California Institute of Technology. ALL
# RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
# commercial use must be negotiated with the Office of Technology Transfer
# at the California Institute of Technology.

# This software may be subject to U.S. export control laws. By accepting this
# software, the user agrees to comply with all applicable U.S. export laws and
# regulations. User has the responsibility to obtain export licenses, or other
# export authority as may be required before exporting such information to
# foreign countries or providing access to foreign persons.

# "$Id: pvmhost.sh,v 1.4 2005/06/23 22:20:45 pwagner Exp $"

# ************
# Main Program
# ************
me="$0"
my_name=pvmhost
I=pvmhost
OK=0
notOK=1
dryrun="no"
command=""
more_opts="yes"
while [ "$more_opts" = "yes" ] ; do

    case "$1" in

    -dryrun )
	    shift
       dryrun="yes"
       ;;
    -h | -help )
       sed -n '/'$my_name' help/,/End '$my_name' help/ p' $me \
           | sed -n 's/^.//p' | sed '1 d; $ d'
       exit
	     ;;
    -* )
       command=`echo "$1" | sed 's/-//'`
       shift
       ;;
    * )
       more_opts="no"
       ;;
    esac
done
# if [ $# -lt 1 ]
# then
#   echo "Usage: pvmhost.sh pvmhost1 [pvmhost2] .."
#   exit 1
# fi
for pvmhost
do
  if [ "$dryrun" = "yes" ]
  then
    echo "$command from pvm table $pvmhost"
  else
    case "$command" in
      delete | add | mstat )
      echo "$command from pvm table $pvmhost"
      pvm << EOF
      $command $pvmhost
      quit
EOF
    ;;
      s )
      result=`pvm << EOFs
      mstat $pvmhost
      quit
EOFs
`
      s=`echo $result | grep ' ok '`
      if [ "$s" = "" ]
      then
        echo $notOK
      else
        echo $OK
      fi
    ;;
      * )
      echo "$command from pvm table $pvmhost (not recognized)"
      pvm << EOFt
      $command $pvmhost
      quit
EOFt
    ;;
    esac
  fi
done
exit 0
# $Log: nodestatus.sh,v $
@
