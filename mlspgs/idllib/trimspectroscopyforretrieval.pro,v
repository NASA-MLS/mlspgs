head	1.2;
access;
symbols
	v5-02-NRT-19:1.2
	v6-00:1.2
	v5-02-NRT-18:1.2
	v5-02:1.2
	v5-01-NRT-17:1.2
	v5-01-NRT-16:1.2
	v5-01-NRT-15:1.2
	v5-01-NRT-14:1.2
	neuralnetworks-1-0:1.2.0.14
	cfm-single-freq-0-1:1.2.0.12
	v5-01:1.2
	v5-00:1.2
	v4-23-TA133:1.2.0.10
	mus-emls-1-70:1.2.0.8
	rel-1-0-englocks-work:1.2.0.6
	VUMLS1-00:1.2
	VPL1-00:1.2
	V4-22-NRT-08:1.2
	VAM1-00:1.2
	V4-21:1.2.0.4
	V4-13:1.2
	V4-12:1.2
	V4-11:1.2
	V4-10:1.2
	V3-43:1.2
	M4-00:1.2
	V3-41:1.2
	V3-40-PlusGM57:1.2.0.2
	V2-24-NRT-04:1.2
	V3-33:1.2
	V2-24:1.2
	V3-31:1.2
	V3-30-NRT-05:1.2
	cfm-01-00:1.2
	V3-30:1.2
	V3-20:1.2
	V3-10:1.2
	V2-23-NRT-02:1.2
	V2-23:1.2
	V2-22-NRT-01:1.2
	V2-22:1.2
	V2-21:1.2
	V2-20:1.2
	V2-11:1.2
	V2-10:1.2
	V2-00:1.2
	V1-51:1.2
	V1-50:1.2
	V1-45:1.2
	V1-44:1.2
	V1-43:1.2;
locks; strict;
comment	@# @;


1.2
date	2004.04.01.00.23.36;	author livesey;	state Exp;
branches;
next	1.1;

1.1
date	2004.02.12.01.46.24;	author livesey;	state Exp;
branches;
next	;


desc
@@


1.2
log
@New algorithm better reflects what Bill originally did.
@
text
@pro TrimSpectroscopyForRetrieval, data

noMolecules = n_elements(data)

for mol = 0, noMolecules - 1 do begin
  noLines = data(mol).no_lines
  for line = 0, noLines - 1 do begin
    bands = data(mol).eos_bands(line)
    frq = data(mol).frq(line)
    words = strtrim ( strsplit ( bands, ',', /extract ), 2)
    noBands = n_elements(words)
    scoreL = 0
    scoreU = 0
    for band = 0, noBands - 1 do begin
      scoreL += max ( words(band) eq [ 'B2L', 'B3L', 'B4L', 'B5L', 'B6L', 'B23L', 'B27L' ] )
      scoreU += max ( words(band) eq [ 'B2U', 'B3U', 'B4U', 'B5U', 'B6U', 'B23U', 'B27U' ] )
    endfor
    ;; Only bother with cases where all of R2 (U/L) listed
    if scoreL ne 7 and scoreU ne 7 then continue
    ;; Skip the 183GHz h2o line
    if data(mol).name eq 'H$_{2}$O' and $
      frq gt 183310.116d0 and frq lt 183310.118d0 then continue
    if scoreL eq 7 and scoreU eq 7 then begin
      print,'The retrieval spectroscopy generator hit a case it was not trained for'
      stop
    endif
    newBands = ''
    if scoreL eq 7 then begin
      if frq lt 180500.0d0 $
        then newBands = 'B5L, B6L, B27L' $
      else newBands = 'B2L, B3L, B4L, B5L, B6L, B23L, B27L'
    endif
    if scoreU eq 7 then begin
      if newBands ne '' then newBands = newBands + ', '
      if frq gt 203500.0d0 $
        then newBands = newBands + 'B5U, B6U, B27U' $
      else newBands = newBands + 'B2U, B3U, B4U, B5U, B6U, B23U, B27U'
    endif
    data(mol).eos_bands(line) = newBands
  endfor
endfor

end
@


1.1
log
@First version
@
text
@d31 1
a31 1
      else newBands = 'B2L, B3L, B4L, B23L'
d35 1
a35 1
      if frq gt 203000.0d0 $
d37 1
a37 1
      else newBands = newBands + 'B2U, B3U, B4U, B23U'
@

