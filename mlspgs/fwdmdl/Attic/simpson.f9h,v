head	2.7;
access;
symbols
	V3-43:2.6
	V3-41:2.6
	V3-40-PlusGM57:2.6.0.2
	V2-24-NRT-04:2.6
	V3-33:2.6
	V2-24:2.6
	V3-31:2.6
	V3-30-NRT-05:2.6
	cfm-01-00:2.6
	V3-30:2.6
	V3-20:2.6
	V3-10:2.6
	V2-23-NRT-02:2.6
	V2-23:2.6
	V2-22-NRT-01:2.6
	V2-22:2.6
	V2-21:2.6
	V2-20:2.6
	V2-11:2.6
	V2-10:2.6
	V2-00:2.6
	V1-51:2.4
	V1-50:2.4
	V1-45:2.4
	V1-44:2.4
	V1-43:2.4
	V1-32:2.4
	V1-31:2.4
	V1-30:2.4
	V1-13:2.4
	V1-12:2.4
	V1-11:2.4
	V1-10:2.4
	newfwm-feb03:2.4.0.2
	V1-04:2.2
	V1-03:2.2
	V1-02:2.2
	JointForwardModel:2.2.0.2
	V1-00:2.1
	newfwm-sep01:1.3.0.2
	V0-7:1.3
	V0-5-Level2:1.2
	V0-5-SIPS:1.2;
locks; strict;
comment	@# @;


2.7
date	2011.08.26.00.30.00;	author pwagner;	state dead;
branches;
next	2.6;

2.6
date	2005.10.24.20.13.11;	author vsnyder;	state Exp;
branches;
next	2.5;

2.5
date	2005.06.22.18.14.01;	author pwagner;	state Exp;
branches;
next	2.4;

2.4
date	2002.10.15.00.12.19;	author vsnyder;	state Exp;
branches;
next	2.3;

2.3
date	2002.10.02.15.50.23;	author bwknosp;	state Exp;
branches;
next	2.2;

2.2
date	2002.04.18.10.46.27;	author zvi;	state Exp;
branches;
next	2.1;

2.1
date	2002.03.21.23.35.36;	author zvi;	state Exp;
branches;
next	2.0;

2.0
date	2001.09.17.20.26.27;	author livesey;	state Exp;
branches;
next	1.3;

1.3
date	2001.06.07.23.39.32;	author pwagner;	state Exp;
branches;
next	1.2;

1.2
date	2001.01.31.01.08.48;	author zvi;	state Exp;
branches;
next	1.1;

1.1
date	2000.11.22.23.07.31;	author zvi;	state Exp;
branches;
next	;


desc
@@


2.7
log
@Moved to lib or combined with MLSNumerics module
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

! subroutine *Simps ( F, DX, N, R )

! $Id: simpson.f9h,v 2.6 2005/10/24 20:13:11 vsnyder Exp $
! $RCSfile: simpson.f9h,v $

    integer(i4), intent(in) :: N

    real(rk), intent(in) :: F(*)
    real(rk), intent(in) :: DX
    real(rk), intent(out) :: R

    real(rk) :: S

    real(rk), parameter :: K13 = 1.0_rk / 3.0_rk
    real(rk), parameter :: K38 = 3.0_rk / 8.0_rk
    real(rk), parameter :: KSN = k13 + k38   ! Bndry Simpson with Newton-Cotes

! See e.g. F. B. Hildebrand, "Introduction to Numerical Analysis," Second
! edition, Dover (1987), p. 93.

    select case ( N )
    case ( :0 )                              ! Nothing to do
      r = 0.0_rk
    case ( 1 )                               ! Midpoint rule
      r = f(1) * dx
    case ( 2 )                               ! Trapezoid rule
      r = 0.5_rk * dx * (f(1) + f(2))
    case ( 3 )                               ! Simpson's rule
      r = k13 * dx * ( f(1) + 4.0_rk * f(2) + f(3) )
    case ( 4 )                               ! Newton-Cotes 3/8 rule
      r = k38 * dx * ( f(1) + 3.0_rk * ( f(2) + f(3) ) + f(4) )
    case ( 5: )
      if ( mod(n,2) /= 0 ) then              ! Parabolic rule
        s = sum(f(3:n-2:2)) ! Assume s+s cheaper than 2*s
        r = k13 * dx * ( f(1) + f(n) + 4.0_rk * sum(f(2:n-1:2)) + s + s )
      else       ! Parabolic rule with Newton-Cotes 3/8 rule on first 4 points
        s = sum(f(6:n-2:2)) ! Assume s+s cheaper than 2*s
        r = dx * (                                             &                
          & k38 * ( f(1) + 3.0_rk * ( f(2) + f(3) ) ) +        & ! Newton-Cotes 
          & ksn * f(4)   +                                     & ! Both         
          & k13 * (4.0_rk * sum(f(5:n-1:2)) + s + s + f(n) ) )   ! Parabolic
      end if
    end select
    return
! end subroutine *Simps

! $Log: simpson.f9h,v $
! Revision 2.6  2005/10/24 20:13:11  vsnyder
! Added a comment about where to find quadrature formulae
!
! Revision 2.5  2005/06/22 18:14:01  pwagner
! Reworded Copyright statement, moved rcs id
!
! Revision 2.4  2002/10/15 00:12:19  vsnyder
! Use Newton-Cotes 3/8 instead of trapezoid for extra panel in even number
! of points (odd number of panels) case.  Copyright notice.  Channge CVS
! variables to CVS comments.  Cosmetic changes.
!
! Revision 2.3  2002/10/02 15:50:23  bwknosp
! Added Id and RCS info
!
! Revision 2.2  2002/04/18 10:46:27  zvi
! Fix a minor bug for N Odd
!
! Revision 2.1  2002/03/21 23:35:36  zvi
! Fixing minor bug & making it more efficient
!
! Revision 2.0  2001/09/17 20:26:27  livesey
! New forward model
!
! Revision 1.3  2001/06/07 23:39:32  pwagner
! Added Copyright statement
!
! Revision 1.2  2001/01/31 01:08:48  zvi
! New version of forward model
!
@


2.6
log
@Added a comment about where to find quadrature formulae
@
text
@d14 1
a14 1
! $Id: simpson.f9h,v 2.5 2005/06/22 18:14:01 pwagner Exp $
d59 3
@


2.5
log
@Reworded Copyright statement, moved rcs id
@
text
@d14 1
a14 1
! $Id: simpson.f9h,v 2.4 2002/10/15 00:12:19 vsnyder Exp $
d29 3
d59 3
@


2.4
log
@Use Newton-Cotes 3/8 instead of trapezoid for extra panel in even number
of points (odd number of panels) case.  Copyright notice.  Channge CVS
variables to CVS comments.  Cosmetic changes.
@
text
@d1 10
a10 2
! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
d14 2
a15 2
! $Id: $
! $RCSfile: $
d56 5
@


2.3
log
@Added Id and RCS info
@
text
@d4 1
a4 5
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: simpson.f9h,v 2.1 2002/04/18 10:46:24 zvi Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: simpson.f9h,v $"
!---------------------------------------------------------------------------
d6 2
d9 41
a50 30
    Integer(i4), intent(in) :: N
!
    Real(rk), intent(in) :: F(*)
    Real(rk), intent(in) :: DX
    Real(rk), intent(out) :: R
!
    Real(rk) :: S
    Integer  :: j, k
!
    R = 0.0_rk
    if ( N < 2 ) Return
    if ( N < 3 ) then
      R = 0.5_rk * (f(2) + f(1)) * dx
    else
      j = 1
      S = 0.0_rk
      do
        k = j + 2
        if ( k <= N ) then
          S = S + f(j) + 4.0_rk * f(j+1) + f(k)
          j = k
        else
          EXIT
        endif
      end do
      R = S * dx / 3.0_rk
      if ( j < N ) R = R + dx * (f(N-1) + f(N)) / 2.0_rk
    endif
    Return
! $Log: simpson.f9h,v $
@


2.2
log
@Fix a minor bug for N Odd
@
text
@d4 7
d42 3
@


2.1
log
@Fixing minor bug & making it more efficient
@
text
@d21 1
a21 1
      do while ( j < N )
d23 6
a28 2
        if ( k <= N ) S = S + f(j) + 4.0_rk * f(j+1) + f(k)
        j = k
d31 1
a31 1
      if ( j > N ) R = R + dx * (f(N-1) + f(N)) / 2.0_rk
d35 3
@


2.0
log
@New forward model
@
text
@d11 2
a12 9
    Integer, Parameter :: Np = 6
!
    Real(rk) :: H
    Real(rk) :: DUMI(2) = (/ 4.0_rk, 4.0_rk /)
    Real(rk) :: DUMO(2) = (/ 4.0_rk, 4.0_rk /)
!
    Integer :: J, K, Kp
!
    Real(rk) :: S, Vx(Np)
a20 1
      h = dx / 3.0_rk
d22 3
a24 2
        if ( j+2 < N ) S = S + f(j) + 4.0_rk * f(j+1) + f(j+2)
        j = j + 2
d26 2
a27 12
      R = h * S
      if ( j > N ) then
        Kp = min(Np,N)
        do k = 1, Kp
          Vx(k) = (k - 1) * dx
        end do
        k = N - Kp + 1
        dumi(1) = 0.5_rk * (Vx(Kp-1) + Vx(Kp))
        Call Cspline(Vx,dumi,f(k:n+1),dumo,Kp,1)
        S = f(N-1) + 4.0_rk * dumo(1) + f(N)
        R = R + 0.5_rk * h * S
      endif
d31 3
@


1.3
log
@Added Copyright statement
@
text
@d48 3
@


1.2
log
@New version of forward model
@
text
@d1 3
d47 4
a50 1
! $Log: SIMPSON.F9H,v $
@


1.1
log
@New version
@
text
@@

