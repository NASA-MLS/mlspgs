head	2.4;
access;
symbols
	V3-43:2.3
	V3-41:2.3
	V3-40-PlusGM57:2.3.0.2
	V2-24-NRT-04:2.3
	V3-33:2.3
	V2-24:2.3
	V3-31:2.3
	V3-30-NRT-05:2.3
	cfm-01-00:2.3
	V3-30:2.3
	V3-20:2.3
	V3-10:2.3
	V2-23-NRT-02:2.3
	V2-23:2.3
	V2-22-NRT-01:2.3
	V2-22:2.3
	V2-21:2.3
	V2-20:2.3
	V2-11:2.3
	V2-10:2.3
	V2-00:2.3
	V1-51:2.2
	V1-50:2.2
	V1-45:2.2
	V1-44:2.2
	V1-43:2.2
	V1-32:2.2
	V1-31:2.2
	V1-30:2.2
	V1-13:2.2
	V1-12:2.2
	V1-11:2.2
	V1-10:2.2
	newfwm-feb03:2.2.0.2
	V1-04:2.0
	V1-03:2.0
	V1-02:2.0
	JointForwardModel:2.0.0.2
	V1-00:2.0
	newfwm-sep01:1.5.0.2
	V0-7:1.5
	V0-5-Level2:1.4
	V0-5-SIPS:1.4
	V0_1:1.1;
locks; strict;
comment	@# @;


2.4
date	2011.08.26.17.57.24;	author pwagner;	state dead;
branches;
next	2.3;

2.3
date	2005.06.22.18.14.01;	author pwagner;	state Exp;
branches;
next	2.2;

2.2
date	2002.10.14.20.57.42;	author vsnyder;	state Exp;
branches;
next	2.1;

2.1
date	2002.10.02.15.49.53;	author bwknosp;	state Exp;
branches;
next	2.0;

2.0
date	2001.09.17.20.26.27;	author livesey;	state Exp;
branches;
next	1.5;

1.5
date	2001.06.07.23.39.31;	author pwagner;	state Exp;
branches;
next	1.4;

1.4
date	2001.01.31.01.08.48;	author zvi;	state Exp;
branches;
next	1.3;

1.3
date	2000.11.22.23.10.04;	author zvi;	state Exp;
branches;
next	1.2;

1.2
date	2000.11.22.23.07.28;	author zvi;	state dead;
branches;
next	1.1;

1.1
date	2000.05.05.00.04.02;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


2.4
log
@No longer used; removed
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

! $Id: lintrp.f9h,v 2.3 2005/06/22 18:14:01 pwagner Exp $
! $RCSfile: lintrp.f9h,v $

! subroutine ?_LINTRP ( XIN, XOUT, YIN, YOUT, NIN, NOUT )

!  Given arrays XIN & YIN of length NIN containing a tabulated function,
!  with XIN ordered, and given the (ordered) array: XOUT of length: NOUT,
!  this subroutine Returns the array: YOUT which is a linear interpolation
!  of (XIN,YIN) computed for each: XOUT.

    integer, intent(in) :: NIN, NOUT
    real(rk),intent(in)  :: XIN(nin), XOUT(nout), YIN(nin)
    real(rk),intent(out) :: YOUT(:)

    real(rk) :: DX, DELX, DYDX, X, Y
    integer :: I, KHI, KLO
    real(rk), parameter :: TINY = epsilon(dx)

    if ( nin < 2 ) then
      yout(1:nout) = yin(1)
      return
    end if

    if ( all(yin(2:) == yin(1)) ) then
      yout(1:nout) = yin(1)
      return
    end if

    klo = -1
    do i = 1, nout
      x = xout(i)
      call hunt ( x, xin, nin, klo, khi )
      delx = x - xin(klo)
      if ( abs(delx) < tiny ) then
        y = yin(klo)
      else if ( abs(x-xin(khi)) < tiny ) then
        y = yin(khi)
      else
        dx = xin(khi) - xin(klo)
        if ( abs(dx) < tiny ) then
          y = yin(klo)
        else
          dydx = (yin(khi)-yin(klo)) / dx
          y = yin(klo) + dydx * delx
        end if
      end if
      yout(i) = y
    end do

    return

! end subroutine ?_LINTRP

! $Log: lintrp.f9h,v $
! Revision 2.3  2005/06/22 18:14:01  pwagner
! Reworded Copyright statement, moved rcs id
!
! Revision 2.2  2002/10/14 20:57:42  vsnyder
! Replace CVS variables with comments, cosmetic changes
!
! Revision 2.1  2002/10/02 15:49:53  bwknosp
! Added Id and RCS info
!
@


2.3
log
@Reworded Copyright statement, moved rcs id
@
text
@d12 1
a12 1
! $Id: lintrp.f9h,v 2.2 2002/10/14 20:57:42 vsnyder Exp $
d66 3
@


2.2
log
@Replace CVS variables with comments, cosmetic changes
@
text
@d1 10
a10 2
! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.
d12 2
a13 2
! $Id: $
! $RCSfile: $
d66 3
@


2.1
log
@Added Id and RCS info
@
text
@d4 2
a5 5
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: lintrp.f9h,v 2.1 2002/04/18 10:46:24 zvi Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: lintrp.f9h,v $"
!---------------------------------------------------------------------------
d7 1
d9 1
a9 3
! subroutine ?_LINTRP ( XIN, XOUT, YIN, YOUT, NIN, NOUT )
!
!  Given arrays XIN & YIN of lenght NIN containing a tabulated function,
d13 1
a13 1
!
d17 1
a17 1
!
d21 2
a22 2
!
    if (nin < 2) then
d26 1
a26 1
!
d31 1
a31 1
!
d33 1
a33 1
    do i = 1, Nout
d35 1
a35 1
      Call hunt(x, xin, nin, klo, khi)
d37 1
a37 1
      if(abs(delx).lt.tiny) then
d39 1
a39 1
      else if(abs(x-xin(khi)).lt.tiny) then
d43 1
a43 1
        if(abs(dx).lt.tiny) then
d48 2
a49 2
        endif
      endif
d52 3
a54 3
!
    Return
!
d58 3
@


2.0
log
@New forward model
@
text
@d4 7
d60 2
@


1.5
log
@Added Copyright statement
@
text
@@


1.4
log
@New version of forward model
@
text
@d1 3
@


1.3
log
@Re-add basic stuff
@
text
@d26 1
@


1.2
log
@New version
@
text
@d12 2
a13 2
    real(rk) :: DX, DY, DYDX
    integer :: I, J, KHI, KLO, PKLO
a14 1
    real(rk) :: X
d26 1
a26 3
    pklo = -1

    do i = 1, nout
d28 10
a37 4
      call hunt ( x, xin, nin, klo, khi )
      if (klo == khi) then
        if (klo < nin) then
          khi = klo + 1
d39 5
a43 11
          klo = khi - 1
        end if
      end if
      if (klo /= pklo) then
        pklo = klo
        dx = xin(khi) - xin(klo)
        dy = yin(khi) - yin(klo)
        if (abs(dx) < tiny*abs(dy)) goto 20
        dydx = dy / dx
      end if
      yout(i) = yin(klo) + dydx * (x - xin(klo))
d46 1
a46 10
    return
!
20  print *, '** Error IN ZLINTRP subroutine !!'
    print *, '   Bad XIN array !!'
    print *, '   KLO=',klo,' KHI=',khi
    print *, '   XIN(KLO)=',xin(klo)
    print *, '   XIN(KHI)=',xin(khi)
    print *, '   XIN ='
    print *, (xin(j),j=1,nin)
    stop
@


1.1
log
@Initial conversion to Fortran 90
@
text
@@

