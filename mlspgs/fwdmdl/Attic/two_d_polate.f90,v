head	1.6;
access;
symbols
	newfwm-sep01:1.5.0.2
	V0-7:1.5
	V0-5-Level2:1.4
	V0-5-SIPS:1.4
	V0_1:1.1;
locks; strict;
comment	@# @;


1.6
date	2001.09.17.20.26.28;	author livesey;	state dead;
branches;
next	1.5;

1.5
date	2001.06.07.23.39.32;	author pwagner;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2001.01.31.01.08.48;	author zvi;	state Exp;
branches;
next	1.3;

1.3
date	2000.11.22.23.10.05;	author zvi;	state Exp;
branches;
next	1.2;

1.2
date	2000.11.22.23.07.32;	author zvi;	state dead;
branches;
next	1.1;

1.1
date	2000.05.04.18.12.06;	author vsnyder;	state Exp;
branches;
next	;

1.5.2.1
date	2001.09.10.10.01.09;	author zvi;	state dead;
branches;
next	;


desc
@@


1.6
log
@New forward model
@
text
@! Copyright (c) 1999, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.

module TWO_D_POLATE_M
  use MLSCommon, only: I4, R8
  use D_GET_ONE_ETA_M, only: GET_ONE_ETA
  implicit NONE
  private
  public :: TWO_D_POLATE
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: two_d_polate.f90,v 1.5 2001/06/07 23:39:32 pwagner Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: two_d_polate.f90,v $"
!---------------------------------------------------------------------------
contains
!  Interpolating in 2 dimensions - Zeta & Phi
!
  Subroutine TWO_D_POLATE (f_basis, f_profile, no_coeffs, phi_basis, &
 &                         no_phi, zeta, phi, V )
!
    integer(i4), intent(in) :: NO_COEFFS, NO_PHI
!
    Real(r8), intent(in) :: F_BASIS(:), PHI_BASIS(:), F_PROFILE(:,:)
    Real(r8), intent(in) :: ZETA, PHI
!
    Real(r8), intent(out) :: V
!
! -----     Local variables     ----------------------------------------
!
    integer :: J, K
    Real(r8) :: ETAP, ETAZ
!
! -----     Executable statements     ----------------------------------
!
    V = 0.0_r8
    do k = 1, no_coeffs
      Call get_one_eta(zeta,f_basis,no_coeffs,k,etaz)
      if (etaz == 0.0) CYCLE
      do j = 1, no_phi
        Call get_one_eta(phi,phi_basis,no_phi,j,etap)
        if (etap /= 0.0) V = V + f_profile(k,j) * etaz * etap
      end do
    end do
!
    Return
  End Subroutine TWO_D_POLATE
end module TWO_D_POLATE_M
! $Log: two_d_polate.f90,v $
! Revision 1.5  2001/06/07 23:39:32  pwagner
! Added Copyright statement
!
! Revision 1.4  2001/01/31 01:08:48  zvi
! New version of forward model
!
! Revision 1.1  2000/06/21 21:56:18  zvi
! First version D.P.
!
! Revision 1.1  2000/05/04 18:12:06  vsnyder
! Initial conversion to Fortran 90
@


1.5
log
@Added Copyright statement
@
text
@d12 1
a12 1
       "$Id: two_d_polate.f90,v 1.4 2001/01/31 01:08:48 zvi Exp $"
d49 3
@


1.5.2.1
log
@*** empty log message ***
@
text
@d12 1
a12 1
       "$Id: two_d_polate.f90,v 1.5 2001/06/07 23:39:32 pwagner Exp $"
a48 3
! Revision 1.5  2001/06/07 23:39:32  pwagner
! Added Copyright statement
!
@


1.4
log
@New version of forward model
@
text
@d1 3
d12 1
a12 1
       "$Id: two_d_polate.f90,v 1.1 2000/06/21 21:56:18 zvi Exp $"
d49 3
@


1.3
log
@Re-add basic stuff
@
text
@@


1.2
log
@New version
@
text
@d2 2
a3 2
  use MLSCommon, only: I4, R4
  use S_GET_ONE_ETA_M, only: GET_ONE_ETA
a6 1

d9 1
a9 1
       "$Id: two_d_polate.f90,v 1.1 2000/05/04 18:12:06 vsnyder Exp $"
a11 1

d15 9
a23 2
  Subroutine TWO_D_POLATE ( f_basis, f_profile, Nc, no_coeffs, phi_basis, &
 &                          no_phi, z, phi, V )
a24 9
    Real(r4), intent(in) :: F_BASIS(*)
    integer(i4), intent(in) :: NC
    Real(r4), intent(in) :: F_PROFILE(Nc,*)
    integer(i4), intent(in) :: NO_COEFFS
    Real(r4), intent(in) :: PHI_BASIS(*)
    integer(i4), intent(in) :: NO_PHI
    Real(r4), intent(in) :: Z
    Real(r4), intent(in) :: PHI
    Real(r4), intent(out) :: V
d26 1
d28 2
a29 1
    Real(r4) :: ETAP, ETAZ
d31 2
a32 1
    V = 0.0
d34 6
a39 7
      Call get_one_eta(z,f_basis,no_coeffs,k,etaz)
      if (etaz > 0.0) then
        do j = 1, no_phi
          Call get_one_eta(phi,phi_basis,no_phi,j,etap)
          V = V + f_profile(k,j) * etaz * etap
        end do
      end if
a44 1

d46 3
a50 1
!
@


1.1
log
@Initial conversion to Fortran 90
@
text
@d10 2
a11 2
       "$Id: TWO_D_POLATE_M,v 1.12 2000/02/08 19:54:57 vsnyder Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: two_d_polate_m.f90,v $"
d48 4
a51 1
! $Log: TWO_D_POLATE_M,v $
@

