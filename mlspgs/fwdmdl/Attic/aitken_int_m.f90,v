head	1.2;
access;
symbols
	V0_1:1.1;
locks; strict;
comment	@# @;


1.2
date	2000.11.22.23.07.23;	author zvi;	state dead;
branches;
next	1.1;

1.1
date	2000.05.04.18.12.04;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


1.2
log
@New version
@
text
@module Aitken_Int_M
  use D_CSPLINE_M, only: CSPLINE
  use DAITKEN_MODULE, only: AITKEN
  use DSIMPSON_MODULE, only: SIMPS
  use MLSCommon, only: I4, R4, R8
  implicit NONE
  private
  public :: Aitken_int

!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: aitken_int_m.f90,v 1.1 2000/05/04 18:12:04 vsnyder Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: aitken_int_m.f90,v $"
!---------------------------------------------------------------------------

contains
  Function Aitken_int (F_GRID, F_GRID_FLTR, FLTR_FUNC, RAD, JP, NFP, IER)
    real(r8) :: Aitken_int
    real(r8), intent(in) :: F_GRID(*)
    real(r8) :: F_GRID_FLTR(*)
    real(r8), intent(in) :: FLTR_FUNC(nfp)
    real(r4), intent(in) :: RAD(*)
    integer(i4), intent(in) :: JP
    integer(i4), intent(in) :: NFP
    integer(i4), intent(out) :: IER

    Integer(i4) :: N, KZ, JUMP

    Integer(i4), Parameter :: M = 161       ! For 161 maxfiltpts

    Real(r8) :: A(3)
    Real(r8) :: RXF(nfp), TMPARY(nfp), TMPF(m), DF

    ier = 2000
    if ( nfp > m ) then
      Print *, '** Error in subroutine Aitken_Int !'
      Print *, '   Number of filter points too large:', nfp
      Print *, '   Maximum allowed:', m
      Return
    endif

    ier = 0
    jump = 1
    df = f_grid_fltr(2) - f_grid_fltr(1)

    do kz = 1, 3
      n = jp/jump
      tmpf(1:n) = f_grid(1:jp:jump)
      rxf(1:n) = rad(1:jp:jump)
      Call Cspline ( tmpf, f_grid_fltr, rxf, tmpary, n, nfp )
      rxf = tmpary * fltr_func
      Call Simps ( rxf, df, nfp, a(kz) )
      jump = 2 * jump
    end do

    Aitken_int = Aitken(a(3),a(2),a(1))

    Return
  End Function Aitken_int
end module Aitken_Int_M

! $Log: aitken_int_m.f90,v $
! Revision 1.1  2000/05/04 18:12:04  vsnyder
! Initial conversion to Fortran 90
!
@


1.1
log
@Initial conversion to Fortran 90
@
text
@d12 1
a12 1
       "$Id: Aitken_Int_M,v 1.12 2000/02/08 19:54:57 vsnyder Exp $"
d62 4
a65 1
! $Log: Aitken_Int_M,v $
@

