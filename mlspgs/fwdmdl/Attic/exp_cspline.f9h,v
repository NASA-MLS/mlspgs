head	1.3;
access;
symbols;
locks; strict;
comment	@# @;


1.3
date	2001.03.05.23.22.55;	author zvi;	state dead;
branches;
next	1.2;

1.2
date	2001.01.31.01.08.48;	author zvi;	state Exp;
branches;
next	1.1;

1.1
date	2000.11.22.23.07.26;	author zvi;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Removing 'orphan' files ..
@
text
@!
!---------------------------------------------------------------------
!
!     SUBROUTINE ?_EXP_CSPLINE(XIN,XOUT,YIN,YOUT,NIN,NOUT)
!
      INTEGER, INTENT(IN) :: NIN,NOUT
      REAL(rk), INTENT(IN)  :: XIN(:),XOUT(:),YIN(:)
      REAL(rk), INTENT(OUT)  :: YOUT(:)
!
      REAL(rk), ALLOCATABLE, DIMENSION(:) :: YT,YY

      INTEGER :: I
      REAL(rk) :: Y,S,P,PS
!
      S = YIN(1)
      DO I = 2, NIN
        PS = S
        S = YIN(I)
        P = S * PS
        IF(P <= 0.0) THEN
          PRINT *,'** Error in ?_EXP_CSPLINE Routine **'
          PRINT *,'   Non-exponential input, zero or changes sign ..'
          PRINT *,'   Resorting to regular cubic spline ..'
          CALL CSPLINE(XIN,XOUT,YIN,YOUT,NIN,NOUT)
          RETURN
        ENDIF
      END DO
!
      ALLOCATE(YT(1:NIN),YY(1:NOUT),STAT=I)
      IF(I /= 0) THEN
        PRINT *,'** Error in ?_EXP_CSPLINE  Subroutine !!'
        PRINT *,'   Could not allocate arrays ..'
        print *,'   Resorting to regular cubic spline ..'
        CALL CSPLINE(XIN,XOUT,YIN,YOUT,NIN,NOUT)
        RETURN
      ENDIF
!
      S = SIGN(1.0D0,PS)
      YT(1:NIN) = LOG(S*YIN(1:NIN))

      CALL CSPLINE(XIN,XOUT,YT,YY,NIN,NOUT)
!
      DO I = 1, NOUT
        Y = YY(I)
        IF(ABS(Y) < 85.0) THEN
          P = EXP(Y)
        ELSE IF(Y < 0.0) THEN
          P = 0.0D0
        ELSE
          P = 1.0D38
        ENDIF
        YOUT(I) = S * P
      END DO

      DEALLOCATE(YT,YY,STAT=I)
!
!     END SUBROUTINE ?_EXP_CSPLINE
@


1.2
log
@New version of forward model
@
text
@@


1.1
log
@New version
@
text
@d39 1
a39 1
      YT(1:NIN) = DLOG(S*YIN(1:NIN))
@

