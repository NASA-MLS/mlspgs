head	1.6;
access;
symbols
	newfwm-sep01:1.5.0.2
	V0-7:1.5
	V0-5-Level2:1.5
	V0-5-SIPS:1.5
	V0_1:1.1;
locks; strict;
comment	@# @;


1.6
date	2001.09.17.20.26.26;	author livesey;	state dead;
branches;
next	1.5;

1.5
date	2001.03.30.20.28.21;	author zvi;	state Exp;
branches
	1.5.2.1;
next	1.4;

1.4
date	2001.01.31.01.08.48;	author zvi;	state Exp;
branches;
next	1.3;

1.3
date	2000.11.22.23.10.03;	author zvi;	state Exp;
branches;
next	1.2;

1.2
date	2000.11.22.23.07.25;	author zvi;	state dead;
branches;
next	1.1;

1.1
date	2000.05.04.18.12.05;	author vsnyder;	state Exp;
branches;
next	;

1.5.2.1
date	2001.09.10.10.00.20;	author zvi;	state dead;
branches;
next	;


desc
@@


1.6
log
@New forward model
@
text
@module EARTH_INTERSECTION_M
  use MLSCommon, only: R8
  use ELLIPSE_M, only: ELLIPSE
  implicit NONE
  private
  public :: Earth_Intersection
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: earth_intersection_m.f90,v 1.5 2001/03/30 20:28:21 zvi Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= &
       "$RCSfile: earth_intersection_m.f90,v $"
!---------------------------------------------------------------------------
contains
! This routine solves for the Phi_s and Rs for Earth intersection case.
!  ** Note: This routine is using The Equivalent Circle concept
!
  Subroutine Earth_Intersection (elvar,Rs)

    Type(ELLIPSE), intent(IN OUT) :: elvar
    real(r8), intent(out) :: RS
!
    real(r8) :: r,V
!
    elvar%EarthX = .true.            ! Set Earth Intersecting Ray flag
    v = (elvar%ht + elvar%RoC)/elvar%RoC
    elvar%Phi_s = elvar%Phi_tan - Acos(v)
    elvar%sps = Sin(elvar%Phi_s)
    elvar%cps = Cos(elvar%Phi_s)
    r = elvar%a2*elvar%cps*elvar%cps + elvar%c2*elvar%sps*elvar%sps
    elvar%NPhi_s = elvar%a2 / Sqrt(r)
    v = 2.0_r8 * elvar%Phi_s - elvar%Phi_tan
    elvar%spts = Sin(v)
    elvar%cpts = Cos(v)
!
    v = elvar%c2oa2 * elvar%sps
    Rs = elvar%NPhi_s * Sqrt(elvar%cps*elvar%cps + v*v)
!
    Return
  End Subroutine Earth_Intersection
end module EARTH_INTERSECTION_M
! $Log: earth_intersection_m.f90,v $
! Revision 1.5  2001/03/30 20:28:21  zvi
! General fix-up to get rid of COMMON BLOCK (ELLIPSE)
!
! Revision 1.4  2001/01/31 01:08:48  zvi
! New version of forward model
!
! Revision 1.1  2000/05/04 18:12:05  vsnyder
! Initial conversion to Fortran 90
!
@


1.5
log
@General fix-up to get rid of COMMON BLOCK (ELLIPSE)
@
text
@d9 1
a9 1
       "$Id: earth_intersection_m.f90,v 1.4 2001/01/31 01:08:48 zvi Exp $"
d42 3
@


1.5.2.1
log
@*** empty log message ***
@
text
@d9 1
a9 1
       "$Id: earth_intersection_m.f90,v 1.5 2001/03/30 20:28:21 zvi Exp $"
a41 3
! Revision 1.5  2001/03/30 20:28:21  zvi
! General fix-up to get rid of COMMON BLOCK (ELLIPSE)
!
@


1.4
log
@New version of forward model
@
text
@a1 2
  use ELLIPSE, only: A2, CPS, CPTS, C2, C2OA2, EARTHX, HT, NPHI_S, &
                     PHI_S, PHI_TAN, ROC, SPS, SPTS
d3 1
d9 1
a9 1
       "$Id: earth_intersection_m.f90,v 1.1 2000/05/04 18:12:05 vsnyder Exp $"
d17 3
a19 1
  Subroutine Earth_Intersection ( Rs )
d22 1
a22 2
    real(r8) :: V
    EarthX = .true.            ! Set Earth Intersecting Ray flag
d24 10
a33 7
    Phi_s = Phi_tan - Acos( (ht+RoC)/RoC )
    sps = Sin(Phi_s)
    cps = Cos(Phi_s)
    NPhi_s = a2 / Sqrt(a2*cps*cps + c2*sps*sps)
    v = 2.0_r8 * Phi_s - Phi_tan
    spts = Sin(v)
    cpts = Cos(v)
d35 2
a36 2
    v = c2oa2 * sps
    Rs = NPhi_s * Sqrt(cps*cps + v*v)
d42 3
@


1.3
log
@Re-add basic stuff
@
text
@@


1.2
log
@New version
@
text
@a7 1

a13 1

a21 1

a37 1

@


1.1
log
@Initial conversion to Fortran 90
@
text
@d11 1
a11 1
       "$Id: EARTH_INTERSECTION_M,v 1.12 2000/02/08 19:54:57 vsnyder Exp $"
d42 4
a45 1
! $Log: EARTH_INTERSECTION_M,v $
@

