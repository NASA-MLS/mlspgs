head	1.12;
access;
symbols
	v5-02-NRT-19:1.12
	v6-00:1.12
	v5-02-NRT-18:1.12
	v5-02:1.12
	v5-01-NRT-17:1.12
	v5-01-NRT-16:1.12
	v5-01-NRT-15:1.12
	v5-01-NRT-14:1.12
	neuralnetworks-1-0:1.12.0.12
	cfm-single-freq-0-1:1.12.0.10
	v5-01:1.12
	v5-00:1.12
	v4-23-TA133:1.12.0.8
	mus-emls-1-70:1.12.0.6
	rel-1-0-englocks-work:1.12.0.4
	VUMLS1-00:1.12
	VPL1-00:1.12
	V4-22-NRT-08:1.12
	VAM1-00:1.12
	V4-21:1.12.0.2
	V4-13:1.12
	V4-12:1.12
	V4-11:1.12
	V4-10:1.12
	V3-43:1.11
	M4-00:1.12
	V3-41:1.11
	V3-40-PlusGM57:1.11.0.2
	V2-24-NRT-04:1.11
	V3-33:1.12
	V2-24:1.11
	V3-31:1.12
	V3-30-NRT-05:1.12
	cfm-01-00:1.11
	V3-30:1.11
	V3-20:1.11
	V3-10:1.11
	V2-23-NRT-02:1.11
	V2-23:1.11
	V2-22-NRT-01:1.11
	V2-22:1.11
	V2-21:1.11
	V2-20:1.11
	V2-11:1.11
	V2-10:1.11
	V2-00:1.10
	V1-51:1.10
	V1-50:1.10
	V1-45:1.10
	V1-44:1.10
	V1-43:1.10
	V1-32:1.10
	V1-31:1.10
	V1-30:1.7
	V1-13:1.4
	V1-12:1.4
	V1-11:1.4
	V1-10:1.4
	newfwm-feb03:1.4.0.2
	V1-04:1.1
	V1-03:1.1
	V1-02:1.1;
locks; strict;
comment	@# @;


1.12
date	2010.07.22.18.55.08;	author pwagner;	state Exp;
branches;
next	1.11;

1.11
date	2006.07.27.22.39.42;	author pwagner;	state Exp;
branches;
next	1.10;

1.10
date	2003.11.06.23.26.33;	author livesey;	state Exp;
branches;
next	1.9;

1.9
date	2003.10.15.22.59.42;	author livesey;	state Exp;
branches;
next	1.8;

1.8
date	2003.10.15.13.34.44;	author mjf;	state Exp;
branches;
next	1.7;

1.7
date	2003.05.10.22.22.17;	author livesey;	state Exp;
branches;
next	1.6;

1.6
date	2003.05.08.20.51.06;	author livesey;	state Exp;
branches;
next	1.5;

1.5
date	2003.03.22.01.18.08;	author livesey;	state Exp;
branches;
next	1.4;

1.4
date	2002.12.16.16.01.50;	author mjf;	state Exp;
branches;
next	1.3;

1.3
date	2002.11.22.12.43.24;	author mjf;	state Exp;
branches;
next	1.2;

1.2
date	2002.11.20.19.50.24;	author mjf;	state Exp;
branches;
next	1.1;

1.1
date	2002.04.29.21.54.58;	author pwagner;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Replaced method=special fills with unique names
@
text
@!ifdef(flagCopyStandardProducts,{},
{
; ------------------------------------------------- Fill, column abundances -----

;; This set of macros fills the columns for the current contents of the
;; state vector.
;;
;; We would need to augment and modify it account for
;; (1) Possibly using GEOS5 eta-level files to construct another PTrop
;; (2) Filling H2O using the _hr quantity
;; (3) Mandating unit=DU for O3
;;
;; However we won't trouble to do this because
;; (1) We're in an awful hurry
;; (2) Nearly every l2cf will be built with flagCopyStandardProducts
;;
;; To see how how to implement the changes here, see retrievalmacros.l2cf
begin Fill

  ;; --------------------------------------------- tpPressure
  !ifdef(tpPressure,{
    Fill, quantity=state.tpPressure, method=explicit, $
      explicitValues=!tpPressure, /spread
    !define(TropoName, {wmo tropopause})},{
  Fill, quantity=state.tpPressure, method=wmoTropopause, $
    temperatureQuantity=state.temperature, refGPHQuantity=state.refGPH, $
    internalVgrid=vGridWMO
  })

  ;; --------------------------------------------- Now the columns

  !define(fillOneColumn,{!dnl
  Fill, quantity=state.column_$1, method=columnAbundance, vmrQuantity=state.$1, $
    boundaryPressure=state.tpPressure
  Fill, quantity=outputPrecision.column_$1, method=columnAbundance, vmrQuantity=outputPrecision.$1, $
    boundaryPressure=state.tpPressure!nl})

  !forall(fillOneColumn,!allStandardProductsWithColumns)

end Fill
})
@


1.11
log
@Dont fill columns again if copying standard products from DGG file
@
text
@d33 1
a33 1
  Fill, quantity=state.column_$1, method=special, vmrQuantity=state.$1, $
d35 1
a35 1
  Fill, quantity=outputPrecision.column_$1, method=special, vmrQuantity=outputPrecision.$1, $
@


1.10
log
@Bug fix
@
text
@d1 2
d7 11
d41 1
@


1.9
log
@Bug fix
@
text
@d11 1
a11 1
    !define(TropoName, {wmo tropopause})}{
@


1.8
log
@state.tpPressure can be set explicitly.
@
text
@d15 1
a15 1
  }
@


1.7
log
@New approach to standard products, joining, output, columns etc.
@
text
@d8 4
d15 1
@


1.6
log
@Tidy up
@
text
@d3 2
d7 7
d20 1
a20 1
  !forall(fillOneColumn,BrO,CH3CN,CO,H2O,HCl,HCN,HNO3,HO2,HOCl,N2O,O3,OH,SO2)
@


1.5
log
@Changed tropopause name
@
text
@a0 12
; ------------------------------------------------- Fill, tropopause -----

begin Fill

   ;; Fill the tropopause
  !ifdef(tpPressure,{},{!define(tpPressure,100mb)})
    Fill, quantity=state.tpPressure, method=explicit, $
      explicitValues=!tpPressure, /spread
  !define(TropoName, !tpPressure)

end Fill

d5 5
a9 22
  !define(columnFill,{
   Fill, quantity=$2.column_$1, method=special, vmrQuantity=$2.$1, $
      boundaryPressure=$3!dnl
})!dnl
  !columnFill(bro,state,state.tpPressure)
  !columnFill(ch3cn,state,state.tpPressure)
  !columnFill(clo,state,state.tpPressure)
  !columnFill(co,state,state.tpPressure)
  !columnFill(h2o,state,state.tpPressure)
  !ifdef(skipHiRes,{},{!columnFill(h2o_HR,state,state.tpPressure)})
  !columnFill(hcl,state,state.tpPressure)
  !columnFill(hcn,state,state.tpPressure)
  !columnFill(hno3,state,state.tpPressure)
  !columnFill(ho2,state,state.tpPressure)
  !columnFill(hocl,state,state.tpPressure)
  !columnFill(n2,state,state.tpPressure)
  !columnFill(n2o,state,state.tpPressure)
  !columnFill(o2,state,state.tpPressure)
  !columnFill(o3,state,state.tpPressure)
  !ifdef(skipHiRes,{},{!columnFill(o3_HR,state,state.tpPressure)})
  !columnFill(oh,state,state.tpPressure)
  !columnFill(so2,state,state.tpPressure)
d11 1
a11 18
  !columnFill(bro,outputPrecision,state.tpPressure)
  !columnFill(ch3cn,outputPrecision,state.tpPressure)
  !columnFill(clo,outputPrecision,state.tpPressure)
  !columnFill(co,outputPrecision,state.tpPressure)
  !columnFill(h2o,outputPrecision,state.tpPressure)
  !ifdef(skipHiRes,{},{!columnFill(h2o_HR,outputPrecision,state.tpPressure)})
  !columnFill(hcl,outputPrecision,state.tpPressure)
  !columnFill(hcn,outputPrecision,state.tpPressure)
  !columnFill(hno3,outputPrecision,state.tpPressure)
  !columnFill(ho2,outputPrecision,state.tpPressure)
  !columnFill(hocl,outputPrecision,state.tpPressure)
  !columnFill(n2,outputPrecision,state.tpPressure)
  !columnFill(n2o,outputPrecision,state.tpPressure)
  !columnFill(o2,outputPrecision,state.tpPressure)
  !columnFill(o3,outputPrecision,state.tpPressure)
  !ifdef(skipHiRes,{},{!columnFill(o3_HR,outputPrecision,state.tpPressure)})
  !columnFill(oh,outputPrecision,state.tpPressure)
  !columnFill(so2,outputPrecision,state.tpPressure)
@


1.4
log
@Slightly different definition of columnFill.
@
text
@d9 1
a9 1
  !define(TropoName, {wmo tropopause})
@


1.3
log
@Added hiRes columns.
@
text
@d18 2
a19 2
   Fill, quantity=state.column_$1, method=special, vmrQuantity=$2.$1, $
      boundaryPressure=state.$3!dnl
d21 37
a57 18
  !columnFill(bro,state,tpPressure)
  !columnFill(ch3cn,state,tpPressure)
  !columnFill(clo,state,tpPressure)
  !columnFill(co,state,tpPressure)
  !columnFill(h2o,state,tpPressure)
  !ifdef(skipHiRes,{},!columnFill(h2o_HR,state,tpPressure))
  !columnFill(hcl,state,tpPressure)
  !columnFill(hcn,state,tpPressure)
  !columnFill(hno3,state,tpPressure)
  !columnFill(ho2,state,tpPressure)
  !columnFill(hocl,state,tpPressure)
  !columnFill(n2,state,tpPressure)
  !columnFill(n2o,state,tpPressure)
  !columnFill(o2,state,tpPressure)
  !columnFill(o3,state,tpPressure)
  !ifdef(skipHiRes,{},!columnFill(o3_HR,state,tpPressure))
  !columnFill(oh,state,tpPressure)
  !columnFill(so2,state,tpPressure)
@


1.2
log
@Allow PE l2cf to initialise tpPressure.  aColumn changed to state.
@
text
@d26 1
d36 1
@


1.1
log
@First commit
@
text
@d6 4
a9 3
   Fill, quantity=aColumn.tpPressure, method=explicit, $
    explicitValues=100mb, /spread
 !define(TropoName, {wmo tropopause})
d18 2
a19 2
   Fill, quantity=aColumn.column_$1, method=special, vmrQuantity=$2.$1, $
      boundaryPressure=aColumn.$3!dnl
@

