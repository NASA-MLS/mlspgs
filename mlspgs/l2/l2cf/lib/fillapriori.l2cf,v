head	1.168;
access;
symbols
	v5-02-NRT-19:1.168
	v6-00:1.168
	v5-02-NRT-18:1.167
	v5-02:1.165
	v5-01-NRT-17:1.167
	v5-01-NRT-16:1.167
	v5-01-NRT-15:1.167
	v5-01-NRT-14:1.167
	neuralnetworks-1-0:1.167.0.4
	cfm-single-freq-0-1:1.167.0.2
	v5-01:1.165
	v5-00:1.165
	v4-23-TA133:1.165.0.6
	mus-emls-1-70:1.165.0.4
	rel-1-0-englocks-work:1.165.0.2
	VUMLS1-00:1.164
	VPL1-00:1.164
	V4-22-NRT-08:1.164
	VAM1-00:1.163
	V4-21:1.159.0.2
	V4-13:1.159
	V4-12:1.159
	V4-11:1.159
	V4-10:1.158
	V3-43:1.143
	M4-00:1.153
	V3-41:1.143
	V3-40-PlusGM57:1.143.0.2
	V2-24-NRT-04:1.129
	V3-33:1.143
	V2-24:1.129
	V3-31:1.143
	V3-30-NRT-05:1.143
	cfm-01-00:1.143
	V3-30:1.143
	V3-20:1.143
	V3-10:1.141
	V2-23-NRT-02:1.129
	V2-23:1.129
	V2-22-NRT-01:1.129
	V2-22:1.129
	V2-21:1.129
	V2-20:1.129
	V2-11:1.121
	V2-10:1.121
	V2-00:1.110
	V1-51:1.93
	V1-50:1.93
	V1-45:1.91
	V1-44:1.91
	V1-43:1.85
	V1-32:1.72
	V1-31:1.72
	V1-30:1.63
	V1-13:1.40
	V1-12:1.40
	V1-11:1.40
	V1-10:1.35
	newfwm-feb03:1.35.0.2
	V1-04:1.1
	V1-03:1.1
	V1-02:1.1;
locks; strict;
comment	@# @;


1.168
date	2024.02.20.21.10.28;	author pwagner;	state Exp;
branches;
next	1.167;

1.167
date	2019.11.08.18.18.25;	author pwagner;	state Exp;
branches;
next	1.166;

1.166
date	2019.10.31.18.03.34;	author pwagner;	state Exp;
branches;
next	1.165;

1.165
date	2017.12.15.18.27.25;	author mmadatya;	state Exp;
branches;
next	1.164;

1.164
date	2016.01.05.00.42.25;	author pwagner;	state Exp;
branches;
next	1.163;

1.163
date	2015.05.19.22.43.16;	author pwagner;	state Exp;
branches;
next	1.162;

1.162
date	2015.04.30.17.30.03;	author pwagner;	state Exp;
branches;
next	1.161;

1.161
date	2015.04.29.18.20.45;	author pwagner;	state Exp;
branches;
next	1.160;

1.160
date	2015.03.27.18.00.52;	author pwagner;	state Exp;
branches;
next	1.159;

1.159
date	2014.06.03.22.17.10;	author pwagner;	state Exp;
branches;
next	1.158;

1.158
date	2014.02.19.19.22.38;	author pwagner;	state Exp;
branches;
next	1.157;

1.157
date	2013.11.20.00.54.40;	author pwagner;	state Exp;
branches;
next	1.156;

1.156
date	2013.10.29.18.18.27;	author pwagner;	state Exp;
branches;
next	1.155;

1.155
date	2013.10.15.17.43.23;	author pwagner;	state Exp;
branches;
next	1.154;

1.154
date	2013.05.28.20.35.58;	author pwagner;	state Exp;
branches;
next	1.153;

1.153
date	2013.04.11.16.35.34;	author pwagner;	state Exp;
branches;
next	1.152;

1.152
date	2013.03.13.19.36.47;	author pwagner;	state Exp;
branches;
next	1.151;

1.151
date	2012.10.09.00.32.43;	author pwagner;	state Exp;
branches;
next	1.150;

1.150
date	2012.05.15.22.36.04;	author pwagner;	state Exp;
branches;
next	1.149;

1.149
date	2012.05.02.16.48.18;	author pwagner;	state Exp;
branches;
next	1.148;

1.148
date	2012.04.13.21.56.14;	author wgread;	state Exp;
branches;
next	1.147;

1.147
date	2012.03.07.18.24.50;	author pwagner;	state Exp;
branches;
next	1.146;

1.146
date	2012.02.24.18.36.20;	author wgread;	state Exp;
branches;
next	1.145;

1.145
date	2012.02.22.23.54.51;	author wgread;	state Exp;
branches;
next	1.144;

1.144
date	2012.02.22.00.08.49;	author wgread;	state Exp;
branches;
next	1.143;

1.143
date	2010.03.31.18.18.52;	author pwagner;	state Exp;
branches;
next	1.142;

1.142
date	2010.02.10.00.46.54;	author pwagner;	state Exp;
branches;
next	1.141;

1.141
date	2009.07.28.20.08.17;	author pwagner;	state Exp;
branches;
next	1.140;

1.140
date	2009.06.23.17.33.43;	author pwagner;	state Exp;
branches;
next	1.139;

1.139
date	2009.05.06.00.12.23;	author pwagner;	state Exp;
branches;
next	1.138;

1.138
date	2009.05.05.17.35.37;	author pwagner;	state Exp;
branches;
next	1.137;

1.137
date	2009.04.30.20.12.19;	author pwagner;	state Exp;
branches;
next	1.136;

1.136
date	2009.04.01.23.18.54;	author pwagner;	state Exp;
branches;
next	1.135;

1.135
date	2009.01.28.17.58.59;	author pwagner;	state Exp;
branches;
next	1.134;

1.134
date	2008.10.07.18.12.29;	author pwagner;	state Exp;
branches;
next	1.133;

1.133
date	2008.08.22.17.16.31;	author pwagner;	state Exp;
branches;
next	1.132;

1.132
date	2008.06.06.21.05.50;	author michael;	state Exp;
branches;
next	1.131;

1.131
date	2008.05.27.16.59.49;	author pwagner;	state Exp;
branches;
next	1.130;

1.130
date	2008.03.20.18.34.20;	author pwagner;	state Exp;
branches;
next	1.129;

1.129
date	2006.10.26.19.30.02;	author lambert;	state Exp;
branches;
next	1.128;

1.128
date	2006.10.10.20.14.39;	author lambert;	state Exp;
branches;
next	1.127;

1.127
date	2006.10.04.16.49.25;	author pwagner;	state Exp;
branches;
next	1.126;

1.126
date	2006.09.29.21.26.02;	author bill;	state Exp;
branches;
next	1.125;

1.125
date	2006.09.26.23.41.21;	author bill;	state Exp;
branches;
next	1.124;

1.124
date	2006.09.22.22.23.08;	author bill;	state Exp;
branches;
next	1.123;

1.123
date	2006.08.03.05.06.55;	author lambert;	state Exp;
branches;
next	1.122;

1.122
date	2006.08.03.00.52.03;	author lambert;	state Exp;
branches;
next	1.121;

1.121
date	2006.07.28.23.34.46;	author dwu;	state Exp;
branches;
next	1.120;

1.120
date	2006.07.27.01.06.41;	author lambert;	state Exp;
branches;
next	1.119;

1.119
date	2006.07.27.01.00.21;	author lambert;	state Exp;
branches;
next	1.118;

1.118
date	2006.07.22.01.24.07;	author lambert;	state Exp;
branches;
next	1.117;

1.117
date	2006.07.21.23.49.56;	author lambert;	state Exp;
branches;
next	1.116;

1.116
date	2006.07.18.22.30.31;	author lambert;	state Exp;
branches;
next	1.115;

1.115
date	2006.07.15.00.15.54;	author lambert;	state Exp;
branches;
next	1.114;

1.114
date	2006.07.11.17.05.40;	author lambert;	state Exp;
branches;
next	1.113;

1.113
date	2006.07.07.00.02.36;	author bill;	state Exp;
branches;
next	1.112;

1.112
date	2006.06.29.23.34.10;	author lambert;	state Exp;
branches;
next	1.111;

1.111
date	2006.06.29.23.04.42;	author lambert;	state Exp;
branches;
next	1.110;

1.110
date	2006.06.14.23.02.32;	author lambert;	state Exp;
branches;
next	1.109;

1.109
date	2006.06.02.23.46.37;	author lambert;	state Exp;
branches;
next	1.108;

1.108
date	2006.06.02.22.44.05;	author bill;	state Exp;
branches;
next	1.107;

1.107
date	2006.05.25.18.28.41;	author bill;	state Exp;
branches;
next	1.106;

1.106
date	2006.05.19.17.39.13;	author dwu;	state Exp;
branches;
next	1.105;

1.105
date	2006.05.17.17.00.10;	author dwu;	state Exp;
branches;
next	1.104;

1.104
date	2006.05.16.22.27.36;	author bill;	state Exp;
branches;
next	1.103;

1.103
date	2006.05.12.23.24.19;	author pwagner;	state Exp;
branches;
next	1.102;

1.102
date	2006.05.12.19.31.10;	author lambert;	state Exp;
branches;
next	1.101;

1.101
date	2006.05.11.22.05.36;	author lambert;	state Exp;
branches;
next	1.100;

1.100
date	2006.05.11.20.35.02;	author lambert;	state Exp;
branches;
next	1.99;

1.99
date	2006.05.10.04.01.15;	author dwu;	state Exp;
branches;
next	1.98;

1.98
date	2006.05.08.21.32.39;	author bill;	state Exp;
branches;
next	1.97;

1.97
date	2006.05.04.19.51.10;	author bill;	state Exp;
branches;
next	1.96;

1.96
date	2006.04.27.23.33.18;	author lambert;	state Exp;
branches;
next	1.95;

1.95
date	2006.03.01.19.47.39;	author dwu;	state Exp;
branches;
next	1.94;

1.94
date	2006.03.01.19.45.47;	author dwu;	state Exp;
branches;
next	1.93;

1.93
date	2004.11.17.00.25.24;	author livesey;	state Exp;
branches;
next	1.92;

1.92
date	2004.10.29.03.52.09;	author dwu;	state Exp;
branches;
next	1.91;

1.91
date	2004.08.16.23.43.09;	author livesey;	state Exp;
branches;
next	1.90;

1.90
date	2004.07.06.21.54.23;	author livesey;	state Exp;
branches;
next	1.89;

1.89
date	2004.06.25.23.50.16;	author livesey;	state Exp;
branches;
next	1.88;

1.88
date	2004.05.25.21.02.30;	author livesey;	state Exp;
branches;
next	1.87;

1.87
date	2004.05.17.23.23.58;	author livesey;	state Exp;
branches;
next	1.86;

1.86
date	2004.05.17.22.11.34;	author livesey;	state Exp;
branches;
next	1.85;

1.85
date	2004.04.01.17.18.05;	author livesey;	state Exp;
branches;
next	1.84;

1.84
date	2004.03.04.22.03.03;	author livesey;	state Exp;
branches;
next	1.83;

1.83
date	2004.02.27.23.20.11;	author livesey;	state Exp;
branches;
next	1.82;

1.82
date	2004.02.23.12.26.00;	author livesey;	state Exp;
branches;
next	1.81;

1.81
date	2004.02.23.12.21.32;	author livesey;	state Exp;
branches;
next	1.80;

1.80
date	2004.02.11.00.03.07;	author livesey;	state Exp;
branches;
next	1.79;

1.79
date	2004.02.10.01.33.53;	author livesey;	state Exp;
branches;
next	1.78;

1.78
date	2004.02.10.01.32.24;	author livesey;	state Exp;
branches;
next	1.77;

1.77
date	2004.02.07.00.47.54;	author livesey;	state Exp;
branches;
next	1.76;

1.76
date	2004.01.27.18.44.04;	author livesey;	state Exp;
branches;
next	1.75;

1.75
date	2004.01.24.03.23.33;	author livesey;	state Exp;
branches;
next	1.74;

1.74
date	2004.01.20.23.43.21;	author dwu;	state Exp;
branches;
next	1.73;

1.73
date	2004.01.14.23.04.11;	author livesey;	state Exp;
branches;
next	1.72;

1.72
date	2003.11.15.01.53.06;	author livesey;	state Exp;
branches;
next	1.71;

1.71
date	2003.11.14.23.38.58;	author livesey;	state Exp;
branches;
next	1.70;

1.70
date	2003.11.13.23.17.22;	author livesey;	state Exp;
branches;
next	1.69;

1.69
date	2003.11.08.00.47.43;	author livesey;	state Exp;
branches;
next	1.68;

1.68
date	2003.11.06.23.26.38;	author livesey;	state Exp;
branches;
next	1.67;

1.67
date	2003.11.04.01.12.06;	author livesey;	state Exp;
branches;
next	1.66;

1.66
date	2003.11.01.18.45.51;	author livesey;	state Exp;
branches;
next	1.65;

1.65
date	2003.10.15.11.48.37;	author mjf;	state Exp;
branches;
next	1.64;

1.64
date	2003.10.11.01.36.32;	author livesey;	state Exp;
branches;
next	1.63;

1.63
date	2003.08.26.20.13.07;	author livesey;	state Exp;
branches;
next	1.62;

1.62
date	2003.08.14.20.26.24;	author livesey;	state Exp;
branches;
next	1.61;

1.61
date	2003.08.14.16.17.49;	author dwu;	state Exp;
branches;
next	1.60;

1.60
date	2003.08.13.01.30.22;	author dwu;	state Exp;
branches;
next	1.59;

1.59
date	2003.08.12.19.41.55;	author livesey;	state Exp;
branches;
next	1.58;

1.58
date	2003.08.12.00.51.30;	author dwu;	state Exp;
branches;
next	1.57;

1.57
date	2003.08.11.23.54.57;	author dwu;	state Exp;
branches;
next	1.56;

1.56
date	2003.08.08.23.05.47;	author livesey;	state Exp;
branches;
next	1.55;

1.55
date	2003.08.06.20.41.23;	author dwu;	state Exp;
branches;
next	1.54;

1.54
date	2003.06.09.17.39.39;	author livesey;	state Exp;
branches;
next	1.53;

1.53
date	2003.05.26.06.33.48;	author livesey;	state Exp;
branches;
next	1.52;

1.52
date	2003.05.10.22.21.38;	author livesey;	state Exp;
branches;
next	1.51;

1.51
date	2003.05.09.23.53.47;	author livesey;	state Exp;
branches;
next	1.50;

1.50
date	2003.05.08.20.50.48;	author livesey;	state Exp;
branches;
next	1.49;

1.49
date	2003.05.07.20.54.12;	author livesey;	state Exp;
branches;
next	1.48;

1.48
date	2003.05.06.20.27.30;	author livesey;	state Exp;
branches;
next	1.47;

1.47
date	2003.05.03.21.59.44;	author livesey;	state Exp;
branches;
next	1.46;

1.46
date	2003.04.24.19.44.52;	author dwu;	state Exp;
branches;
next	1.45;

1.45
date	2003.04.04.01.19.26;	author livesey;	state Exp;
branches;
next	1.44;

1.44
date	2003.04.01.21.02.55;	author livesey;	state Exp;
branches;
next	1.43;

1.43
date	2003.03.27.21.16.47;	author livesey;	state Exp;
branches;
next	1.42;

1.42
date	2003.03.25.21.18.52;	author livesey;	state Exp;
branches;
next	1.41;

1.41
date	2003.03.22.01.17.46;	author livesey;	state Exp;
branches;
next	1.40;

1.40
date	2003.03.01.02.11.32;	author livesey;	state Exp;
branches;
next	1.39;

1.39
date	2003.02.28.16.37.59;	author livesey;	state Exp;
branches;
next	1.38;

1.38
date	2003.02.28.14.29.42;	author mjf;	state Exp;
branches;
next	1.37;

1.37
date	2003.02.27.00.39.38;	author livesey;	state Exp;
branches;
next	1.36;

1.36
date	2003.02.18.23.59.39;	author livesey;	state Exp;
branches;
next	1.35;

1.35
date	2003.01.31.00.10.03;	author dwu;	state Exp;
branches;
next	1.34;

1.34
date	2003.01.27.17.02.22;	author dwu;	state Exp;
branches;
next	1.33;

1.33
date	2003.01.22.07.09.32;	author livesey;	state Exp;
branches;
next	1.32;

1.32
date	2003.01.14.23.49.05;	author livesey;	state Exp;
branches;
next	1.31;

1.31
date	2003.01.08.02.13.26;	author livesey;	state Exp;
branches;
next	1.30;

1.30
date	2003.01.07.23.48.02;	author livesey;	state Exp;
branches;
next	1.29;

1.29
date	2002.12.16.15.57.41;	author mjf;	state Exp;
branches;
next	1.28;

1.28
date	2002.11.22.12.42.00;	author mjf;	state Exp;
branches;
next	1.27;

1.27
date	2002.11.22.00.09.36;	author livesey;	state Exp;
branches;
next	1.26;

1.26
date	2002.11.21.01.18.54;	author livesey;	state Exp;
branches;
next	1.25;

1.25
date	2002.11.20.19.48.59;	author mjf;	state Exp;
branches;
next	1.24;

1.24
date	2002.10.25.01.09.35;	author livesey;	state Exp;
branches;
next	1.23;

1.23
date	2002.10.23.23.26.55;	author livesey;	state Exp;
branches;
next	1.22;

1.22
date	2002.10.23.19.56.29;	author livesey;	state Exp;
branches;
next	1.21;

1.21
date	2002.10.19.18.52.36;	author livesey;	state Exp;
branches;
next	1.20;

1.20
date	2002.10.18.02.25.48;	author livesey;	state Exp;
branches;
next	1.19;

1.19
date	2002.10.17.18.19.39;	author livesey;	state Exp;
branches;
next	1.18;

1.18
date	2002.10.03.05.42.00;	author livesey;	state Exp;
branches;
next	1.17;

1.17
date	2002.10.02.23.23.21;	author livesey;	state Exp;
branches;
next	1.16;

1.16
date	2002.10.02.23.06.00;	author pwagner;	state Exp;
branches;
next	1.15;

1.15
date	2002.09.27.00.00.14;	author livesey;	state Exp;
branches;
next	1.14;

1.14
date	2002.08.15.22.46.17;	author livesey;	state Exp;
branches;
next	1.13;

1.13
date	2002.08.04.16.14.27;	author mjf;	state Exp;
branches;
next	1.12;

1.12
date	2002.07.17.19.29.37;	author livesey;	state Exp;
branches;
next	1.11;

1.11
date	2002.07.07.23.37.26;	author livesey;	state Exp;
branches;
next	1.10;

1.10
date	2002.06.26.20.21.28;	author livesey;	state Exp;
branches;
next	1.9;

1.9
date	2002.06.26.01.26.58;	author livesey;	state Exp;
branches;
next	1.8;

1.8
date	2002.06.21.00.59.39;	author livesey;	state Exp;
branches;
next	1.7;

1.7
date	2002.06.15.00.11.53;	author livesey;	state Exp;
branches;
next	1.6;

1.6
date	2002.06.07.18.03.10;	author livesey;	state Exp;
branches;
next	1.5;

1.5
date	2002.06.04.23.23.15;	author livesey;	state Exp;
branches;
next	1.4;

1.4
date	2002.05.28.22.36.14;	author livesey;	state Exp;
branches;
next	1.3;

1.3
date	2002.05.17.20.24.08;	author livesey;	state Exp;
branches;
next	1.2;

1.2
date	2002.05.13.17.24.25;	author livesey;	state Exp;
branches;
next	1.1;

1.1
date	2002.04.29.21.54.58;	author pwagner;	state Exp;
branches;
next	;


desc
@@


1.168
log
@Avoid overwriting latest HCN climatology
@
text
@!divert(-1)
;; $Id: fillapriori.l2cf,v 1.167 2019/11/08 18:18:25 pwagner Exp $

;; This l2cf fragment is for setting up a priori vectors with
;; appropriate quantities

!divert!dnl
;; ----------------------------------------------- Setup vectors

;; First define the vectors in question
begin Fill
  apriori: Vector, template=stateTemplate
  aprioriPrecision: Vector, template=stateTemplate
  hReg: Vector, template=stateTemplate
  vReg: Vector, template=stateTemplate
  ;; The low/high bound options here make sure it defaults to
  ;; +/- huge, instead of the usual default of zero
  lowBound: Vector, template=stateTemplate, /lowBound
  highBound: Vector, template=stateTemplate, /highBound

end Fill

;; ----------------------------------- Fill species with climatology

begin Fill
  
  ;; Do this unless we lack climatological data.

  !ifdef(flagIgnoreClimatology,{},{
  ;; This macro fills one apriori quantity with climatlogical data
  !define(fillWithClimatology,{Fill, quantity=apriori.$1, method=gridded, $
    sourceGrid=grid$1!nl})

  ;; Now invoke it for all relevant species
  !forall(fillWithClimatology,!allClimatologicalSpecies)

  !ifdef(flagSetTopOfHCl,{

  ;;Dump, text='Before setting top of HCl to 3ppbv'
  ;;Dump, details=2, quantity=apriori.hcl
  ;; Set the top of HCl to 3ppbv
  ;; (We will be able to dispense with bookending Subsets soon)
  Subset, quantity=apriori.hcl, height=[2.4mb:0.00001mb], mask=fill
  Fill, quantity=apriori.hcl, method=explicit, explicitValues=3ppbv, /spread
  Subset, quantity=apriori.hcl, mask=fill, /reset

  ;;Dump, text='After setting top of HCl to 3ppbv'
  ;;Dump, details=2, quantity=apriori.hcl
})
  ;; Possibly overwrite temperature with the merged product
  !ifdef(flagIgnoreMeteorology,{},{Fill, quantity=apriori.temperature, $
    method=gridded, sourceGrid=mergedTemperature})

  ;; Now for H2O make the bottom value extra large
  Subset, quantity=apriori.h2o, height=[1000mb:1000mb], mask=fill
  Fill, quantity=apriori.h2o, method=explicit, explicitValues=4000ppmv, /spread
  Subset, quantity=apriori.h2o, mask=fill, /reset

  ;; Get RHI from H2O
  Fill, quantity=apriori.rhi, h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, method=RHIFromH2O

  Fill, quantity=apriori.rhivmrsngl,method=profile, profileValues = $
      [ 100mb : 10.0, 68mb:0.0001]

  Fill, quantity=apriori.rhivmr,sourcequantity=apriori.rhi,method = vector, $
        /interpolate,/ignoreTemplate

; These radiometers use nu^2 extinctions instead of flat extinctions
!define(v2ExtinctionRadiometers,{R3})!dnl
; r2 extinction
   Fill, quantity=apriori.totalextinctionr2,method=profile, profileValues = $
      [ 1000mb: 0.01, 681mb:0.01, 464mb : 0.007, 316mb : 0.005, $
      215mb : 0.001, 147mb : 0.0004, 100mb : 0.0002, 68mb:8.8e-5, $
      46mb: 4.7e-5, 32mb:2.7e-5,22mb:1.2e-5,15mb:5.1e-6, $
      10mb:5.8e-7,0.00001mb:1.0e-7]
; r3 extinction
; these values are better suited for mif extinction
   Fill, quantity=apriori.totalextinctionr3,method=profile, profileValues = $
      [ 1000mb: 0.01, 681mb:0.01, 464mb : 0.008, 316mb : 0.004, $
      215mb : 0.001, 147mb : 0.0005, 100mb : 0.0003, 68mb:0.0002, $
      46mb: 0.0001, 32mb:7.0e-5,22mb:4.0e-5,15mb:9.3e-6, $
      10mb:2.7e-6,1mb:1.0e-8,0.1mb:1.5e-10,0.01mb:2.0e-12,0.001mb:3.3e-14, $
      0.0001mb:3.0e-16,0.00001mb:3.0e-18]
; r4 extinction
   Fill, quantity=apriori.totalextinctionr4,method=profile, profileValues = $
      [ 1000mb: 0.01, 681mb:0.01, 464mb : 0.01, 316mb : 0.009, $
      215mb : 0.0067, 147mb : 0.0031, 100mb : 0.0015, 68mb:0.00083, $
      46mb: 0.00051, 32mb:0.00031,22mb:0.00018,15mb:6.5e-5, $
      10mb:8.3e-6,0.00001mb:1.0e-7]

  ;; --------------------------------------------- tpPressure
  !ifdef(tpPressure,{
    Fill, quantity=apriori.tpPressure, method=explicit, $
      explicitValues=!tpPressure, /spread
  },{
    Fill, quantity=apriori.tpPressure, method=wmoTropopause, $
      temperatureQuantity=apriori.temperature, refGPHQuantity=apriori.refGPH, $
      internalVgrid=vGridWMO
  })
  Fill, quantity=apriori.oneHundredHPa, method=explicit, explicitValues=100hPa, /spread
  }) ;; End if flagGotClimatology

  ;; --------------------------------------------- hiRes Fills

  !ifdef(flagGotClimatology,{
  !define(fillWithClimatologyHR,{Fill, quantity=apriori.$1_HR, method=gridded, $
    sourceGrid=grid$1!nl})
  !define(interpolateToHiRes,{Fill, quantity=$1, sourceQuantity=!TrimLast3($1),!dnl
     method=vector, /interpolate!nl})

  ;; Could write some fancy macros here to get the list as the
  ;; intersection of allClimatologicalSpecies and allHiResMolecules,
  ;; However, life is too short!
  !fillWithClimatologyHR(Temperature)
  !fillWithClimatologyHR(H2O)
  !fillWithClimatologyHR(O3)
  !fillWithClimatologyHR(CO)
  ;; Get RHI_HR from RHI.  Not sure if this should really be from
  ;; H2O_HR and temperature_HR
  !interpolateToHiRes(apriori.RHI_HR)
  }) ;; End if flagGotClimatology

  ;; Possibly overwrite temperature with the merged product
  !ifdef(flagIgnoreMeteorology,{},{Fill, quantity=apriori.temperature_hr,$
    method=gridded, sourceGrid=mergedTemperature})
  !ifdef(flagDestroyMeteorology,{Destroy, grid=mergedTemperature})
end Fill

;; ----------------------------------- Lesser state

;; Fill the lesser stuff
!include(filllesserstate.l2cf)

;; ----------------------------------- Tangent pressures

begin Fill

  !ifdef(flagGotClimatology,{
  ;; Now fill some remaining stuff
  ;; PEs read in an apriori reference GPH from climatology
  !ifdef(flagPrecisionEstimates,{
  ; PEs have read in an apriori reference GPH from climatology
  },{
!ifdef(flagUseOperationalGPH, {
Fill, quantity=apriori.refGPH,$
    method=gridded, sourceGrid=mergedGPH
},{
    Fill, quantity=apriori.refGPH, method=explicit, $
      explicitvalues=16 km,/spread})
  }) ;; End if precision estimates

  ;; Compute non refracted phitans for apriori
  Fill, quantity=apriori.phiTanGHz, method=refract, $
    ptanQuantity=apriori.ptanGHz, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false
  Fill, quantity=apriori.phiTanTHz, method=refract, $
    ptanQuantity=apriori.ptanTHz, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false

  ;; Get full GPH profile
  Fill, quantity=apriori.gph, method=hydrostatic, $
    temperatureQuantity=apriori.temperature, $
    refGPHquantity=apriori.refGPH
  Fill, quantity=apriori.gph_HR, method=hydrostatic, $
    temperatureQuantity=apriori.temperature_HR, $
    refGPHquantity=apriori.refGPH

  !ifdef(flagSkipHydrostatic,{},{
  ;; Now compute the tangent presssures for apriori
  Fill, quantity=apriori.ptanGHz, method=hydrostatic, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, $
    refGPHQuantity=apriori.refGPH, $
    geocAltitudeQuantity=apriori.tngtGeocAltGHz, $
    orbitInclination=apriori.orbitInclination, $
    phiTan=apriori.phiTanGHz, $
    maxIterations=20, $
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
  Fill, quantity=apriori.ptanTHz, method=hydrostatic, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, $
    refGPHQuantity=apriori.refGPH, $
    geocAltitudeQuantity=apriori.tngtGeocAltTHz, $
    orbitInclination=apriori.orbitInclination, $
    phiTan=apriori.phiTanTHz, $
    maxIterations=20, $
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
     ;; Added to have geoHeight in the Swats
  Fill, quantity=tempVectorState.h2o, method=heightFromPressure, $
     ptanQuantity=apriori.ptanGHz, $
     h2oQuantity=apriori.h2o, $
     orbitInclination=apriori.orbitInclination, $
     refGPHQuantity=apriori.refGPH, $
     temperatureQuantity=apriori.temperature 
  ;;  GeoHeight changes
  Fill, quantity=geoHeightVector.geoHeight, method=heightFromPressure, $
     ptanQuantity=apriori.ptanGHz, $
     h2oQuantity=apriori.h2o, $
     orbitInclination=apriori.orbitInclination, $
     refGPHQuantity=apriori.refGPH, $
     temperatureQuantity=apriori.temperature 
  ;; GeoHeight for HiRes
  Fill, quantity=geoHeightVector.geoHeight_hr, method=heightFromPressure, $
     ptanQuantity=apriori.ptanGHz, $
     h2oQuantity=apriori.h2o_hr, $
     orbitInclination=apriori.orbitInclination, $
     refGPHQuantity=apriori.refGPH, $
     temperatureQuantity=apriori.temperature_hr
    }) ;; End if not skipHydrostatic

  }) ;; End if gotClimatology

  ;; Fill the magnetic field.

!ifelse(!MagneticFieldGrid, {Altitude}, {!dnl 
  Fill, quantity=apriori.magneticField, method=magneticModel 
   }, !MagneticFieldGrid, {AltitudeUnstacked},{!dnl 
    Fill, quantity=apriori.magneticField, method=magneticModel, $
    scVelECR=apriori.scVelECR, geocAltitudeQuantity=apriori.tngtGeocAltGHz
    },{!dnl ;Default method is Theta
  Fill, quantity=apriori.magneticField, method=magneticModel, $
   GPHquantity=apriori.gph
  Fill, quantity=apriori.fieldAzimuth, method=rotateField, $
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  Fill, quantity=apriori.fieldElevation, method=rotateField, $
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  Fill, quantity=apriori.fieldStrength, method=rotateField, $
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV})
    
  ;; -------------------------------- Apriori precisions for species

  Fill, quantity=aprioriPrecision.bro,  method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.ch3cn,method=explicit, /spread, explicitValues= 2 ppbv
  ;; CH3CN was 500 pptv
  Fill, quantity=aprioriPrecision.clo,  method=explicit, /spread, explicitValues= 3 ppbv
;; CH3CL
  Fill, quantity=aprioriPrecision.ch3cl,method=explicit, /spread, explicitValues= 500 pptv
  Fill, quantity=aprioriPrecision.ch3oh,method=explicit, /spread, explicitValues= 5 ppbv
  Fill, quantity=aprioriPrecision.ch3ch2oh,method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.ch3coch3,method=explicit, /spread, explicitValues= 500 pptv


  Fill, quantity=aprioriPrecision.h2o, method=profile, profileValues = $
    [ 1000mb: 10000ppmv, 464mb : 10000ppmv, 316mb : 1500ppmv, $
      215mb : 300ppmv, 147mb : 300ppmv, 100mb : 3.0ppmv ]
  Fill, quantity=aprioriPrecision.hcl,  method=profile, $
    profileValues= [ 147mb : 2ppbv, 100mb : 4ppbv ]
  ;; 0.2 ppbv is too small for hcn
  Fill, quantity=aprioriPrecision.hcn,  method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.hno3, method=profile, $
    profileValues= [ 316mb : 4ppbv, 100mb: 8ppbv, 50mb : 10ppbv ]
  ;; 1 ppbv is too small for ho2
  Fill, quantity=aprioriPrecision.ho2,  method=explicit, /spread, explicitValues= 10 ppbv
  Fill, quantity=aprioriPrecision.hocl, method=explicit, /spread, explicitValues= 3 ppbv
  ;; For N2O, 0.2 ppmv is too small for the troposphere, but we don't
  ;; have sensitivity there
  ;Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 0.2 ppmv
  Fill, quantity=aprioriPrecision.n2o, method=profile, profileValues = $
    [ 147mb: 50ppbv, 100mb : 200ppbv ]
  Fill, quantity=aprioriPrecision.o2,  method=explicit, /spread, explicitValues= 20000.0 ppmv
  Fill, quantity=aprioriPrecision.o3,   method=profile, $
    profileValues = [ 316mb : 500ppbv, 100mb:2ppmv, 46mb : 4 ppmv, $
     0.00046mb:10ppmv ]
  ;; 1 ppbv is too small for OH.  Better with a profile?
  Fill, quantity=aprioriPrecision.oh,   method=profile, $
    profileValues = [ 10mb : 0.1ppbv, 1mb : 1 ppbv, 0.1mb : 5 ppbv, 0.01mb : 10 ppbv ]
  ;; Be careful not to apply scaling twice to oh precision!
  Fill, quantity=aprioriPrecision.oh, method=manipulate, $
    a=aprioriPrecision.oh, c=1.5, manipulation='c*a'

  ;; 100pptv is far too small for so2
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 10 ppbv

  Fill, quantity=aprioriPrecision.temperature, method=profile, $
    profileValues= [ 1000mb:5K, 220mb:10K, 68mb:20K ]
  Fill, quantity=aprioriPrecision.refGPH, method=explicit, /spread, explicitValues= 5 km
  Fill, quantity=aprioriPrecision.gph, method=explicit, /spread, explicitValues= 5 km

  ;; Convert H2O precision to RHI precision
  Fill, quantity=aprioriPrecision.rhi, $
    h2oPrecisionQuantity=aprioriPrecision.h2o, $
    tempPrecisionQuantity=aprioriPrecision.temperature, $
    h2oQuantity=apriori.h2o, temperatureQuantity=apriori.temperature, $
    method=RHIFromH2O

  Fill, quantity=aprioriPrecision.rhivmrsngl, $
        sourcequantity=aprioriPrecision.rhi,method = vector,/interpolate, $
        /ignoreTemplate
  Fill, quantity=aprioriPrecision.rhivmrsngl, method=profile, $
        profileValues= [ 100mb:100, 68mb:0.0001 ]

  Fill, quantity=aprioriPrecision.rhivmr, method=explicit,  $
        explicitValues=100, /spread

  ;; This macro interpolates standard resolution quantities to the
  ;; hiRes equivalents. 
  !define(interpolateToHiRes,{Fill, quantity=$1, sourceQuantity=!TrimLast3($1),!dnl
     method=vector, /interpolate!nl})
  !interpolateToHiRes(aprioriPrecision.temperature_HR)
  !interpolateToHiRes(aprioriPrecision.o3_HR)
  !forall(interpolateToHiRes,!makelist(aprioriPrecision.,{},!allHiResMolecules))

  ;; Get RHI_HR from RHI.  Not sure if this should really be from
  ;; H2O_HR and temperature_HR
  !interpolateToHiRes(aprioriPrecision.RHI_HR)
  ;; Get gph_HR from gph.  Not sure if this should really be from
  ;; temperature_HR
  !interpolateToHiRes(aprioriPrecision.gph_HR)

  ;; Actually we'll take a looser precision for H2O
  Fill, quantity=aprioriPrecision.h2o_hr, method=profile, profileValues = $
    [ 1000mb: 10000ppmv, 464mb : 10000ppmv, 316mb : 1500ppmv, $
      215mb : 300ppmv, 147mb : 20ppmv, 100mb : 6.0ppmv, $
      0.00464mb:6ppmv, 0.00215mb:7ppmv, 0.001mb:10ppmv  ]

  Fill, quantity=vReg.co_hr, method=profile, profileValues= $
    [ 10mb:15ppbv, 3.1mb:50ppbv,  1mb:150ppbv, 0.31mb: 0.5ppmv, 0.1mb:1.5ppmv, $
      0.03mb:5ppmv, 0.01mb: 15ppmv, 0.003mb: 50ppmv, 0.001mb:150ppmv ]

  ;; We already filled the hires ozone precision by inerpolating the std res

  ;; ------------------------------ A priori extinction precisions

  !define(fillExtinctionApriori,{
!ifelse(!index(!defn(v2ExtinctionRadiometers),$1),{-1},{
  Fill, quantity=aprioriPrecision.extinction$1, $
    method=explicit, /spread, explicitValues=1.0e-6!nl
},{!dnl
  Fill, quantity=aprioriPrecision.extinctionv2$1, $
    method=explicit, /spread, explicitValues=1.0e-6!nl})
})
  !forall({fillExtinctionApriori},!allRadiometers)

; r2-4 extinction based on 3-sigma of off-line retrieval
   Fill, quantity=aprioriPrecision.totalextinctionr2,method=profile, $
        profileValues = $
      [ 1000mb: 0.006, 681mb:0.006, 464mb : 0.006, 316mb : 0.006, $
      215mb : 0.0026, 147mb : 0.0006, 100mb : 0.0003, 68mb:9.0e-5, $
      46mb: 3.8e-5, 32mb:2.0e-5,22mb:9.2e-6,15mb:1.9e-6,10mb:1.0e-6, $
      0.00001mb:1.0e-6]
   Fill, quantity=aprioriPrecision.totalextinctionr3,method=profile, $
        profileValues = $
     [ 1000mb: 1.0E-7, 681mb:0.0005, 464mb : 0.001, 316mb : 0.001, $
      215mb : 0.0006, 147mb : 0.0002, 100mb : 0.0001, 68mb:0.0001, $
      46mb: 7.0e-5, 32mb:4.0e-5,22mb:2.0e-5,15mb:5.0e-6,10mb:2.0e-6, $
      0.00001mb:1.0e-6]
;; WVS
   Fill, quantity=aprioriPrecision.totalextinctionv2r3,method=explicit, $
     /spread, explicitValues=1.0e6
   Fill, quantity=aprioriPrecision.totalextinctionr4,method=profile, $
        profileValues = $
      [ 1000mb: 0.0001, 681mb:0.0001, 464mb : 0.0001, 316mb : 0.0001, $
      215mb : 0.0001, 147mb : 0.0001, 100mb : 0.0001, 68mb:0.0001, $
      46mb: 0.0001, 32mb:0.0001,22mb:0.0001,15mb:4.0e-5,10mb:7.0e-6, $
      0.00001mb:1.0e-6]

; r1a,r1b r5v, r5h need to be updated later
  Fill, quantity=aprioriPrecision.totalextinctionR1A,method=explicit, $
        /spread, explicitValues=1.0e-6
  Fill, quantity=aprioriPrecision.totalextinctionR1B,method=explicit, $
        /spread, explicitValues=1.0e-6
  Fill, quantity=aprioriPrecision.totalextinctionR5V,method=explicit, $
        /spread, explicitValues=1.0e-6
  Fill, quantity=aprioriPrecision.totalextinctionR5H,method=explicit, $
        /spread, explicitValues=1.0e-6


  ;; ------------------------------ Baseline precisions

  !define(fillBaselineApriori,{
  Fill, quantity=aprioriPrecision.baseline$1, method=profile, profileValues = $
    [ 1000mb: 80K, 464mb : 50K, 316mb : 30K, $
      215mb : 20K, 147mb : 10K, 100mb : 5.0K ] !nl})
  !forall({fillBaselineApriori},!allRadiometers)

  !define(fillBaselineFineApriori,{
  Fill, quantity=aprioriPrecision.baselineFine$1, method=profile, profileValues = $
    [ 1000mb: 80K, 464mb : 50K, 316mb : 30K, $
      215mb : 20K, 147mb : 10K, 100mb : 5.0K ] !nl})
  !forall({fillBaselineFineApriori},!allRadiometers)

  !define(fillBaselineMAFApriori,{
  Fill, quantity=aprioriPrecision.baselineMAF$1, method=explicit, $
        explicitvalues = 5K, /spread !nl})
  !forall({fillBaselineMAFApriori},!allRadiometers)
; dacs baseline
  !forall({fillBaselineMAFApriori},!allDACS)
; MB baseline
  !forall({fillBaselineMAFApriori},!allMBs)

; MIF baselines

  !define(fillBaselineMIFApriori,{
  Fill, quantity=aprioriPrecision.baselineMIF$1, method=explicit, $
    explicitValues=5K, /spread !nl})
  !forall({fillBaselineMIFApriori},!allRadiometers)
; dacs baseline
  !forall({fillBaselineMIFApriori},!allDACS)
; MB baseline
  !forall({fillBaselineMIFApriori},!allMBs)

  !define(fillBaselineGroupApriori,{
  Fill, quantity=aprioriPrecision.baselineR4Group$1, method=explicit, $
    explicitValues=5K, /spread !nl})
  !forall({fillBaselineGroupApriori},1,2,3)

  ;; --------------------------------------- Bounds for species

  Fill, quantity=lowBound.ptanGHz, method=explicit, explicitValues= -20, /spread
  Fill, quantity=highBound.ptanGHz, method=explicit, explicitValues= 20, /spread

  Fill, quantity=lowBound.ptanTHz, method=explicit, explicitValues= -20, /spread
  Fill, quantity=highBound.ptanTHz, method=explicit, explicitValues= 20, /spread

  Fill, quantity=lowBound.temperature, method=explicit, explicitValues=100K, /spread
  Fill, quantity=highBound.temperature, method=explicit, explicitValues=550K, /spread

  Fill, quantity=lowBound.h2o, method=explicit, explicitValues=0.1ppmv, /spread
  Fill, quantity=highBound.h2o, method=explicit, explicitValues=0.06, /spread

  ;Fill, quantity=lowBound.oh, method=explicit, explicitValues= -40pptv, /spread
  Fill, quantity=lowBound.n2o,method=explicit, explicitValues= -40ppbv, /spread

  Fill, quantity=lowBound.RHiVmrsngl, method=profile, profileValues=[100mb:2, 68mb:0.0001]
  Fill, quantity=highBound.RHiVmrsngl, method=profile, profileValues=[100mb:110, 68mb:0.0001], /spread

;; ensure that apriori between lowbound and highbound
   Fill, quantity=apriori.RHiVmrsngl, method=manipulate,a=apriori.RHiVmrsngl,b=lowBound.RHiVmrsngl,$
        manipulation='a>b'
   Fill, quantity=apriori.RHiVmrsngl, method=manipulate,a=apriori.RHiVmrsngl,b=highBound.RHiVmrsngl,$
        manipulation='a<b'

   Fill, quantity=lowBound.RHiVmr, method=explicit, explicitValues=0.00001, /spread
   Fill, quantity=highBound.RHiVmr, method=explicit, explicitValues=2000, /spread

;; ensure that apriori between lowbound and highbound
   Fill, quantity=apriori.RHiVmr, method=manipulate,a=apriori.RHiVmr,b=lowBound.RHiVmr,$
        manipulation='a>b'
   Fill, quantity=apriori.RHiVmr, method=manipulate,a=apriori.RHiVmr,b=highBound.RHiVmr,$
        manipulation='a<b'

  Fill, quantity=lowBound.extinctionR2, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.extinctionR2, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.extinctionv2R2, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.extinctionv2R2, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.extinctionR3, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.extinctionR3, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.extinctionv2R3, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.extinctionv2R3, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.extinctionR4, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.extinctionR4, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.extinctionv2R4, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.extinctionv2R4, method=explicit, $
        explicitValues=0.01, /spread

  Fill, quantity=lowBound.totalextinctionR2, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalextinctionR2, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalextinctionv2R2, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalextinctionv2R2, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalextinctionR3, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalextinctionR3, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalextinctionv2R3, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalextinctionv2R3, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalextinctionR4, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalextinctionR4, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalextinctionv2R4, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalextinctionv2R4, method=explicit, $
        explicitValues=0.1, /spread

; do the same for mif extinctions

  Fill, quantity=lowBound.mifextinctionR2, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.mifextinctionR2, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.mifextinctionv2R2, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.mifextinctionv2R2, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.mifextinctionR3, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.mifextinctionR3, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.mifextinctionv2R3, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.mifextinctionv2R3, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.mifextinctionR4, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.mifextinctionR4, method=explicit, $
        explicitValues=0.01, /spread
  Fill, quantity=lowBound.mifextinctionv2R4, method=explicit, $
        explicitValues=1.0e-7, /spread
  Fill, quantity=highBound.mifextinctionv2R4, method=explicit, $
        explicitValues=0.01, /spread

  Fill, quantity=lowBound.totalmifextinctionR2, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalmifextinctionR2, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalmifextinctionv2R2, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalmifextinctionv2R2, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalmifextinctionR3, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalmifextinctionR3, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalmifextinctionv2R3, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalmifextinctionv2R3, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalmifextinctionR4, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalmifextinctionR4, method=explicit, $
        explicitValues=0.1, /spread
  Fill, quantity=lowBound.totalmifextinctionv2R4, method=explicit, $
        explicitValues= -4.0e-4, /spread
  Fill, quantity=highBound.totalmifextinctionv2R4, method=explicit, $
        explicitValues=0.1, /spread

  ;; Species with diurnally varying bounds
  ;; Let's see the solar zenith angles (0 is directly overhead'
  Fill, quantity=lowBound.oh, method=manipulate, $
    manipulation='sza(a)', $
    a=lowBound.oh, b=tempVectorState.OH, c=95
  ;;Dump, text='Solar zenith angles (0 is directly overhead)'
  ;;Dump, details=2, quantity=lowBound.oh
  ;; day time values
  Fill, quantity=lowBound.OH,method=profile, profileValues = $
    [ 1000mb : -400pptv, $
      0.316228mb : -400pptv, 0.215443mb : -400pptv, $
      0.146780mb : -500pptv, 0.1mb : -1000pptv, $
      0.068129mb : -1500pptv, 0.046416mb : -2000pptv, $
      0.031623mb : -3000pptv, 0.021544mb : -3000pptv, $
      0.01467mb : -3000pptv, 0.01mb : -3000pptv, $
      0.006813mb : -3000pptv, 0.00464159mb : -3000pptv, $
      0.003162mb : -5000pptv]
  ;;Dump, text='day time values'
  ;;Dump, details=2, quantity=lowBound.oh
  ;; night time values
  Fill, quantity=tempVectorState.OH,method=profile, profileValues = $
    [ 1000mb : -150pptv, $
      0.316228mb : -150pptv, 0.215443mb : -200pptv, $
      0.146780mb : -400pptv, 0.1mb : -500pptv, $
      0.068129mb : -700pptv, 0.046416mb : -1200pptv, $
      0.031623mb : -1500pptv, 0.021544mb : -3000pptv, $
      0.01467mb : -3000pptv, 0.01mb : -4000pptv, $
      0.006813mb : -2000pptv, 0.00464159mb : -3000pptv, $
      0.003162mb : -4000pptv]
  ;;Dump, text='night time values'
  ;;Dump, details=2, quantity=tempVectorState.oh
  ;; Combine day and night time values according to
  ;; day_time*ifpos(95-sza) + night_time*ifneg(95-sza)
  Fill, quantity=lowBound.oh, method=manipulate, $
    manipulation='a*ifpos(c-sza(a)) + b*ifneg(c-sza(a))', $
    a=lowBound.oh, b=tempVectorState.OH, c=95
  ;;Dump, text='Separating OH low bound into day and night values'
  ;;Dump, details=2, quantity=lowBound.oh

  !interpolateToHiRes(lowBound.temperature_HR)
  !interpolateToHiRes(highBound.temperature_HR)
  !interpolateToHiRes(lowBound.o3_HR)
  !interpolateToHiRes(highBound.o3_HR)
  !forall(interpolateToHiRes,!makelist(lowBound.,{},!allHiResMolecules))
  !forall(interpolateToHiRes,!makelist(highBound.,{},!allHiResMolecules))

  ;; Now set the smoothing weights - we'll use a profile fill, even if
  ;; it's only one value.
  ;; In the cases where there are different smoothings for products in
  ;; different phases, I'm quoting there the one for the 'standard' product.

  ;; Vertical
  Fill, quantity=vReg.totalextinctionR2, method=explicit,/spread,explicitValues=5.0e-4
  Fill, quantity=vReg.totalextinctionR3, method=explicit,/spread,explicitValues=0.5e-3
;;  WVS
  Fill, quantity=vReg.totalextinctionv2R3, method=explicit,/spread,explicitValues=0.0

  Fill, quantity=vReg.extinctionR1A, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=vReg.extinctionR1B, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=vReg.extinctionR2, method=explicit,/spread,explicitValues=1.0e-4
  Fill, quantity=vReg.extinctionR3, method=explicit,/spread,explicitValues=1.0e-4
  Fill, quantity=vReg.extinctionv2R3, method=explicit,/spread,explicitValues=1.0e-4

  Fill, quantity=vReg.baselineR1A, method=profile, profileValues=[921mb:0K, 100mb:2K ]
  Fill, quantity=vReg.baselineR1B, method=profile, profileValues=[921mb:0K, 100mb:2K ]
  Fill, quantity=vReg.baselineR2,  method=profile, profileValues=[921mb:0K, 100mb:2K ]
  Fill, quantity=vReg.baselineR3,  method=profile, profileValues=[921mb:0K, 100mb:2K ]
  Fill, quantity=vReg.baselineR4,  method=profile, profileValues=[921mb:0K, 100mb:4K ]
  Fill, quantity=vReg.baselineR5H, method=profile, profileValues=[921mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR5V, method=profile, profileValues=[921mb:0K, 100mb:5K ]

  Fill, quantity=vReg.baselineFineR1A, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR1B, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR2,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR3,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR4,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR5H, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR5V, method=profile, profileValues=[121mb:0K, 100mb:5K ]

  Fill, quantity=vReg.bro, method=profile, $
    profileValues= [ 1mb:0.1ppbv]
  Fill, quantity=vReg.ch3cn, method=profile, $
    profileValues= [ 146mb:500pptv, 100mb:30pptv, 1mb:30pptv, 0.68mb:0pptv ]
  Fill, quantity=vReg.clo, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3cl, method=profile, $
    profileValues= [ 1mb:0.1ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3oh, method=profile, $
    profileValues= [ 1mb:10ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3ch2oh, method=profile, $
    profileValues= [ 1mb:10ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3coch3, method=profile, $
    profileValues= [ 1mb:0.1ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.co, method=profile, profileValues= $
    [ 10mb:15ppbv, 3.1mb:50ppbv,  1mb:150ppbv, 0.31mb: 0.5ppmv, 0.1mb:1.5ppmv, $
      0.03mb:5ppmv, 0.01mb: 15ppmv, 0.003mb: 50ppmv, 0.001mb:150ppmv ]
  Fill, quantity=vReg.co_hr, method=profile, profileValues= $
    [ 10mb:15ppbv, 3.1mb:50ppbv,  1mb:150ppbv, 0.31mb: 0.5ppmv, 0.1mb:1.5ppmv, $
      0.03mb:5ppmv, 0.01mb: 15ppmv, 0.003mb: 50ppmv, 0.001mb:150ppmv ]
  Fill, quantity=vReg.h2o, method=profile, profileValues= $
    [ 1000mb:500ppmv, 300mb:50ppmv, 215mb:20ppmv, 147mb:10ppmv, 100mb:1.0ppmv,$
    1mb:0.3ppmv,0.1mb:5ppmv, 0.001mb:0ppmv ], logSpace=false

  Fill, quantity=vReg.h2o_hr, method=profile, profileValues= $
    [ 1000mb:50ppmv, 316mb:100ppmv,215mb:50ppmv, 147mb:5ppmv,121mb: 2ppmv, $
      100mb:0.5ppmv, 83mb:0.3ppmv, 10mb:0.3ppmv, 1mb:0.4ppmv, 0.1mb:3ppmv, 0.001mb:0ppmv ], $
      logSpace=false
  Fill, quantity=vReg.RHiVmr, method=profile, profileValues= [ $
                    316mb:20.0, 68mb:20.0, 0.147mb:2.0,0.1mb:0.0]
  Fill, quantity=vReg.hcl, method=profile, $
    profileValues= [ 0.1mb:1.0ppbv, 0.046mb:0ppbv ]
  Fill, quantity=vReg.hcn, method=profile, $
    profileValues= [ 0.1mb:20pptv, 0.001mb:80pptv ]
  Fill, quantity=vReg.hno3, method=profile, $
    profileValues= [ 200mb:0.2ppbv, 100mb:1ppbv, 1mb:3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ho2, method=profile, $
    profileValues=[ 32mb:100pptv, 10mb:200pptv, 3.2mb:500pptv, 1mb:500pptv, 0.32mb:2000pptv, 0.15mb:10000pptv ], /logSpace
  Fill, quantity=vReg.hocl, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.n2o, method=profile, $
    profileValues= [ 200mb:10ppbv, 100mb:20ppbv, 1mb:20ppbv, 0.1mb:0ppbv ]

  Fill, quantity=vReg.o3, method=profile, $
    profileValues= [ 200mb:0.2ppmv, 100mb:0.5ppmv, 0.1mb:1ppmv, 0.046mb:0ppmv ]
  Fill, quantity=vReg.o3_HR, method=profile, $
    profileValues=[ 383mb:0, 316mb:0.03ppmv, 147mb:0.015ppmv, 100mb:0.10ppmv, $
    46mb:0.10ppmv, 22mb:0.20ppmv, 10mb:0.30ppmv, 1mb:0.10ppmv, 0.1mb:1.0ppmv, $
    0.046mb:0ppmv ]

  Fill, quantity=vReg.oh, method=profile, $
    profileValues=[ 100mb:10pptv, 1mb:10ppbv ], /logSpace

  Fill, quantity=vReg.temperature, method=profile, $
    profileValues=[ 1mb:1K ]
  Fill, quantity=vReg.temperature_hr, method=profile, $
    profileValues=[1.21mb:0.5K, 1mb:0.75K, 0.681mb:1K, 0.147mb:1K, 0.1mb:1.5K, 0.0464mb:8K]
  ;;Fill, quantity=vReg.temperature_hr, method=profile, $
  ;;  profileValues=[ 21.6mb:0.5K, 14.7mb:1K, 0.147mb:1K, 0.1mb:2K ]
  Fill, quantity=vReg.o2, method=profile, $
    profileValues=[ 1mb:1000ppmv ]

  ;; Horizontal
  Fill, quantity=hReg.totalextinctionR2, method=explicit,/spread,explicitValues=5.0e-4
  Fill, quantity=hReg.totalextinctionR3, method=explicit,/spread,explicitValues=0.5e-3
;; WVS
  Fill, quantity=hReg.totalextinctionv2R3, method=explicit,/spread,explicitValues=0.0

  Fill, quantity=hReg.extinctionR1A, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=hReg.extinctionR1B, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=hReg.extinctionR2, method=explicit,/spread,explicitValues=1.0e-4
  Fill, quantity=hReg.extinctionR3, method=explicit,/spread,explicitValues=1.0e-4
  Fill, quantity=hReg.extinctionv2R3, method=explicit,/spread,explicitValues=1.0e-4

  Fill, quantity=hReg.baselineR1A, method=profile, profileValues=[100mb:0K, 68mb:2K ]
  Fill, quantity=hReg.baselineR1B, method=profile, profileValues=[100mb:0K, 68mb:2K ]
  Fill, quantity=hReg.baselineR2, method=profile, profileValues=[100mb:0K, 68mb:2K ]
  Fill, quantity=hReg.baselineR3, method=profile, profileValues=[100mb:0K, 68mb:2K ]
  Fill, quantity=hReg.baselineR4, method=profile, profileValues=[100mb:0K, 68mb:2K ]
  Fill, quantity=hReg.baselineR5H, method=profile, profileValues=[100mb:0K, 68mb:2K ]
  Fill, quantity=hReg.baselineR5V, method=profile, profileValues=[100mb:0K, 68mb:2K ]

  Fill, quantity=hReg.baselineFineR1A, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR1B, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR2,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR3,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR4,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR5H, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR5V, method=profile, profileValues=[121mb:0K, 100mb:5K ]

  Fill, quantity=hReg.bro, method=profile, $
    profileValues= [ 1mb:0.3ppbv ]
  Fill, quantity=hReg.ch3cn, method=profile, $
    profileValues= [ 146mb:500pptv, 100mb:30pptv, 1mb:30pptv, 0.68mb:0pptv ]
  Fill, quantity=hReg.clo, method=profile, $
    profileValues= [  1mb:0.1ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3cl, method=profile, $
    profileValues= [  1mb:0.1ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3oh, method=profile, $
    profileValues= [  1mb:5ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3ch2oh, method=profile, $
    profileValues= [  1mb:5ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3coch3, method=profile, $
    profileValues= [  1mb:0.05ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.co, method=profile, profileValues= $
     [ 100mb:15ppbv,  46mb:5ppbv, 10mb:5ppbv,   3mb: 15ppbv, 1mb:50ppbv, 0.3mb:150ppbv, 0.1mb:0.5ppmv, $
       0.03mb: 1.5ppmv, 0.01mb:3ppmv, 0.003mb:5ppmv, 0.001mb: 5ppmv ]
  Fill, quantity=hReg.co_hr, method=profile, profileValues= $
     [ 100mb:15ppbv,  46mb:5ppbv, 10mb:5ppbv,   3mb: 15ppbv, 1mb:50ppbv, 0.3mb:150ppbv, 0.1mb:0.5ppmv, $
       0.03mb: 1.5ppmv, 0.01mb:3ppmv, 0.003mb:5ppmv, 0.001mb: 5ppmv ]

  Fill, quantity=hReg.h2o, method=profile, $
     profileValues=[ 147mb:0ppmv, 121mb:2ppmv, 100mb:0.3ppmv, 10mb:0.3ppmv, 1mb:0.4ppmv, 0.1mb:3ppmv, $
     0.00215mb:1ppmv, 0.001mb:0.5ppmv, 0.00046mb:0.5ppmv  ], logSpace=false

  Fill, quantity=hReg.h2o_HR, method=profile, $
     profileValues=[ 147mb:0ppmv, 121mb:2ppmv, 100mb:0.3ppmv, 10mb:0.3ppmv, 1mb:0.4ppmv, 0.1mb:3ppmv, $
     0.00215mb:1ppmv, 0.001mb:0.5ppmv, 0.00046mb:0.5ppmv  ], logSpace=false
; values used for v3.3
  Fill, quantity=hReg.RHiVmr, method=profile, profileValues= [ $
        316mb:2.0, 68mb:2.0, 0.147mb:0.2,0.1mb:0.0]
; I would like to have this turned off completely
  Fill, quantity=hReg.RHiVmr, method=profile, profileValues= [ $
        1000mb:0.0, 0.00001mb:0.0]

  Fill, quantity=hReg.hcl, method=profile, $
    profileValues= [ 0.1mb:0.3ppbv, 0.046mb:0ppbv ]
  Fill, quantity=hReg.hcn, method=profile, $
    profileValues= [ 1mb:20pptv, 0.1mb:0pptv ]
  Fill, quantity=hReg.hno3, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=hReg.ho2, method=profile, $
    profileValues=[ 32mb:50pptv, 10mb:50pptv, 3.2mb:100pptv, 1mb:50pptv, 0.32mb:500pptv, 0.15mb:1000pptv ], /logSpace
  Fill, quantity=hReg.hocl, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=hReg.n2o, method=profile, $
    profileValues= [ 1mb:10ppbv, 0.1mb:0ppbv ]

   Fill, quantity=hReg.o3, method=profile, $
     profileValues= [ 146mb:30ppbv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ]
   Fill, quantity=hReg.o3_HR, method=profile, $
     profileValues= [ 383mb:0ppmv, 316mb:0.03ppmv, 215mb:0.03ppmv, 147mb:0.01ppmv, $
     10mb:0.03ppmv, 1mb:0.1ppmv, 0.68mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0.3ppmv, 0.01mb:1ppmv]

  Fill, quantity=hReg.oh, method=profile, $
    profileValues=[ 100mb:10pptv, 1mb:10ppbv ], /logSpace
  
  Fill, quantity=hReg.temperature, method=profile, $
    profileValues=[ 1mb:1K ]
  Fill, quantity=hReg.temperature_hr, method=profile, $
    profileValues=[ 1mb:1K ]

  Fill, quantity=hReg.refGPH, method=explicit, explicitValues=10m, /spread

end Fill

; Make certain MIF-based extinctions are defined
begin Fill
  Fill, quantity=apriori.TotalExtinctionV2R3, $
    sourceQuantity=apriori.TotalExtinctionR3, method=vector, $
    /interpolate, /ignoreTemplate
end Fill

; mjs and bill want different mesosphere values for o3 and co
begin Fill
  Fill, quantity=aprioriPrecision.co,   method=profile, $
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 31mb : 0.12ppmv, $
    10mb : 0.2ppmv, 3.1mb : 0.35ppmv, 1mb : 0.7ppmv, 0.31mb : 2ppmv, $
    0.1mb : 5ppmv, 0.01mb : 20ppmv,  0.001mb : 40ppmv, 0.00046mb : 50ppmv ]
  Fill, quantity=aprioriPrecision.co_hr,   method=profile, $
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 31mb : 0.12ppmv, $
    10mb : 0.2ppmv, 3.1mb : 0.35ppmv, 1mb : 0.7ppmv, 0.31mb : 2ppmv, $
    0.1mb : 5ppmv, 0.01mb : 20ppmv,  0.001mb : 40ppmv, 0.00046mb : 50ppmv ]

    Fill, quantity=aprioriPrecision.o3, method=profile, $
      profileValues = [ 316mb : 500ppbv, 100mb:2ppmv, 46mb : 4 ppmv, $
      0.1mb:4ppmv, 0.022mb:7ppmv, 0.00046mb:10ppmv  ] 
    Fill, quantity=aprioriPrecision.o3_hr, method=profile, $
      profileValues = [ 316mb : 500ppbv, 100mb:2ppmv, 46mb : 4 ppmv, $
      0.1mb:4ppmv, 0.022mb:7ppmv, 0.00046mb:10ppmv  ] 
end Fill

!include(writeapriori.l2cf)
!divert(-1)
;$Log: fillapriori.l2cf,v $
;Revision 1.167  2019/11/08 18:18:25  pwagner
;Changes needed for test SA-01 103
;
;Revision 1.166  2019/10/31 18:03:34  pwagner
;Changed to satisfy requirements of v5.00 SA-01-102
;
;Revision 1.165  2017/12/15 18:27:25  mmadatya
;Added geoHeight as new quantity template
;
;Revision 1.164  2016/01/05 00:42:25  pwagner
;MagneticFieldGrid may be defined
;
;Revision 1.163  2015/05/19 22:43:16  pwagner
;Cant Fill fieldAzimuth, ct. if MagneticFieldOnHeightGrid
;
;Revision 1.162  2015/04/30 17:30:03  pwagner
;Sense of flagMagneticFieldOnHeightGrid was reversed; fixed
;
;Revision 1.161  2015/04/29 18:20:45  pwagner
;Restored partial backward compatibility
;
;Revision 1.160  2015/03/27 18:00:52  pwagner
;Preparing for new magneticField
;
;Revision 1.159  2014/06/03 22:17:10  pwagner
;May destroy mergedTemperature after use to conservee memory
;
;Revision 1.158  2014/02/19 19:22:38  pwagner
;Increase methanol precision to 5ppbv
;
;Revision 1.157  2013/11/20 00:54:40  pwagner
;Comment-out a lot of debugging dumps
;
;Revision 1.156  2013/10/29 18:18:27  pwagner
;Now scale aprioriPrecision.oh automatically
;
;Revision 1.155  2013/10/15 17:43:23  pwagner
;Separates OH lowbounds into day, night values
;
;Revision 1.154  2013/05/28 20:35:58  pwagner
;Brought up-to-date with recent tests in v4.00 series BA-01
;
;Revision 1.153  2013/04/11 16:35:34  pwagner
;Replaced 4 degree phiWindows with 5 profiles
;
;Revision 1.152  2013/03/13 19:36:47  pwagner
;Use writeapriori.l2cf
;
;Revision 1.151  2012/10/09 00:32:43  pwagner
;Consistent with new use force field
;
;Revision 1.150  2012/05/15 22:36:04  pwagner
;No longer using flagUseOperationalTemperature
;
;Revision 1.149  2012/05/02 16:48:18  pwagner
;Use flags to Ignore instead of Use CClimatology, Meteorology
;
;Revision 1.148  2012/04/13 21:56:14  wgread
;increased high bound for extinction and better apriori for mifextinction-wgr
;
;Revision 1.147  2012/03/07 18:24:50  pwagner
;Restore lower bound on RHiVmr from r1.143
;
;Revision 1.146  2012/02/24 18:36:20  wgread
;wgr--removed retrieverstate etc.
;
;Revision 1.145  2012/02/22 23:54:51  wgread
;wgr--added low and high bounds for mif extincitons
;
;Revision 1.144  2012/02/22 00:08:49  wgread
;wgr--added mif extinction
;
;Revision 1.143  2010/03/31 18:18:52  pwagner
;Continued horizontal smoothing of Co down to 100mb
;
;Revision 1.142  2010/02/10 00:46:54  pwagner
;Tightened smoothing on RHi, H2O; hreg=vreg for H2O now
;
;Revision 1.141  2009/07/28 20:08:17  pwagner
;Tightened RHi smoothing, raised its high bound to 2000
;
;Revision 1.140  2009/06/23 17:33:43  pwagner
;Does not automatically set top of HCl
;
;Revision 1.139  2009/05/06 00:12:23  pwagner
;Scaled h2o smoothing params by 16 from 0.1mb to 0.001mb
;
;Revision 1.138  2009/05/05 17:35:37  pwagner
;Set the top of HCl to 3ppbv consistent with test H190
;
;Revision 1.137  2009/04/30 20:12:19  pwagner
;Removed last /dontMask from H2O to RHi conversions
;
;Revision 1.136  2009/04/01 23:18:54  pwagner
;New values consistent with tests beginning with H134
;
;Revision 1.135  2009/01/28 17:58:59  pwagner
;Changed quantity name of hires ozone
;
;Revision 1.134  2008/10/07 18:12:29  pwagner
;Added O3_R3
;
;Revision 1.133  2008/08/22 17:16:31  pwagner
;Reduced smoothing of water vapor at 0.1mb
;
;Revision 1.132  2008/06/06 21:05:50  michael
;added fill method uncompressradiance
;
;Revision 1.131  2008/05/27 16:59:49  pwagner
;Added new methyl molecules
;
;Revision 1.130  2008/03/20 18:34:20  pwagner
;Consistent with what we use beginning with v2.22
;
;Revision 1.129  2006/10/26 19:30:02  lambert
;vReg.HCl set to 1ppbv
;
;Revision 1.128  2006/10/10 20:14:39  lambert
;changes to aprioriprecision.n2o and vReg.temperature_hr
;
;Revision 1.127  2006/10/04 16:49:25  pwagner
;Hi-res a priori GPH written to DGG file
;
;Revision 1.126  2006/09/29 21:26:02  bill
;fixed error in vrag.h2o_hr and made some small adjustments to it
;
;Revision 1.125  2006/09/26 23:41:21  bill
;set high bound for rhivmrsngl=110
;
;Revision 1.124  2006/09/22 22:23:08  bill
;made smoothing for h2o and h2o_hr consistent
;
;Revision 1.123  2006/08/03 05:06:55  lambert
;corrected typo in apriori precision for CO
;
;Revision 1.122  2006/08/03 00:52:03  lambert
;updated vreg.HCN and apriori precisions for HCl and CO
;
;Revision 1.121  2006/07/28 23:34:46  dwu
;change co, o3, and hno3 apriori precisions
;
;Revision 1.120  2006/07/27 01:06:41  lambert
;changed vReg.hclfillapriori.l2cf
;
;Revision 1.119  2006/07/27 01:00:21  lambert
;changed vReg.hclfillapriori.l2cf
;
;Revision 1.118  2006/07/22 01:24:07  lambert
;updated HO2 vReg and hReg
;
;Revision 1.117  2006/07/21 23:49:56  lambert
;changed CO and BrO apriori and hReg/vReg
;
;Revision 1.116  2006/07/18 22:30:31  lambert
;modified aprioriPrecision.CO and vReg.
;
;Revision 1.115  2006/07/15 00:15:54  lambert
;modified aprioriPrecision.CO and vReg.
;
;Revision 1.114  2006/07/11 17:05:40  lambert
;reset vreg.temperature_hr=0.5K
;
;Revision 1.113  2006/07/07 00:02:36  bill
;initial stab at H2O_HR smoothing
;
;Revision 1.112  2006/06/29 23:34:10  lambert
;changed vReg and hReg for totalextinction species
;
;Revision 1.111  2006/06/29 23:04:42  lambert
;output HiRes quantities Temperature_HR and H2O_HR
;
;Revision 1.110  2006/06/14 23:02:32  lambert
;set aprioriPrecision.so2 = 10 ppbv
;
;Revision 1.109  2006/06/02 23:46:37  lambert
;explicitValues require a space before the minus sign
;
;Revision 1.108  2006/06/02 22:44:05  bill
;put low stop limits for totalextinction and oh
;
;Revision 1.107  2006/05/25 18:28:41  bill
;put GMAO into temperature_hr apriori
;
;Revision 1.106  2006/05/19 17:39:13  dwu
;change RHiVmr upper and lower bounds
;
;Revision 1.105  2006/05/17 17:00:10  dwu
;add aprioriPrecision for o3_hr and co_hr
;
;Revision 1.104  2006/05/16 22:27:36  bill
;some smoothing changes for t and h2o
;
;Revision 1.103  2006/05/12 23:24:19  pwagner
;Can directwrite a priori quantities to dgg files
;
;Revision 1.102  2006/05/12 19:31:10  lambert
;corrected apriori.totalextinctionr3 and aprioriPrecision.totalextinctionr3 values
;
!divert!dnl
@


1.167
log
@Changes needed for test SA-01 103
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.166 2019/10/31 18:03:34 pwagner Exp $
a232 4
  ;; Adjust tropospheric HCN per HCP message 2013 May 16
  Fill, quantity=apriori.hcn, method=explicit, explicitValues=0.22 ppbv, $
    height=[1000 mb : 100 mb], /spread
  
d811 3
@


1.166
log
@Changed to satisfy requirements of v5.00 SA-01-102
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.165 2017/12/15 18:27:25 mmadatya Exp $
a249 8
  Fill, quantity=aprioriPrecision.co,   method=profile, $
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 31mb : 0.12ppmv, $
    10mb : 0.2ppmv, 3.1mb : 0.35ppmv, 1mb : 0.7ppmv, 0.31mb : 2ppmv, $
    0.1mb : 5ppmv, 0.01mb : 10ppmv,  0.001mb : 20ppmv ]
  Fill, quantity=aprioriPrecision.co_hr,   method=profile, $
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 31mb : 0.12ppmv, $
    10mb : 0.2ppmv, 3.1mb : 0.35ppmv, 1mb : 0.7ppmv, 0.31mb : 2ppmv, $
    0.1mb : 5ppmv, 0.01mb : 10ppmv,  0.001mb : 20ppmv ]
d798 1
a798 1
    0.1mb : 5ppmv, 0.01mb : 20ppmv,  0.001mb : 40ppmv ]
d802 1
a802 1
    0.1mb : 5ppmv, 0.01mb : 20ppmv,  0.001mb : 40ppmv ]
d815 3
@


1.165
log
@Added geoHeight as new quantity template
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.164 2016/01/05 00:42:25 pwagner Exp $
d277 2
a278 1
    profileValues = [ 316mb : 500ppbv, 100mb:2ppmv, 46mb : 4 ppmv ]
d328 2
a329 1
      215mb : 300ppmv, 147mb : 20ppmv, 100mb : 6.0ppmv ]
d743 2
a744 2
    [ 100mb:15ppbv,  46mb:5ppbv, 10mb:5ppbv,   3mb: 15ppbv, 1mb:50ppbv, 0.3mb: 150ppbv, 0.1mb:0.5ppmv, $
      0.03mb: 1.5ppmv, 0.01mb:5ppmv, 0.003mb:15ppmv, 0.001mb: 50ppmv ]
d746 2
a747 2
    [ 100mb:15ppbv,  46mb:5ppbv, 10mb:5ppbv,  3mb: 15ppbv, 1mb:50ppbv, 0.3mb: 150ppbv, 0.1mb:0.5ppmv, $
      0.03mb: 1.5ppmv, 0.01mb:5ppmv, 0.003mb:15ppmv, 0.001mb: 50ppmv ]
d751 1
a751 1
     0.046mb:0ppmv ], logSpace=false
d755 1
a755 1
     0.046mb:0ppmv ], logSpace=false
d776 5
a780 5
  Fill, quantity=hReg.o3, method=profile, $
    profileValues= [ 146mb:30ppbv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ]
  Fill, quantity=hReg.o3_HR, method=profile, $
    profileValues= [ 383mb:0ppmv, 316mb:0.03ppmv, 215mb:0.03ppmv, 147mb:0.01ppmv, $
    10mb:0.03ppmv, 1mb:0.1ppmv, 0.68mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ]
d801 19
d823 3
@


1.164
log
@MagneticFieldGrid may be defined
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.163 2015/05/19 22:43:16 pwagner Exp $
d191 21
d802 3
@


1.163
log
@Cant Fill fieldAzimuth, ct. if MagneticFieldOnHeightGrid
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.162 2015/04/30 17:30:03 pwagner Exp $
d196 5
a200 2
!ifdef(flagMagneticFieldOnHeightGrid,{!dnl
  Fill, quantity=apriori.magneticField, method=magneticModel, $
d202 1
a202 7
  ;;;Fill, quantity=apriori.fieldAzimuth, method=rotateField, $
  ;;;  fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  ;;;Fill, quantity=apriori.fieldElevation, method=rotateField, $
  ;;;  fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  ;;;Fill, quantity=apriori.fieldStrength, method=rotateField, $
  ;;;  fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  },{
d204 1
a204 1
    GPHquantity=apriori.gph
d210 1
a210 2
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  })
d781 3
@


1.162
log
@Sense of flagMagneticFieldOnHeightGrid was reversed; fixed
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.161 2015/04/29 18:20:45 pwagner Exp $
d199 6
a204 6
  Fill, quantity=apriori.fieldAzimuth, method=rotateField, $
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  Fill, quantity=apriori.fieldElevation, method=rotateField, $
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
  Fill, quantity=apriori.fieldStrength, method=rotateField, $
    fieldECR=apriori.magneticField, ecrToFOV=apriori.ecrToFOV
d785 3
@


1.161
log
@Restored partial backward compatibility
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.160 2015/03/27 18:00:52 pwagner Exp $
d198 1
a198 1
    GPHquantity=apriori.gph
d207 1
a207 1
    scVelECR=apriori.scVelECR, geocAltitudeQuantity=apriori.tngtGeocAltGHz
d785 3
@


1.160
log
@Preparing for new magneticField
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.159 2014/06/03 22:17:10 pwagner Exp $
d198 1
a198 1
    scVelECR=apriori.scVelECR, geocAltitudeQuantity=apriori.tngtGeocAltGHz
d785 3
@


1.159
log
@May destroy mergedTemperature after use to conservee memory
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.158 2014/02/19 19:22:38 pwagner Exp $
d196 1
d198 1
a198 1
    GPHquantity=apriori.gph
d205 10
d785 3
@


1.158
log
@Increase methanol precision to 5ppbv
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.157 2013/11/20 00:54:40 pwagner Exp $
d127 1
d774 3
@


1.157
log
@Comment-out a lot of debugging dumps
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.156 2013/10/29 18:18:27 pwagner Exp $
d216 1
a216 1
  Fill, quantity=aprioriPrecision.ch3oh,method=explicit, /spread, explicitValues= 1 ppbv
d773 3
@


1.156
log
@Now scale aprioriPrecision.oh automatically
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.155 2013/10/15 17:43:23 pwagner Exp $
d39 2
a40 2
  Dump, text='Before setting top of HCl to 3ppbv'
  Dump, details=2, quantity=apriori.hcl
d47 2
a48 2
  Dump, text='After setting top of HCl to 3ppbv'
  Dump, details=2, quantity=apriori.hcl
d533 2
a534 2
  Dump, text='Solar zenith angles (0 is directly overhead)'
  Dump, details=2, quantity=lowBound.oh
d545 2
a546 2
  Dump, text='day time values'
  Dump, details=2, quantity=lowBound.oh
d557 2
a558 2
  Dump, text='night time values'
  Dump, details=2, quantity=tempVectorState.oh
d564 2
a565 2
  Dump, text='Separating OH low bound into day and night values'
  Dump, details=2, quantity=lowBound.oh
d773 3
@


1.155
log
@Separates OH lowbounds into day, night values
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.154 2013/05/28 20:35:58 pwagner Exp $
a77 5
;   Fill, quantity=apriori.totalextinctionr3,method=profile, profileValues = $
;      [ 1000mb: 0.01, 681mb:0.01, 464mb : 0.008, 316mb : 0.004, $
;      215mb : 0.001, 147mb : 0.0005, 100mb : 0.0003, 68mb:0.0002, $
;      46mb: 0.0001, 32mb:7.0e-5,22mb:4.0e-5,15mb:9.3e-6, $
;      10mb:2.7e-6,0.00001mb:1.0e-7]
d252 4
a304 3
  ;   Fill, quantity=aprioriPrecision.o3_hr, method=profile,$
  ;     profileValues=[ 500hPa:0.05ppmv, 316hPa:0.1ppmv, 215hPa:0.1ppmv, $
  ; 	147hPa:0.2ppmv, 46hPa:0.5ppmv, 22hPa:1.5ppmv] 
a324 4
;      [ 1000mb: 0.0001, 681mb:0.0001, 464mb : 0.0001, 316mb : 0.0001, $
;      215mb : 0.0001, 147mb : 0.0001, 100mb : 0.0001, 68mb:9.0e-5, $
;      46mb: 3.8e-5, 32mb:2.0e-5,22mb:9.2e-6,15mb:1.9e-6,10mb:1.0e-6, $
;      0.00001mb:1.0e-6]
a335 4
;      [ 1000mb: 0.004, 681mb:0.004, 464mb : 0.004, 316mb : 0.004, $
;      215mb : 0.004, 147mb : 0.004, 100mb : 0.0008, 68mb:0.0005, $
;      46mb: 0.0002, 32mb:0.0001,22mb:0.0001,15mb:4.0e-5,10mb:7.0e-6, $
;      0.00001mb:1.0e-6]
d773 3
@


1.154
log
@Brought up-to-date with recent tests in v4.00 series BA-01
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.148 2012/04/13 21:56:14 wgread Exp $
d540 38
d785 3
@


1.153
log
@Replaced 4 degree phiWindows with 5 profiles
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.152 2013/03/13 19:36:47 pwagner Exp $
d185 1
a185 1
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=5 profiles})
d194 1
a194 1
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=5 profiles})
d208 4
d222 1
d339 3
a341 6
   Fill, quantity=aprioriPrecision.totalextinctionv2r3,method=profile, $
        profileValues = $
     [ 1000mb: 1.0E-7, 681mb:0.0005, 464mb : 0.001, 316mb : 0.001, $
      215mb : 0.0006, 147mb : 0.0002, 100mb : 0.0001, 68mb:0.0001, $
      46mb: 7.0e-5, 32mb:4.0e-5,22mb:2.0e-5,15mb:5.0e-6,10mb:2.0e-6, $
      0.00001mb:1.0e-6]
d417 1
a417 1
  Fill, quantity=lowBound.oh, method=explicit, explicitValues= -20pptv, /spread
a437 1

d439 1
a439 1
        explicitValues= -0.01, /spread
d443 1
a443 1
        explicitValues= -0.01, /spread
d447 1
a447 1
        explicitValues= -0.01, /spread
d451 1
a451 1
        explicitValues= -0.01, /spread
d455 1
a455 1
        explicitValues= -0.01, /spread
d459 1
a459 1
        explicitValues= -0.01, /spread
d466 1
a466 1
        explicitValues=100.0, /spread
d470 1
a470 1
        explicitValues=100.0, /spread
d474 1
a474 1
        explicitValues=100.0, /spread
d478 1
a478 1
        explicitValues=100.0, /spread
d482 1
a482 1
        explicitValues=100.0, /spread
d486 1
a486 1
        explicitValues=100.0, /spread
d491 1
a491 1
        explicitValues= -0.01, /spread
d495 1
a495 1
        explicitValues= -0.01, /spread
d499 1
a499 1
        explicitValues= -0.01, /spread
d503 1
a503 1
        explicitValues= -0.01, /spread
d507 1
a507 1
        explicitValues= -0.01, /spread
d511 1
a511 1
        explicitValues= -0.01, /spread
d518 1
a518 1
        explicitValues=100.0, /spread
d522 1
a522 1
        explicitValues=100.0, /spread
d526 1
a526 1
        explicitValues=100.0, /spread
d530 1
a530 1
        explicitValues=100.0, /spread
d534 1
a534 1
        explicitValues=100.0, /spread
d538 1
a538 1
        explicitValues=100.0, /spread
d556 2
a557 1
  Fill, quantity=vReg.totalextinctionv2R3, method=explicit,/spread,explicitValues=0.5e-3
d591 2
d646 2
a647 1
  Fill, quantity=hReg.totalextinctionv2R3, method=explicit,/spread,explicitValues=0.5e-3
d681 2
d699 1
a699 1

d702 3
d736 8
a744 1

d747 3
@


1.152
log
@Use writeapriori.l2cf
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.151 2012/10/09 00:32:43 pwagner Exp $
d185 1
a185 1
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
d194 1
a194 1
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
d730 3
@


1.151
log
@Consistent with new use force field
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.150 2012/05/15 22:36:04 pwagner Exp $
d726 1
a727 33
  ;; This is for the case where we wish to store the a priori quantities
  ;; in the dgg files
  !define(LabelOneAPQuantity,{!dnl
!ifelse($1,{Temperature}, {
  Label, quantity=aPriori.$1_HR, label='$1-APriori'
  Label, quantity=aPrioriPrecision.$1_HR, label='$1-APrioriPrecision'},
$1,{GPH}, {
  Label, quantity=aPriori.$1_HR, label='$1-APriori'
  Label, quantity=aPrioriPrecision.$1_HR, label='$1-APrioriPrecision'},
$1,{H2O}, {
  Label, quantity=aPriori.$1_HR, label='$1-APriori'
  Label, quantity=aPrioriPrecision.$1_HR, label='$1-APrioriPrecision'},
{
  Label, quantity=aPriori.$1, label='$1-APriori'
  Label, quantity=aPrioriPrecision.$1, label='$1-APrioriPrecision'})
})
  !define(DirectWriteOneAPQuantity,{, $
!ifelse($1,{Temperature},
   {  source=aPriori.$1_HR, precision=aPrioriPrecision.$1_HR}, 
   $1,{GPH}, 
   {  source=aPriori.$1_HR, precision=aPrioriPrecision.$1_HR},
   $1,{H2O}, 
   {  source=aPriori.$1_HR, precision=aPrioriPrecision.$1_HR},
   {  source=aPriori.$1, precision=aPrioriPrecision.$1})})
  
  !ifdef(flagWriteAPrioriToDGG,{
begin Join
  !forall(LabelOneAPQuantity,!allStandardProducts)
  DirectWrite, hdfVersion=!hdfVersion, $
  type=l2dgg !forall(DirectWriteOneAPQuantity,!allStandardProducts)
  
end Join
  })
d730 3
@


1.150
log
@No longer using flagUseOperationalTemperature
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.149 2012/05/02 16:48:18 pwagner Exp $
d67 1
a67 1
        /interpolate,/force
d269 1
a269 1
        /force
d762 3
@


1.149
log
@Use flags to Ignore instead of Use CClimatology, Meteorology
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.148 2012/04/13 21:56:14 wgread Exp $
d130 1
a130 1
  !ifdef(flagUseOperationalTemperature,{Fill, quantity=apriori.temperature_hr,$
d762 3
@


1.148
log
@increased high bound for extinction and better apriori for mifextinction-wgr
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.147 2012/03/07 18:24:50 pwagner Exp $
d27 1
a27 2
  ;; Now we're only going to do this if we have climatological data to
  ;; fill with.
d29 1
a29 1
  !ifdef(flagGotClimatology,{
d51 1
a51 1
  !ifdef(flagUseOperationalTemperature,{Fill, quantity=apriori.temperature, $
d762 3
@


1.147
log
@Restore lower bound on RHiVmr from r1.143
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.146 2012/02/24 18:36:20 wgread Exp $
d79 6
d89 2
a90 1
      10mb:2.7e-6,0.00001mb:1.0e-7]
d439 1
a439 1
        explicitValues=1.0e-7, /spread
d443 1
a443 1
        explicitValues=1.0e-7, /spread
d447 1
a447 1
        explicitValues=1.0e-7, /spread
d451 1
a451 1
        explicitValues=1.0e-7, /spread
d455 1
a455 1
        explicitValues=1.0e-7, /spread
d459 1
a459 1
        explicitValues=1.0e-7, /spread
d466 1
a466 1
        explicitValues=0.1, /spread
d470 1
a470 1
        explicitValues=0.1, /spread
d474 1
a474 1
        explicitValues=0.1, /spread
d478 1
a478 1
        explicitValues=0.1, /spread
d482 1
a482 1
        explicitValues=0.1, /spread
d486 1
a486 1
        explicitValues=0.1, /spread
d491 1
a491 1
        explicitValues=1.0e-7, /spread
d495 1
a495 1
        explicitValues=1.0e-7, /spread
d499 1
a499 1
        explicitValues=1.0e-7, /spread
d503 1
a503 1
        explicitValues=1.0e-7, /spread
d507 1
a507 1
        explicitValues=1.0e-7, /spread
d511 1
a511 1
        explicitValues=1.0e-7, /spread
d518 1
a518 1
        explicitValues=0.1, /spread
d522 1
a522 1
        explicitValues=0.1, /spread
d526 1
a526 1
        explicitValues=0.1, /spread
d530 1
a530 1
        explicitValues=0.1, /spread
d534 1
a534 1
        explicitValues=0.1, /spread
d538 1
a538 1
        explicitValues=0.1, /spread
d589 1
a589 1
    profileValues= [ 1mb:0.1ppbv, 0.68mb:0ppbv ]
d676 1
a676 1
    profileValues= [  1mb:0.05ppbv, 0.68:0pptv ]
d763 3
@


1.146
log
@wgr--removed retrieverstate etc.
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.145 2012/02/22 23:54:51 wgread Exp $
d421 1
a421 1
   Fill, quantity=lowBound.RHiVmr,  method=profile, profileValues=[316mb:2.0,215mb: 0.0001]
d756 3
@


1.145
log
@wgr--added low and high bounds for mif extincitons
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.144 2012/02/22 00:08:49 wgread Exp $
a20 3
  aprioriMIFExtinction: Vector, template=retrieverStateTemplate
  aprioriMIFExtinctionPrecision: Vector, template=retrieverStateTemplate

a720 96
begin Fill
; do this more clever with a MACRO at a later time

  transfer, source=apriori, destination=aprioriMIFExtinction
  transfer, source=aprioriPrecision, destination=aprioriMIFExtinctionPrecision

  fill, quantity=aprioriMIFExtinction.MIFExtinctionR1A, $
    sourceQuantity=apriori.extinctionR1A, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R1A, $
    sourceQuantity=apriori.extinctionV2R1A, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionR1B, $
    sourceQuantity=apriori.extinctionR1B, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R1B, $
    sourceQuantity=apriori.extinctionV2R1B, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionR2, $
    sourceQuantity=apriori.extinctionR2, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R2, $
    sourceQuantity=apriori.extinctionV2R2, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionR3, $
    sourceQuantity=apriori.extinctionR3, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R3, $
    sourceQuantity=apriori.extinctionV2R3, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionR4, $
    sourceQuantity=apriori.extinctionR4, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R4, $
    sourceQuantity=apriori.extinctionV2R4, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionR5V, $
    sourceQuantity=apriori.extinctionR5V, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R5V, $
    sourceQuantity=apriori.extinctionV2R5V, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionR5H, $
    sourceQuantity=apriori.extinctionR5H, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.MIFExtinctionV2R5H, $
    sourceQuantity=apriori.extinctionV2R5H, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force

  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR1A, $
    sourceQuantity=apriori.extinctionR1A, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R1A, $
    sourceQuantity=apriori.extinctionV2R1A, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR1B, $
    sourceQuantity=apriori.extinctionR1B, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R1B, $
    sourceQuantity=apriori.extinctionV2R1B, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR2, $
    sourceQuantity=apriori.extinctionR2, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R2, $
    sourceQuantity=apriori.extinctionV2R2, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR3, $
    sourceQuantity=apriori.extinctionR3, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R3, $
    sourceQuantity=apriori.extinctionV2R3, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR4, $
    sourceQuantity=apriori.extinctionR4, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R4, $
    sourceQuantity=apriori.extinctionV2R4, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR5V, $
    sourceQuantity=apriori.extinctionR5V, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R5V, $
    sourceQuantity=apriori.extinctionV2R5V, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionR5H, $
    sourceQuantity=apriori.extinctionR5H, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force
  fill, quantity=aprioriMIFExtinction.totalMIFExtinctionV2R5H, $
    sourceQuantity=apriori.extinctionV2R5H, $
    method=vector, ptanQuantity=apriori.ptanGHz, /interpolate, /force

end Fill



d756 3
@


1.144
log
@wgr--added mif extinction
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.143 2010/03/31 18:18:52 pwagner Exp $
d438 4
d454 4
d463 4
d479 57
d855 3
@


1.143
log
@Continued horizontal smoothing of Co down to 100mb
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.142 2010/02/10 00:46:54 pwagner Exp $
d20 4
d424 1
a424 1
   Fill, quantity=lowBound.RHiVmr, method=explicit, explicitValues=0.00001, /spread
d552 2
a553 1
    46mb:0.10ppmv, 22mb:0.20ppmv, 10mb:0.30ppmv, 1mb:0.10ppmv, 0.1mb:1.0ppmv, 0.046mb:0ppmv ]
d655 96
d786 3
@


1.142
log
@Tightened smoothing on RHi, H2O; hreg=vreg for H2O now
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.141 2009/07/28 20:08:17 pwagner Exp $
d602 1
a602 1
    [ 10mb:5ppbv,  3mb: 15ppbv, 1mb:50ppbv, 0.3mb: 150ppbv, 0.1mb:0.5ppmv, $
d605 1
a605 1
    [ 10mb:5ppbv,  3mb: 15ppbv, 1mb:50ppbv, 0.3mb: 150ppbv, 0.1mb:0.5ppmv, $
d607 1
d685 3
@


1.141
log
@Tightened RHi smoothing, raised its high bound to 2000
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.140 2009/06/23 17:33:43 pwagner Exp $
d523 2
a524 1
	0.1mb:0.3ppmv, 0.001mb:0ppmv ], logSpace=false
d527 1
a527 1
      100mb:0.5ppmv, 83mb:0.3ppmv, 1mb:0.6ppmv, 0.1mb:10ppmv, 0.001mb:0ppmv ], $
d608 2
a609 2
    profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 1mb:0.3ppmv, 0.1mb:5ppmv, 0.046mb:0ppmv ], $
    logSpace=false
d612 2
a613 1
     profileValues=[ 147mb:0ppmv, 121mb:2ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ], logSpace=false
d616 1
a616 1
        316mb:20.0, 68mb:20.0, 0.147mb:2.0,0.1mb:0.0]
d684 3
@


1.140
log
@Does not automatically set top of HCl
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 1.139 2009/05/06 00:12:23 pwagner Exp $
d421 1
a421 1
   Fill, quantity=highBound.RHiVmr, method=explicit, explicitValues=1000, /spread
d529 1
a529 1
                    316mb:20.0, 215mb:20.0, 147mb:20.0]
d614 1
a614 1
        316mb:40.0, 215mb:30.0, 147mb:20.0, 100mb:20.0]
d682 3
@


1.139
log
@Scaled h2o smoothing params by 16 from 0.1mb to 0.001mb
@
text
@d1 2
a2 1
;; $Id: fillapriori.l2cf,v 1.138 2009/05/05 17:35:37 pwagner Exp $
d7 1
d37 4
d47 3
d215 3
a217 1
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 10mb : 0.2ppmv, 1mb : 0.7ppmv, 0.1mb : 5ppmv, 0.01mb : 10ppmv,  0.001mb : 20ppmv ]
d219 3
a221 1
    profileValues= [ 464mb : 500ppbv, 316mb : 1ppmv, 100mb : 1ppmv, 0.001mb : 100ppmv ]
a265 3
  Fill, quantity=aprioriPrecision.rhivmr,sourcequantity=aprioriPrecision.rhi,$
        method = vector,/interpolate, /force
  Subset, quantity=aprioriPrecision.rhivmr, height=[681mb:147mb], mask=fill
a267 1
  Subset, quantity=aprioriPrecision.rhivmr, mask=fill, /reset
d290 2
a291 1
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.046mb:0ppmv ]
d421 1
a421 1
   Fill, quantity=highBound.RHiVmr, method=explicit, explicitValues=110, /spread
d516 2
a517 1
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.046mb:0ppmv ] 
d519 2
a520 1
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.046mb:0ppmv ] 
d529 1
a529 1
        681mb:10.0, 316mb:10.0, 215mb:10.0, 147mb:10.0]
d601 2
a602 1
    [ 10mb:10ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.0068mb:0ppmv ] 
d604 2
a605 1
    [ 10mb:10ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.0068mb:0ppmv ] 
d613 3
d680 1
d682 3
d796 1
@


1.138
log
@Set the top of HCl to 3ppbv consistent with test H190
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.137 2009/04/30 20:12:19 pwagner Exp $
d514 1
a514 1
      100mb:0.5ppmv, 83mb:0.3ppmv, 0.1mb:0.6ppmv, 0.001mb:0ppmv ], $
d593 2
a594 1
    profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ], logSpace=false
d664 3
@


1.137
log
@Removed last /dontMask from H2O to RHi conversions
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.136 2009/04/01 23:18:54 pwagner Exp $
d35 6
d663 3
@


1.136
log
@New values consistent with tests beginning with H134
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.133 2008/08/22 17:16:31 pwagner Exp $
d239 1
a239 1
    method=RHIFromH2O, /dontMask
d657 3
@


1.135
log
@Changed quantity name of hires ozone
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.134 2008/10/07 18:12:29 pwagner Exp $
d54 2
d277 4
a280 3
  Fill, quantity=aprioriPrecision.o3_hr, method=profile,$
    profileValues=[ 500hPa:0.05ppmv, 316hPa:0.1ppmv, 215hPa:0.1ppmv, $
	147hPa:0.2ppmv, 46hPa:0.5ppmv, 22hPa:1.5ppmv] 
d285 1
d287 3
d291 1
d307 8
a314 6
;      [ 1000mb: 0.006, 681mb:0.009, 464mb : 0.009, 316mb : 0.006, $
;      215mb : 0.001, 147mb : 0.0006, 100mb : 0.0003, 68mb:0.0001, $
;      46mb: 7.0e-5, 32mb:4.0e-5,22mb:2.0e-5,15mb:5.0e-6,10mb:2.0e-6, $
;      0.00001mb:1.0e-6]
      [ 1000mb: 1.0E-7, 681mb:0.0005, 464mb : 0.0005, 316mb : 0.0005, $
      215mb : 0.0005, 147mb : 0.0002, 100mb : 0.0001, 68mb:0.0001, $
d422 4
d439 4
d463 1
d469 1
d528 2
a529 3
    profileValues=[ 10mb:0.2ppmv ]
  Fill, quantity=vReg.o3_HR, method=profile, $
    profileValues=[ 10mb:0.2ppmv ]
d537 3
a539 1
    profileValues=[ 21.6mb:0.5K, 14.7mb:1K, 0.147mb:1K, 0.1mb:2K ]
d546 1
d552 1
d608 2
a609 3
    profileValues= [ 10mb:0.2ppmv ]
  Fill, quantity=hReg.o3_HR, method=profile, $
    profileValues= [ 10mb:0.2ppmv ]
d657 3
@


1.134
log
@Added O3_R3
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.133 2008/08/22 17:16:31 pwagner Exp $
d257 1
a257 1
  !interpolateToHiRes(aprioriPrecision.o3_r3)
d432 2
a433 2
  !interpolateToHiRes(lowBound.o3_r3)
  !interpolateToHiRes(highBound.o3_r3)
d509 1
a509 1
  Fill, quantity=vReg.o3_r3, method=profile, $
d586 1
a586 1
  Fill, quantity=hReg.o3_r3, method=profile, $
d635 3
@


1.133
log
@Reduced smoothing of water vapor at 0.1mb
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.132 2008/06/06 21:05:50 michael Exp $
d257 1
d432 2
d509 2
d586 2
d635 3
@


1.132
log
@added fill method uncompressradiance
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.131 2008/05/27 16:59:49 pwagner Exp $
d485 1
a485 1
      100mb:0.5ppmv, 83mb:0.3ppmv, 0.1mb:0.3ppmv, 0.001mb:0ppmv ], $
d628 3
@


1.131
log
@Added new methyl molecules
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.130 2008/03/20 18:34:20 pwagner Exp $
d125 4
d130 1
a130 1
      explicitvalues=16 km,/spread
d628 3
@


1.130
log
@Consistent with what we use beginning with v2.22
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.129 2006/10/26 19:30:02 lambert Exp $
d187 4
d466 6
d544 6
d624 3
@


1.129
log
@vReg.HCl set to 1ppbv
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.128 2006/10/10 20:14:39 lambert Exp $
d367 1
a367 1
  Fill, quantity=lowBound.temperature, method=explicit, explicitValues=50K, /spread
d608 3
@


1.128
log
@changes to aprioriprecision.n2o and vReg.temperature_hr
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.127 2006/10/04 16:49:25 pwagner Exp $
d476 1
a476 1
    profileValues= [ 0.1mb:2.0ppbv, 0.046mb:0ppbv ]
d608 3
@


1.127
log
@Hi-res a priori GPH written to DGG file
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.126 2006/09/29 21:26:02 bill Exp $
d207 3
a209 1
  Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 0.2 ppmv
d499 1
a499 1
    profileValues=[ 1mb:0.5K ]
d608 3
@


1.126
log
@fixed error in vrag.h2o_hr and made some small adjustments to it
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.125 2006/09/26 23:41:21 bill Exp $
d578 3
d591 2
d606 3
@


1.125
log
@set high bound for rhivmrsngl=110
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.124 2006/09/22 22:23:08 bill Exp $
d259 1
a259 1
      215mb : 300ppmv, 147mb : 300ppmv, 100mb : 6.0ppmv ]
d468 1
a468 1
    [ 1000mb:50ppmv, 316mb:100ppmv,215mb:50ppmv, 147mb:5ppmv,121mb: 1ppmv, $
d540 1
a540 1
     profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ], logSpace=false
d601 3
@


1.124
log
@made smoothing for h2o and h2o_hr consistent
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.123 2006/08/03 05:06:55 lambert Exp $
d375 1
a375 1
  Fill, quantity=highBound.RHiVmrsngl, method=profile, profileValues=[100mb:200, 68mb:0.0001], /spread
d601 3
@


1.123
log
@corrected typo in apriori precision for CO
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.122 2006/08/03 00:52:03 lambert Exp $
d465 1
a465 1
    [ 1000mb:500ppmv, 300mb:50ppmv, 215mb:20ppmv, 121mb:2ppmv, 100mb:0.6ppmv, $
d601 3
@


1.122
log
@updated vreg.HCN and apriori precisions for HCl and CO
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.121 2006/07/28 23:34:46 dwu Exp $
d190 1
a190 1
    profileValues= [ 100mb : 0.5ppmv, 150mb : 0.1ppmv, 10mb : 0.2ppmv, 1mb : 0.7ppmv, 0.1mb : 5ppmv, 0.01mb : 10ppmv,  0.001mb : 20ppmv ]
d601 3
@


1.121
log
@change co, o3, and hno3 apriori precisions
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.120 2006/07/27 01:06:41 lambert Exp $
d190 1
a190 1
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 0.001mb : 3ppmv]
d196 2
a197 1
  Fill, quantity=aprioriPrecision.hcl,  method=explicit, /spread, explicitValues= 6 ppbv
d476 1
a476 1
    profileValues= [ 1mb:20pptv, 0.1mb:0pptv ]
d601 3
@


1.120
log
@changed vReg.hclfillapriori.l2cf
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.119 2006/07/27 01:00:21 lambert Exp $
d188 1
a188 2
  ;; 500 ppbv too small in meso/thermosphere, 1 ppmv needed for extremes
  ;; in troposphere.  Was 500 ppbv everywhere.
d190 1
a190 1
    profileValues= [ 464mb : 500ppbv, 316mb : 1ppmv, 100mb : 1ppmv, 0.001mb : 100ppmv ]
d199 2
a200 1
  Fill, quantity=aprioriPrecision.hno3, method=explicit, /spread, explicitValues= 10 ppbv
d209 1
a209 1
    profileValues = [ 464mb : 500ppbv, 316mb : 4 ppmv ]
d600 3
@


1.119
log
@changed vReg.hclfillapriori.l2cf
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.118 2006/07/22 01:24:07 lambert Exp $
d473 1
a473 1
    profileValues= [ 0.1mb:1.0ppbv, 0.046mb:0ppbv ]
d600 3
@


1.118
log
@updated HO2 vReg and hReg
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.117 2006/07/21 23:49:56 lambert Exp $
d473 1
a473 1
    profileValues= [ 0.1mb:0.3ppbv, 0.046mb:0ppbv ]
d600 3
@


1.117
log
@changed CO and BrO apriori and hReg/vReg
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.116 2006/07/18 22:30:31 lambert Exp $
d479 1
a479 1
    profileValues=[ 100mb:10pptv, 1mb:10ppbv ], /logSpace
d548 1
a548 1
    profileValues=[ 100mb:10pptv, 1mb:10ppbv ], /logSpace
d600 3
@


1.116
log
@modified aprioriPrecision.CO and vReg.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.115 2006/07/15 00:15:54 lambert Exp $
d183 1
a183 1
  Fill, quantity=aprioriPrecision.bro,  method=explicit, /spread, explicitValues= 10 ppbv
d190 4
a193 2
  Fill, quantity=aprioriPrecision.co, method=profile,$
    profileValues= [ 100mb:200ppbv, 50mb : 0.1ppmv, 0.001mb : 3ppmv ]
d260 2
a261 2
  Fill, quantity=aprioriPrecision.co_hr, method=profile,$
    profileValues= [ 100mb:200ppbv, 50mb : 0.1ppmv, 0.001mb : 3ppmv ]
d454 1
a454 1
    profileValues= [ 1mb:1ppbv, 0.68mb:0ppbv ]
d460 1
a460 1
    [ 10mb:100ppbv, 1mb:0.1ppmv, 0.1mb:0.1ppmv, 0.01mb:0.3ppmv  ]
d462 1
a462 2
    [ 10mb:100ppbv, 1mb:0.1ppmv, 0.1mb:0.1ppmv, 0.01mb:0.3ppmv]

d526 1
a526 1
    profileValues= [  1mb:3ppbv, 0.68mb:0ppbv ]
d532 1
a532 1
    [ 10mb:100ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.0068mb:0ppmv ]
d534 1
a534 2
    [ 10mb:100ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.0068mb:0ppmv ]

d600 3
@


1.115
log
@modified aprioriPrecision.CO and vReg.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.114 2006/07/11 17:05:40 lambert Exp $
d191 1
a191 3
    profileValues= [ 100mb:50ppbv, 50mb : 0.1ppmv, 0.001mb : 3ppmv ]
  ;Fill, quantity=aprioriPrecision.co,   method=profile, $
  ;  profileValues= [ 464mb : 500ppbv, 316mb : 1ppmv, 100mb : 1ppmv, 0.001mb : 100ppmv ]
d259 1
a259 1
    profileValues= [ 100mb:50ppbv, 50mb : 0.1ppmv, 0.001mb : 3ppmv ]
a456 2
;  Fill, quantity=vReg.co, method=profile, profileValues= $
;    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.046mb:0ppmv ]
d458 1
a458 1
    [ 10mb:40ppbv, 1mb:0.1ppmv, 0.1mb:0.1ppmv, 0.01mb:0.3ppmv  ]
d460 1
a460 1
    [ 10mb:40ppbv, 1mb:0.1ppmv, 0.1mb:0.1ppmv, 0.01mb:0.3ppmv]
d531 3
a533 1
    [ 10mb:10ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.0068mb:0ppmv ]
d600 3
@


1.114
log
@reset vreg.temperature_hr=0.5K
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.113 2006/07/07 00:02:36 bill Exp $
d190 4
a193 2
  Fill, quantity=aprioriPrecision.co,   method=profile, $
    profileValues= [ 464mb : 500ppbv, 316mb : 1ppmv, 100mb : 1ppmv, 0.001mb : 100ppmv ]
d459 2
d462 1
a462 1
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.046mb:0ppmv ]
d470 2
a471 2
    [ 1000mb:50ppmv, 300mb:100ppmv,215mb:50ppmv, 147mb:5ppmv,121mb: 1ppmv, $
      100mb:0.3ppmv, 83mb:0.3ppmv, 0.1mb:0.3ppmv, 0.001mb:0ppmv ], $
d602 3
@


1.113
log
@initial stab at H2O_HR smoothing
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.112 2006/06/29 23:34:10 lambert Exp $
d495 1
a495 1
    profileValues=[ 1mb:2.0K ]
d598 3
@


1.112
log
@changed vReg and hReg for totalextinction species
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.111 2006/06/29 23:04:42 lambert Exp $
d275 6
a280 2
;      [ 1000mb: 0.006, 681mb:0.006, 464mb : 0.006, 316mb : 0.006, $
;      215mb : 0.0026, 147mb : 0.0006, 100mb : 0.0003, 68mb:9.0e-5, $
a282 4
      [ 1000mb: 0.0001, 681mb:0.0001, 464mb : 0.0001, 316mb : 0.0001, $
      215mb : 0.0001, 147mb : 0.0001, 100mb : 0.0001, 68mb:9.0e-5, $
      46mb: 3.8e-5, 32mb:2.0e-5,22mb:9.2e-6,15mb:1.9e-6,10mb:1.0e-6, $
      0.00001mb:1.0e-6]
d369 1
d427 1
a427 1
  Fill, quantity=vReg.totalextinctionR2, method=explicit,/spread,explicitValues=0.5e-3
d466 3
a468 2
    [ 1000mb:50ppmv, 300mb:20ppmv, 215mb:10ppmv, 121mb: 1ppmv, 100mb:0.3ppmv, $
        83mb:0.3ppmv, 0.1mb:0.3ppmv, 0.001mb:0ppmv ], logSpace=false
d495 1
a495 1
    profileValues=[ 1mb:0.5K ]
d500 1
a500 1
  Fill, quantity=hReg.totalextinctionR2, method=explicit,/spread,explicitValues=0.5e-3
d598 3
@


1.111
log
@output HiRes quantities Temperature_HR and H2O_HR
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.110 2006/06/14 23:02:32 lambert Exp $
d426 2
a427 2
  Fill, quantity=vReg.totalextinctionR2, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=vReg.totalextinctionR3, method=explicit,/spread,explicitValues=1.0e-3
d498 2
a499 2
  Fill, quantity=hReg.totalextinctionR2, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=hReg.totalextinctionR3, method=explicit,/spread,explicitValues=1.0e-3
d596 3
@


1.110
log
@set aprioriPrecision.so2 = 10 ppbv
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.109 2006/06/02 23:46:37 lambert Exp $
d569 8
a576 1
  !define(WriteOneAPQuantity,{!dnl
d578 1
a578 1
  Label, quantity=aPrioriPrecision.$1, label='$1-aPrioriPrecision'
d581 5
a585 1
   source=aPriori.$1, precision=aPrioriPrecision.$1})
d589 1
a589 1
  !forall(WriteOneAPQuantity,!allStandardProducts)
d596 3
@


1.109
log
@explicitValues require a space before the minus sign
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.108 2006/06/02 22:44:05 bill Exp $
d212 1
a212 1
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 2 ppbv
d585 3
@


1.108
log
@put low stop limits for totalextinction and oh
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.107 2006/05/25 18:28:41 bill Exp $
d368 1
a368 1
  Fill, quantity=lowBound.oh, method=explicit, explicitValues=-20pptv, /spread
d403 1
a403 1
        explicitValues=-4.0e-4, /spread
d407 1
a407 1
        explicitValues=-4.0e-4, /spread
d411 1
a411 1
        explicitValues=-4.0e-4, /spread
d585 3
@


1.107
log
@put GMAO into temperature_hr apriori
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.106 2006/05/19 17:39:13 dwu Exp $
d368 2
d402 13
d585 3
@


1.106
log
@change RHiVmr upper and lower bounds
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.105 2006/05/17 17:00:10 dwu Exp $
d105 3
d570 3
@


1.105
log
@add aprioriPrecision for o3_hr and co_hr
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.104 2006/05/16 22:27:36 bill Exp $
d374 2
a375 2
   Fill, quantity=lowBound.RHiVmr, method=explicit, explicitValues=0.1, /spread
   Fill, quantity=highBound.RHiVmr, method=explicit, explicitValues=200, /spread
d567 3
@


1.104
log
@some smoothing changes for t and h2o
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.103 2006/05/12 23:24:19 pwagner Exp $
d99 1
d255 6
d440 2
d567 3
@


1.103
log
@Can directwrite a priori quantities to dgg files
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.102 2006/05/12 19:31:10 lambert Exp $
d265 6
a270 2
      [ 1000mb: 0.006, 681mb:0.006, 464mb : 0.006, 316mb : 0.006, $
      215mb : 0.0026, 147mb : 0.0006, 100mb : 0.0003, 68mb:9.0e-5, $
d275 4
d285 7
a291 3
      [ 1000mb: 0.004, 681mb:0.004, 464mb : 0.004, 316mb : 0.004, $
      215mb : 0.004, 147mb : 0.004, 100mb : 0.0008, 68mb:0.0005, $
      46mb: 0.0002, 32mb:0.0001,22mb:0.0001,15mb:4.0e-5,10mb:7.0e-6, $
d438 2
a439 1
    [ 1000mb:50ppmv, 300mb:20ppmv, 215mb:10ppmv, 121mb: 5ppmv, 100mb:0.6ppmv ], logSpace=false
d508 1
a508 3
     profileValues=[ 146mb:0ppmv, 100mb:0.6ppmv, 0.1mb:0.6ppmv, 0.001mb:0ppmv ], logSpace=false
;  Fill, quantity=hReg.h2o_HR, method=profile, profileValues= $
;    [ 1000:500ppmv, 215mb:50ppmv, 121mb:4ppmv, 100mb:1ppmv], logSpace=false
d534 1
a534 1
    profileValues=[ 1mb:3K ]
d558 3
@


1.102
log
@corrected apriori.totalextinctionr3 and aprioriPrecision.totalextinctionr3 values
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.101 2006/05/11 22:05:36 lambert Exp $
d528 22
a549 1
;$Log$
@


1.101
log
@update 1000mb and 680mb apriori.totalextinctionr3 values
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.100 2006/05/11 20:35:02 lambert Exp $
d62 1
a62 1
      [ 1000mb:1.0E-5, 681mb:1.0E-4, 464mb : 0.008, 316mb : 0.004, $
d271 1
a271 1
      [ 1000mb: 0.0001, 681mb:0.001, 464mb : 0.0005, 316mb : 0.0005, $
d528 1
@


1.100
log
@new apriori precisions for totalextinctionr3
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.99 2006/05/10 04:01:15 dwu Exp $
d62 1
a62 1
      [ 1000mb: 0.01, 681mb:0.01, 464mb : 0.008, 316mb : 0.004, $
@


1.99
log
@add vReg and hReg for totalextinctionR2 and R3
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.98 2006/05/08 21:32:39 bill Exp $
d271 2
a272 2
      [ 1000mb: 0.006, 681mb:0.009, 464mb : 0.009, 316mb : 0.006, $
      215mb : 0.001, 147mb : 0.0006, 100mb : 0.0003, 68mb:0.0001, $
@


1.98
log
@added mb baselines
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.97 2006/05/04 19:51:10 bill Exp $
d389 3
a395 4
  Fill, quantity=hReg.extinctionR1A, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=hReg.extinctionR1B, method=explicit,/spread,explicitValues=1.0e-3
  Fill, quantity=hReg.extinctionR2, method=explicit,/spread,explicitValues=1.0e-4
  Fill, quantity=hReg.extinctionR3, method=explicit,/spread,explicitValues=1.0e-4
d458 8
@


1.97
log
@added DACS and MAF baselines and totalextinction species
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.96 2006/04/27 23:33:18 lambert Exp $
d311 6
a316 4
  !define(fillBaselineMAFDACSApriori,{
  Fill, quantity=aprioriPrecision.baselineMAF$1, method=explicit, $
        explicitvalues = 5K, /spread !nl})
  !forall({fillBaselineMAFDACSApriori},!allDACS)
d324 2
@


1.96
log
@additions for RHi; some species apriori precision updates
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.95 2006/03/01 19:47:39 dwu Exp $
a46 2
  Fill, quantity=aprioriPrecision.rhi, h2oQuantity=aprioriPrecision.h2o, $
    temperatureQuantity=apriori.temperature, method=RHIFromH2O
d48 3
a50 2
  Fill, quantity=apriori.rhivmrsngl,sourcequantity=apriori.rhi, $
        method = vector,/interpolate,/force
d54 19
d201 1
d225 3
a227 5
  Subset, quantity=aprioriPrecision.rhivmrsngl, height=[147mb:147mb], $
          mask=fill
  Fill, quantity=aprioriPrecision.rhivmrsngl, method=explicit,  $
        explicitValues=100, /spread
  Subset, quantity=aprioriPrecision.rhivmrsngl, mask=fill, /reset
d259 1
a259 1
    method=explicit, /spread, explicitValues=1.0e-3!nl})
d262 33
a294 1
  ;; Now do the same for baseline
d307 9
d320 2
d342 2
a343 2
  Fill, quantity=lowBound.RHiVmrsngl, method=profile, profileValues=[147mb:2, 100mb:0.0001]
  Fill, quantity=highBound.RHiVmrsngl, method=explicit, explicitValues=200, /spread
d361 13
d385 16
a400 7
  Fill, quantity=vReg.baselineR1A, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR1B, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR2,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR3,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR4,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR5H, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR5V, method=profile, profileValues=[121mb:0K, 100mb:5K ]
d450 3
a452 1
    profileValues=[ 1mb:3K ]
d455 7
a461 7
  Fill, quantity=hReg.baselineR1A, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR1B, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR2,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR3,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR4,  method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR5H, method=profile, profileValues=[121mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR5V, method=profile, profileValues=[121mb:0K, 100mb:5K ]
d484 3
a486 1
    profileValues=[ 146mb:0ppmv, 100mb:1.0ppmv, 0.1mb:1.0ppmv, 0.046mb:0ppmv ], logSpace=false
@


1.95
log
@add RHiVmr high and low bounds
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.94 2006/03/01 19:45:47 dwu Exp $
d46 8
a53 7
    temperatureQuantity=apriori.temperature, method=RHIFromH2O, /dontMask

   Fill, quantity=apriori.RHiVmr, method=profile, $
     profileValues = [ 1000mb: 50, 500mb : 10, 150mb : 10 , 100mb : 0.0001 ]
   Fill, quantity=aprioriPrecision.RHiVmr, method=profile, profileValues = $
    [ 1000mb : 100, 464mb : 100, 316mb : 50, 215mb : 20, 147mb : 5, $
        100mb : 0.01, 68mb : 0.000001]
d186 2
a187 1
  Fill, quantity=aprioriPrecision.oh,   method=explicit, /spread, explicitValues= 10 ppbv
d203 15
d280 19
a298 1
  Fill, quantity=highBound.h2o, method=explicit, explicitValues=0.01, /spread
a299 2
  Fill, quantity=lowBound.RHiVmr, method=explicit, explicitValues=0.1, /spread
  Fill, quantity=highBound.RHiVmr, method=explicit, explicitValues=200, /spread
d338 2
a339 3
    [ 1000mb:20ppmv, 300:2ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ], logSpace=false
;   Fill, quantity=vReg.h2o_hr, method=profile, profileValues= $
;    [ 178mb:0ppmv, 146mb: 5.0ppmv, 121mb: 2.5ppmv, 100mb:1.5ppmv ], logSpace=false
d341 3
a343 2
   [ 178mb:0ppmv, 146mb: 2.0ppmv, 121mb: 1ppmv, 100mb:0.5ppmv ], logSpace=false

d347 1
a347 1
    profileValues= [ 1mb:100pptv, 0.68mb:0pptv ]
d349 1
a349 1
    profileValues= [ 1mb:10ppbv, 0.68mb:0ppbv ]
d355 1
a355 1
    profileValues= [ 1mb:30ppbv, 0.68mb:0ppbv ]
d358 1
a358 1
    profileValues= [ 0.1mb:1ppmv, 0.046mb:0ppmv ]
d360 1
a360 1
    profileValues=[ 10mb:0ppmv ]
d398 1
a398 2
;   Fill, quantity=hReg.h2o_HR, method=profile, $
;     profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ], logSpace=false
d405 1
a405 1
    profileValues= [ 1mb:100pptv, 0.68mb:0pptv ]
d413 1
a413 1
    profileValues= [ 1mb:10ppbv, 0.68mb:0ppbv ]
d418 1
a418 1
    profileValues= [ 10mb:0ppmv ]
@


1.94
log
@add RHiVmr
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.93 2004/11/17 00:25:24 livesey Exp $
d265 3
@


1.93
log
@Added the grouped baselines
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.92 2004/10/29 03:52:09 dwu Exp $
d48 6
@


1.92
log
@change so2 apriori err = 2 ppbv (Pinotubo=10 ppbv)
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.91 2004/08/16 23:43:09 livesey Exp $
d239 5
@


1.91
log
@Added minor frame baselines.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.90 2004/07/06 21:54:23 livesey Exp $
d181 1
a181 1
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 100 ppbv
@


1.90
log
@Different method for getting a priori precision for RHI.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.89 2004/06/25 23:50:16 livesey Exp $
d234 5
@


1.89
log
@Increased a priori error for BrO by a factor of 10, also loosened OH and
HO2 vertical and horizontal smoothing significantly as a result of some
explorations.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.88 2004/05/25 21:02:30 livesey Exp $
d189 5
a193 2
  Fill, quantity=aprioriPrecision.rhi, h2oQuantity=aprioriPrecision.h2o, $
    temperatureQuantity=apriori.temperature, method=RHIFromH2O, /dontMask
@


1.88
log
@New smoothing for CH3CN and fixed smoothing in HOCl.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.87 2004/05/17 23:23:58 livesey Exp $
d154 1
a154 1
  Fill, quantity=aprioriPrecision.bro,  method=explicit, /spread, explicitValues= 1 ppbv
d274 1
a274 1
    profileValues= [ 1mb:0.1ppbv, 0.68mb:0ppbv ]
d295 2
a296 3
  Fill, quantity=vReg.ho2,    method=profile, profileValues= $
    [ 1000mb:0.01ppbv, 100mb:0.05ppbv, 10mb:0.1ppbv, 1mb:0.5ppbv, $
      0.1mb:5ppbv, 0.01mb:100ppbv, 0.001mb:100ppbv ], /logspace
d307 2
a308 3
  Fill, quantity=vReg.oh,    method=profile, profileValues= $
    [ 1000mb:0.001ppbv, 100mb:0.001ppbv, 10mb:0.001ppbv, 1mb:0.02ppbv, $
      0.1mb:0.2ppbv, 0.01mb:100ppbv, 0.001mb:0.1ppbv ], /logspace
d333 1
a333 1
    profileValues= [  1mb:0.3ppbv, 0.68mb:0ppbv ]
d354 2
a355 3
  Fill, quantity=hReg.ho2,    method=profile, profileValues= $
    [ 1000mb:0.01ppbv, 100mb:0.05ppbv, 10mb:0.05ppbv, 1mb:0.2ppbv, $
    0.1mb:3ppbv, 0.01mb:15ppbv, 0.001mb:10ppbv ], /logspace
d366 2
a367 3
  Fill, quantity=hReg.oh,    method=profile, profileValues= $
    [ 1000mb:0.001ppbv, 100mb:0.0005ppbv, 10mb:0.0005ppbv, 1mb:0.005ppbv, $
    0.1mb:0.05ppbv, 0.01mb:0.1ppbv, 0.001mb:0.5ppbv ], /logspace
@


1.87
log
@Typo, rather an embarassing one in fact.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.86 2004/05/17 22:11:34 livesey Exp $
d276 1
a276 1
    profileValues= [ 1mb:30pptv, 0.68mb:0pptv ]
d299 1
a299 1
    profileValues= [ 1mb:0.3ppmv, 0.68mb:0ppmv ]
d337 1
a337 1
    profileValues= [  1mb:30pptv, 0.68mb:0pptv ]
d360 1
a360 1
    profileValues= [ 1mb:0.3ppmv, 0.68mb:0ppmv ]
@


1.86
log
@Put guards against extreme values of ptan.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.85 2004/04/01 17:18:05 livesey Exp $
d234 2
a235 2
  Fill, quantity=lowBound.ptanGHz, method=explicit, explicitValues= 20, /spread
  Fill, quantity=highBound.ptanGHz, method=explicit, explicitValues= -20, /spread
d237 2
a238 2
  Fill, quantity=lowBound.ptanTHz, method=explicit, explicitValues= 20, /spread
  Fill, quantity=highBound.ptanTHz, method=explicit, explicitValues= -20, /spread
@


1.85
log
@Changed the baseline smoothing range.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.84 2004/03/04 22:03:03 livesey Exp $
d233 6
@


1.84
log
@Changed smoothing cutoff (cosmetic only I hope).
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.83 2004/02/27 23:20:11 livesey Exp $
d251 15
a265 15
  Fill, quantity=vReg.baselineR1A, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR1B, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR2,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR3,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR4,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR5H, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineR5V, method=profile, profileValues=[146mb:0K, 100mb:5K ]

  Fill, quantity=vReg.baselineFineR1A, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR1B, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR2,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR3,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR4,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR5H, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=vReg.baselineFineR5V, method=profile, profileValues=[146mb:0K, 100mb:5K ]
d312 15
a326 15
  Fill, quantity=hReg.baselineR1A, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR1B, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR2,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR3,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR4,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR5H, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineR5V, method=profile, profileValues=[146mb:0K, 100mb:5K ]

  Fill, quantity=hReg.baselineFineR1A, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR1B, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR2,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR3,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR4,  method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR5H, method=profile, profileValues=[146mb:0K, 100mb:5K ]
  Fill, quantity=hReg.baselineFineR5V, method=profile, profileValues=[146mb:0K, 100mb:5K ]
@


1.83
log
@Reverted to previous smoothings for CO.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.82 2004/02/23 12:26:00 livesey Exp $
d274 1
a274 1
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.068mb:0ppmv ]
d277 1
a277 1
    [ 1000mb:20ppmv, 300:2ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ], logSpace=false
d284 1
a284 1
    profileValues= [ 0.1mb:0.3ppbv, 0.068mb:0ppbv ]
d298 1
a298 1
    profileValues= [ 0.1mb:1ppmv, 0.068mb:0ppmv ]
d338 1
a338 1
    profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ], logSpace=false
d340 1
a340 1
;     profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ], logSpace=false
d342 1
a342 1
    profileValues=[ 146mb:0ppmv, 100mb:1.0ppmv, 0.1mb:1.0ppmv, 0.068mb:0ppmv ], logSpace=false
d345 1
a345 1
    profileValues= [ 0.1mb:0.3ppbv, 0.068mb:0ppbv ]
d359 1
a359 1
    profileValues= [ 146mb:30ppbv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ]
@


1.82
log
@Put the temperature_hr smoothing back after more thought
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.81 2004/02/23 12:21:32 livesey Exp $
d274 1
a274 1
    [ 10mb:300ppbv, 1mb:3ppmv, 0.1mb:30ppmv, 0.068mb:0ppmv ]
d335 1
a335 1
    [ 10mb:100ppbv, 1mb:1ppmv, 0.1mb:10ppmv, 0.01mb:30ppmv, 0.0068mb:0ppmv ]
@


1.81
log
@More vertical smoothing for h2o_hr, temperature_hr, less horizontal for h2o_hr
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.80 2004/02/11 00:03:07 livesey Exp $
d309 1
a309 1
    profileValues=[ 1mb:1K ]
d370 1
a370 1
    profileValues=[ 1mb:1K ]
@


1.80
log
@Loosened the HCl a priori error bar.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.79 2004/02/10 01:33:53 livesey Exp $
d278 2
d281 1
a281 1
   [ 178mb:0ppmv, 146mb: 5.0ppmv, 121mb: 2.5ppmv, 100mb:1.5ppmv ], logSpace=false
d309 1
a309 1
    profileValues=[ 1mb:3K ]
d339 2
d342 1
a342 1
    profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ], logSpace=false
d370 1
a370 1
    profileValues=[ 1mb:3K ]
@


1.79
log
@Typo!
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.78 2004/02/10 01:32:24 livesey Exp $
d166 1
a166 1
  Fill, quantity=aprioriPrecision.hcl,  method=explicit, /spread, explicitValues= 3 ppbv
@


1.78
log
@Turned the h2o_hr horizontal smoothing down, back to earlier values.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.77 2004/02/07 00:47:54 livesey Exp $
d337 1
a337 1
  Fill, quantity=hReg.h2o_HR, method=profile, profileValues= $
@


1.77
log
@Removed loss terms and shaped exintctions, new smoothing for high
resolution case.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.76 2004/01/27 18:44:04 livesey Exp $
d338 1
a338 2
    [ 316mb:10ppmv, 215mb:1ppmv, 147mb:0.1ppmv, $
    100mb:0.05ppmv, 10mb:0.05ppmv, 1mb:0.3ppmv ], logSpace=false
@


1.76
log
@Loosened the H2O a priori precision for high resolution
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.75 2004/01/24 03:23:33 livesey Exp $
d215 2
a216 9
  Fill, quantity=aprioriPrecision.extinctionConstant$1, $
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShaped$1, $
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstant$1_HR, $
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShaped$1_HR, $
    method=explicit, /spread, explicitValues=1.0e-3!nl
  })
d279 1
a279 1
    [ 10mb:0ppmv ], logSpace=false
d307 1
a307 1
    profileValues=[ 10mb:0K ]
d337 3
a339 2
  Fill, quantity=hReg.h2o_HR, method=profile, $
    profileValues=[ 10mb:0ppmv ], logSpace=false
d367 1
a367 1
    profileValues=[ 10mb:0K ]
@


1.75
log
@Loosened up smoothing on CO for the moment.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.74 2004/01/20 23:43:21 dwu Exp $
a162 4
  ;; This is a new H2O apriori precision, tighter in the troposphere.
;   Fill, quantity=aprioriPrecision.h2o, method=profile, profileValues = $
;     [ 1000mb: 1000ppmv, 464mb : 1000ppmv, 316mb : 150ppmv, $
;       215mb : 30ppmv, 147mb : 3ppmv, 100mb : 3.0ppmv ]
d205 6
@


1.74
log
@assign values for baselineFine
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.73 2004/01/14 23:04:11 livesey Exp $
d279 1
a279 1
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.068mb:0ppmv ]
d338 1
a338 1
    [ 10mb:10ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.0068mb:0ppmv ]
@


1.73
log
@Updated the OH and HO2 smoothings per Marks values
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.72 2003/11/15 01:53:06 livesey Exp $
d231 6
d264 8
d322 8
@


1.72
log
@Turned off all the smoothing for high resolution species
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.71 2003/11/14 23:38:58 livesey Exp $
d175 1
a175 1
  Fill, quantity=aprioriPrecision.ho2,  method=explicit, /spread, explicitValues= 100 ppbv
d278 3
a280 1
  Fill, quantity=vReg.ho2, method=profile, profileValues= [ 100mb:10ppbv ]
d291 3
a293 1
  Fill, quantity=vReg.oh, method=profile, profileValues= [ 10mb:30pptv, 1mb:300pptv ]
d329 3
a331 1
  Fill, quantity=hReg.ho2, method=profile, profileValues= [ 100mb:10ppbv ]
d342 4
a345 2
  Fill, quantity=hReg.oh, method=profile, profileValues= [ 10mb:30pptv, 1mb:300pptv ]

@


1.71
log
@Turned temperature smoothing back on in mesosphere (at least for the
moment.)
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.70 2003/11/13 23:17:22 livesey Exp $
d270 1
a270 1
    [ 1000mb:80ppmv, 300:8ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ], logSpace=false
d287 1
a287 1
    profileValues=[ 147mb:0.1ppmv, 68mb:1ppmv, 0.68mb:0ppmv ]
d294 1
a294 1
    profileValues=[ 1mb:1K ]
d317 1
a317 1
    profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ], logSpace=false
d334 1
a334 1
    profileValues= [ 146mb:30ppbv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.068mb:0ppmv ]
d341 1
a341 1
    profileValues=[ 1mb:1K ]
@


1.70
log
@Changed the smoothing for high resolution ozone.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.69 2003/11/08 00:47:43 livesey Exp $
d292 1
a292 1
    profileValues=[ 1mb:1K, 0.68mb:0K ]
d294 1
a294 1
    profileValues=[ 1mb:1K, 0.68mb:0K ]
d339 1
a339 1
    profileValues=[ 1mb:1K, 0.68mb:0K ]
d341 1
a341 1
    profileValues=[ 1mb:1K, 0.68mb:0K ]
@


1.69
log
@New smoothing terms (main difference is cutting the smoothing off at a
selection of heights).
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.68 2003/11/06 23:26:38 livesey Exp $
d286 2
a287 1
  Fill, quantity=vReg.o3_HR, method=profile, profileValues=[ 0.1mb:1ppmv, 0.68mb:0ppmv ]
@


1.68
log
@Bug fix
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.67 2003/11/04 01:12:06 livesey Exp $
d246 3
d258 36
a293 31
  Fill, quantity=vReg.bro,   method=profile, profileValues= [ 100mb:0.1ppbv ]
  Fill, quantity=vReg.ch3cn, method=profile, profileValues= [ 100mb:30pptv ]
  Fill, quantity=vReg.clo,   method=profile, profileValues= [ 100mb:0.3ppbv ]
  Fill, quantity=vReg.co,    method=profile, profileValues= $
    [ 10mb:30ppbv, 1mb:300ppbv, 0.1mb:3ppmv, 0.01mb:10ppmv, 0.001mb:10ppmv ]

  Fill, quantity=vReg.h2o,   method=profile, profileValues= $
    [ 1000mb:20ppmv, 300:2ppmv, 100mb:0.3ppmv ], logSpace=false
  Fill, quantity=vReg.h2o_hr,   method=profile, profileValues= $
    [ 1000mb:80ppmv, 300:8ppmv, 100mb:0.3ppmv ], logSpace=false

  Fill, quantity=vReg.hcl,   method=profile, profileValues= [ 100mb:0.3ppbv ]
  Fill, quantity=vReg.hcn,   method=profile, profileValues= [ 100mb:100pptv ]
  Fill, quantity=vReg.hno3,  method=profile, profileValues= [ 100mb:10ppbv ]
  Fill, quantity=vReg.ho2,   method=profile, profileValues= [ 100mb:10ppbv ]
  Fill, quantity=vReg.hocl,  method=profile, profileValues= [ 100mb:0.3ppbv ]
  Fill, quantity=vReg.n2o,   method=profile, profileValues= [ 100mb:30ppbv ]

  Fill, quantity=vReg.o3,    method=profile, profileValues= [ 100mb:1ppmv ]
  Fill, quantity=vReg.o3_HR, method=profile, profileValues=[ 100mb:1ppmv ]

  Fill, quantity=vReg.oh,    method=profile, profileValues= [ 10mb:30pptv, 1mb:300pptv ]
  Fill, quantity=vReg.temperature, method=explicit, explicitValues=1K, /spread
  Fill, quantity=vReg.temperature_hr, method=explicit, explicitValues=1K, /spread

  !define(fillOneExtinctionShapedVReg,{!dnl
  Fill, quantity=vReg.extinctionShaped$1, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShaped$1_HR, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]!nl})
  !forall(fillOneExtinctionShapedVReg,!allRadiometers)
d304 8
a311 2
  Fill, quantity=hReg.temperature, method=explicit, explicitValues=1K, /spread
  Fill, quantity=hReg.temperature_HR, method=explicit, explicitValues= 1K, /spread
d313 4
a316 1
  Fill, quantity=hReg.refGPH, method=explicit, explicitValues=10m, /spread
d318 23
a340 5
  Fill, quantity=hReg.bro,   method=profile, profileValues= [ 100mb:0.1ppbv ]
  Fill, quantity=hReg.ch3cn, method=profile, profileValues= [ 100mb:30pptv ]
  Fill, quantity=hReg.clo,   method=profile, profileValues= [ 100mb:0.1ppbv ]
  Fill, quantity=hReg.co,    method=profile, profileValues= $
    [ 10mb:10ppbv, 1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.001mb:3ppmv ]
d342 1
a342 23
  Fill, quantity=hReg.h2o,   method=profile, profileValues= $
    [ 146mb:0ppmv, 100mb:0.3ppmv ], logSpace=false
  Fill, quantity=hReg.h2o_HR, method=profile, $
    profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ], logSpace=false

  Fill, quantity=hReg.hcl,   method=profile, profileValues= [ 100mb:0.3ppbv ]
  Fill, quantity=hReg.hcn,   method=profile, profileValues= [ 100mb:100pptv ]
  Fill, quantity=hReg.hno3,  method=profile, profileValues= [ 100mb:0.3ppbv ]
  Fill, quantity=hReg.ho2,   method=profile, profileValues= [ 100mb:10ppbv ]
  Fill, quantity=hReg.hocl,  method=profile, profileValues= [ 100mb:0.3ppbv ]
  Fill, quantity=hReg.n2o,   method=profile, profileValues= [ 100mb:10ppbv ]

  Fill, quantity=hReg.o3,    method=profile, profileValues= [ 146mb:30ppbv, 100mb:0.3ppmv ]
  Fill, quantity=hReg.o3_HR, method=profile, profileValues= [ 100mb:0.3ppmv ]

  Fill, quantity=hReg.oh,    method=profile, profileValues= [ 10mb:30pptv, 1mb:300pptv ]

  !define(fillOneExtinctionShapedHReg,{!dnl
  Fill, quantity=vReg.extinctionShaped$1, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShaped$1_HR, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]!nl})
  !forall(fillOneExtinctionShapedHReg,!allRadiometers)
@


1.67
log
@Changed H2O_HR smoothing a bit.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.66 2003/11/01 18:45:51 livesey Exp $
d52 1
a52 1
  }{
@


1.66
log
@Changes to support hi resolution
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.65 2003/10/15 11:48:37 mjf Exp $
d264 1
a264 1
    [ 1000mb:20ppmv, 300:2ppmv, 100mb:0.3ppmv ], logSpace=false
@


1.65
log
@apriori.tpPressure can be set explicitly.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.64 2003/10/11 01:36:32 livesey Exp $
d263 2
a264 2
  Fill, quantity=vReg.h2o_HR, method=profile, $
     profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ], logSpace=false
d278 1
@


1.64
log
@Made the h2o a priori looser
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.63 2003/08/26 20:13:07 livesey Exp $
d49 8
a56 3
  Fill, quantity=apriori.tpPressure, method=wmoTropopause, $
    temperatureQuantity=apriori.temperature, refGPHQuantity=apriori.refGPH, $
    internalVgrid=vGridWMO
@


1.63
log
@Changed a priori precision for h2o at and above 100hPa to 3.0 (had been
0.5, too tight, previously 5, perhaps too loose).
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.62 2003/08/14 20:26:24 livesey Exp $
d159 3
d163 2
a164 2
    [ 1000mb: 1000ppmv, 464mb : 1000ppmv, 316mb : 150ppmv, $
      215mb : 30ppmv, 147mb : 3ppmv, 100mb : 3.0ppmv ]
@


1.62
log
@Removed tropH2O
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.61 2003/08/14 16:17:49 dwu Exp $
d161 1
a161 1
      215mb : 30ppmv, 147mb : 3ppmv, 100mb : 0.5ppmv ]
@


1.61
log
@new aprioriPrecision.h2o
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.60 2003/08/13 01:30:22 dwu Exp $
a54 6
  ;; --------------------------------------------- trop H2O

  ;; Put H2O in trop h2o
  Fill, quantity=apriori.tropH2O, sourceQuantity=apriori.h2o, $
    method=vector, /interpolate

a68 2
  Fill, quantity=apriori.tropH2O_HR, method=gridded, sourceGrid=gridH2O
  !interpolateToHiRes(apriori.tropH2O_HR)
a187 4
  ;; Put H2O precision in trop h2o
  Fill, quantity=aprioriPrecision.tropH2O, sourceQuantity=aprioriPrecision.h2o, $
    method=vector, /interpolate

a193 1
  !interpolateToHiRes(aprioriPrecision.tropH2O_HR)
a227 2
  Fill, quantity=lowBound.tropH2O, method=explicit, explicitValues=0.1ppmv, /spread
  Fill, quantity=highBound.tropH2O, method=explicit, explicitValues=0.01, /spread
a232 2
  !interpolateToHiRes(lowBound.tropH2O_HR)
  !interpolateToHiRes(highBound.tropH2O_HR)
a301 2
  Fill, quantity=hReg.tropH2O, method=profile, $
    profileValues=[146mb:0ppmv, 100mb:0.03ppmv],logSpace=false
@


1.60
log
@add vReg.temeprature and change aprioriPrecision.h2o 215mb:20ppmv
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.59 2003/08/12 19:41:55 livesey Exp $
d169 1
a169 1
      215mb : 20ppmv, 147mb : 2ppmv, 100mb : 0.5ppmv ]
@


1.59
log
@Added smoothing for baselines at and above 100hPa
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.58 2003/08/12 00:51:30 dwu Exp $
d169 1
a169 1
      215mb : 10ppmv, 147mb : 2ppmv, 100mb : 0.5ppmv ]
d286 1
@


1.58
log
@change UTH aprioriPrecision
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.57 2003/08/11 23:54:57 dwu Exp $
d256 7
a262 4
  Fill, quantity=vReg.baselineR1A, method=explicit, explicitValues= 5 K, /spread
  Fill, quantity=vReg.baselineR2, method=explicit, explicitValues= 5 K, /spread
  Fill, quantity=vReg.temperature, method=explicit, explicitValues= 1 K, /spread
  Fill, quantity=vReg.temperature_HR, method=explicit, explicitValues= 1K, /spread
d295 8
@


1.57
log
@change H2O apriori uncertainty
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.56 2003/08/08 23:05:47 livesey Exp $
d169 1
a169 1
      215mb : 13ppmv, 147mb : 2ppmv, 100mb : 0.5ppmv ]
@


1.56
log
@Added the fieldStrength/azimuth/elevation filling.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.55 2003/08/06 20:41:23 dwu Exp $
d168 2
a169 2
    [ 1000mb: 10ppmv, 464mb : 1000ppmv, 316mb : 500ppmv, $
      215mb : 100ppmv, 147mb : 20ppmv, 100mb : 5.0ppmv ]
@


1.55
log
@change baseline apriori uncertainty
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.54 2003/06/09 17:39:39 livesey Exp $
d148 6
@


1.54
log
@Added 100hPa stuff
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.53 2003/05/26 06:33:48 livesey Exp $
d225 3
a227 2
  Fill, quantity=aprioriPrecision.baseline$1, method=explicit, /spread, $
    explicitValues=5K!nl})
d250 2
d262 1
a262 1
    [ 146mb:0ppmv, 100mb:0.3ppmv ], logSpace=false
@


1.53
log
@Typo fix
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.52 2003/05/10 22:21:38 livesey Exp $
d52 1
@


1.52
log
@Don't fill tpPressure if no climatology
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.51 2003/05/09 23:53:47 livesey Exp $
d95 1
a95 1
  !ifdef(glagPrecisionEstimates,{
@


1.51
log
@Now fills tropopopause pressure
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.50 2003/05/08 20:50:48 livesey Exp $
a46 1
  }) ;; End if flagGotClimatology
d52 1
@


1.50
log
@Got rid of !res
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.49 2003/05/07 20:54:12 livesey Exp $
d49 5
d297 2
@


1.49
log
@Various changes, and (hopefully) improvements
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.48 2003/05/06 20:27:30 livesey Exp $
d100 2
a101 2
    h2oQuantity=apriori.h2o!res, $
    temperatureQuantity=apriori.temperature!res, refract=false
d104 2
a105 2
    h2oQuantity=apriori.h2o!res, $
    temperatureQuantity=apriori.temperature!res, refract=false
d118 2
a119 2
    h2oQuantity=apriori.h2o!res, $
    temperatureQuantity=apriori.temperature!res, $
d127 2
a128 2
    h2oQuantity=apriori.h2o!res, $
    temperatureQuantity=apriori.temperature!res, $
@


1.48
log
@Fix typo
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.47 2003/05/03 21:59:44 livesey Exp $
d20 1
a20 1
;; ----------------------------------- Fill with climatology
d27 1
a27 1
  !ifdef(gotClimatology,{
d36 1
a36 1
  !ifdef(useMergedTemperature,{Fill, quantity=apriori.temperature, $
a39 2
end Fill
begin Retrieve
a40 2
end Retrieve
begin Fill
a41 2
end Fill
begin Retrieve
a42 2
end Retrieve
begin Fill
d47 1
a47 1
  }) ;; End if gotClimatology
d57 1
d60 1
a60 1
  !define(interpolateToHiRes,{Fill, quantity=$1, sourceQuantity=!trimHR($1),!dnl
d63 13
a75 14
  !ifdef(gotClimatology,{
    !ifdef(skipHiRes,{},{
      ;; Could write some fancy macros here to get the list as the
      ;; intersection of allClimatologicalSpecies and allHiResMolecules,
      ;; However, life is too short!
      !fillWithClimatologyHR(Temperature)
      !fillWithClimatologyHR(H2O)
      !fillWithClimatologyHR(O3)
      Fill, quantity=apriori.tropH2O_HR, method=gridded, sourceGrid=gridH2O
      !interpolateToHiRes(apriori.tropH2O_HR)
      ;; Get RHI_HR from RHI.  Not sure if this should really be from
      ;; H2O_HR and temperature_HR
      !interpolateToHiRes(apriori.RHI_HR)
    })}) ;; End if not skipHiRes and got climatology
d87 1
a87 1
  !ifdef(gotClimatology,{
d90 1
a90 1
  !ifdef(precisionEstimates,{
a110 1
  !ifdef(skipHiRes,{},{
a113 1
  }) ;; End if not skipHiRes
d115 1
a115 1
  !ifdef(skipHydrostatic,{},{
d125 1
a125 1
    !ifdef(strict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
d134 2
a135 2
    !ifdef(strict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
  }) ;; End if not skipHydrostatic
d137 1
a137 1
}) ;; End if gotClimatology
d139 5
a143 2
Fill, quantity=apriori.magneticField, method=magneticModel, $
  GPHquantity=apriori.gph
a144 10
;; initialize cldRad flag
  Fill, quantity=apriori.cldRadMin,  method=explicit, /spread, explicitValues= 0 K
  Fill, quantity=apriori.cldRadMax,  method=explicit, /spread, explicitValues= 0 K

end Fill

;; -------------------------------- Apriori precisions

begin Fill
  ;; Now we're going to fill the apriori errors up
d180 25
a209 1
  !ifdef(skipHiRes,{},{
d213 2
a214 1
    method=explicit, /spread, explicitValues=1.0e-3!nl})})
d218 4
a221 19
  !define(baselinePrecision, 5 K )
  Fill, quantity=aprioriPrecision.baselineR1A, method=explicit, /spread, $
    explicitValues= !baselinePrecision
  Fill, quantity=aprioriPrecision.baselineR1B, method=explicit, /spread, $
    explicitValues= !baselinePrecision
  Fill, quantity=aprioriPrecision.baselineR2, method=explicit, /spread, $
    explicitValues= !baselinePrecision
  Fill, quantity=aprioriPrecision.baselineR3, method=explicit, /spread, $
    explicitValues= !baselinePrecision
  Fill, quantity=aprioriPrecision.baselineR4, method=explicit, /spread, $
    explicitValues= !baselinePrecision
  Fill, quantity=aprioriPrecision.baselineR5H, method=explicit, /spread, $
    explicitValues= !baselinePrecision
  Fill, quantity=aprioriPrecision.baselineR5V, method=explicit, /spread, $
    explicitValues= !baselinePrecision

  ;; Convert H2O precision to RHI precision
  Fill, quantity=aprioriPrecision.rhi, h2oQuantity=aprioriPrecision.h2o, $
    temperatureQuantity=apriori.temperature, method=RHIFromH2O, /dontMask
d223 1
a223 3
  ;; Put H2O precision in trop h2o
  Fill, quantity=aprioriPrecision.tropH2O, sourceQuantity=aprioriPrecision.h2o, $
    method=vector, /interpolate
a224 18
  ;; This macro interpolates standard resolution quantities to the
  ;; hiRes equivalents. 
  !define(interpolateToHiRes,{Fill, quantity=$1, sourceQuantity=!trimHR($1),!dnl
     method=vector, /interpolate!nl})

  !ifdef(skipHiRes,{},{
    !interpolateToHiRes(aprioriPrecision.temperature_HR)
    !forall(interpolateToHiRes,!makelist(aprioriPrecision.,{},!allHiResMolecules))
    !interpolateToHiRes(aprioriPrecision.tropH2O_HR)
    ;; Get RHI_HR from RHI.  Not sure if this should really be from
    ;; H2O_HR and temperature_HR
    !interpolateToHiRes(aprioriPrecision.RHI_HR)
    ;; Get gph_HR from gph.  Not sure if this should really be from
    ;; temperature_HR
    !interpolateToHiRes(aprioriPrecision.gph_HR)
  }) ;; End if not skipHiRes

  ;; Setup the low and high bounds for stuff that needs them.
d233 6
a238 8
  !ifdef(skipHiRes,{},{
    !interpolateToHiRes(lowBound.temperature_HR)
    !interpolateToHiRes(highBound.temperature_HR)
    !interpolateToHiRes(lowBound.tropH2O_HR)
    !interpolateToHiRes(highBound.tropH2O_HR)
    !forall(interpolateToHiRes,!makelist(lowBound.,{},!allHiResMolecules))
    !forall(interpolateToHiRes,!makelist(highBound.,{},!allHiResMolecules))
  }) ;; End if not skipHiRes
d244 1
d246 29
a274 48
  Fill, quantity=vReg.bro,   method=profile, profileValues=[ 100mb:0.1ppbv ]
  Fill, quantity=vReg.ch3cn, method=profile, profileValues=[ 100mb:30pptv ]
  Fill, quantity=vReg.clo,   method=profile, profileValues=[ 100mb:0.3ppbv ]
  Fill, quantity=vReg.co,    method=profile, profileValues=[ 10mb:30ppbv, $
    1mb:300ppbv, 0.1mb:3ppmv, 0.01mb:10ppmv, 0.001mb:10ppmv ]
  Fill, quantity=vReg.h2o,   method=profile, profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ], $
    logSpace=false
  Fill, quantity=vReg.hcl,   method=profile, profileValues=[ 100mb:0.3ppbv ]
  Fill, quantity=vReg.hcn,   method=profile, profileValues=[ 100mb:100pptv ]
  Fill, quantity=vReg.hno3,  method=profile, profileValues=[ 100mb:10ppbv ]
  Fill, quantity=vReg.ho2,   method=profile, profileValues=[ 100mb:10ppbv ]
  Fill, quantity=vReg.hocl,  method=profile, profileValues=[ 100mb:0.3ppbv ]
  Fill, quantity=vReg.n2o,   method=profile, profileValues=[ 100mb:30ppbv ]
  Fill, quantity=vReg.o3,    method=profile, profileValues=[ 100mb:1ppmv ]
  Fill, quantity=vReg.oh,    method=profile, profileValues=[ 10mb:30pptv, 1mb:300pptv ]

  Fill, quantity=vReg.extinctionShapedR1A, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShapedR2, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShapedR3, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShapedR4, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShapedR5H, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=vReg.extinctionShapedR5V, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]

  !ifdef(skipHiRes,{},{
    Fill, quantity=vReg.temperature_HR, method=explicit, explicitValues= 1K, /spread
    Fill, quantity=vReg.o3_HR, method=profile, profileValues=[ 100mb:1ppmv ]
    Fill, quantity=vReg.h2o_HR, method=profile, $
      profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ], logSpace=false

    Fill, quantity=vReg.extinctionShapedR1A_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=vReg.extinctionShapedR2_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=vReg.extinctionShapedR3_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=vReg.extinctionShapedR4_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=vReg.extinctionShapedR5H_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=vReg.extinctionShapedR5V_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
  })
d278 2
d282 29
a310 48
  Fill, quantity=hReg.bro,   method=profile, profileValues=[ 100mb:0.1ppbv ]
  Fill, quantity=hReg.ch3cn, method=profile, profileValues=[ 100mb:30pptv ]
  Fill, quantity=hReg.clo,   method=profile, profileValues=[ 100mb:0.1ppbv ]
  Fill, quantity=hReg.co,    method=profile, profileValues=[ 10mb:10ppbv, $
    1mb:100ppbv, 0.1mb:1ppmv, 0.01mb:3ppmv, 0.001mb:3ppmv ]
  Fill, quantity=hReg.h2o,   method=profile, profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ], $
    logSpace=false
  Fill, quantity=hReg.hcl,   method=profile, profileValues=[ 100mb:0.3ppbv ]
  Fill, quantity=hReg.hcn,   method=profile, profileValues=[ 100mb:100pptv ]
  Fill, quantity=hReg.hno3,  method=profile, profileValues=[ 100mb:0.3ppbv ]
  Fill, quantity=hReg.ho2,   method=profile, profileValues=[ 100mb:10ppbv ]
  Fill, quantity=hReg.hocl,  method=profile, profileValues=[ 100mb:0.3ppbv ]
  Fill, quantity=hReg.n2o,   method=profile, profileValues=[ 100mb:10ppbv ]
  Fill, quantity=hReg.o3,    method=profile, profileValues=[ 146mb:30ppbv, 100mb:0.3ppmv ]
  Fill, quantity=hReg.oh,    method=profile, profileValues=[ 10mb:30pptv, 1mb:300pptv ]

  Fill, quantity=hReg.extinctionShapedR1A, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=hReg.extinctionShapedR2, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=hReg.extinctionShapedR3, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=hReg.extinctionShapedR4, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=hReg.extinctionShapedR5H, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]
  Fill, quantity=hReg.extinctionShapedR5V, method=profile, $
    profileValues=[ 100mb:1.0e-5 ]

  !ifdef(skipHiRes,{},{
    Fill, quantity=hReg.temperature_HR, method=explicit, explicitValues= 1K, /spread
    Fill, quantity=hReg.o3_HR, method=profile, profileValues=[ 100mb:0.3ppmv ]
    Fill, quantity=hReg.h2o_HR, method=profile, $
      profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ], logSpace=false

    Fill, quantity=hReg.extinctionShapedR1A_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=hReg.extinctionShapedR2_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=hReg.extinctionShapedR3_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=hReg.extinctionShapedR4_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=hReg.extinctionShapedR5H_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
    Fill, quantity=hReg.extinctionShapedR5V_HR, method=profile, $
      profileValues=[ 100mb:1.0e-5 ]
  })
@


1.47
log
@Added the ability to use mergedTemperature for apriori
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.46 2003/04/24 19:44:52 dwu Exp $
d36 1
a36 1
  !ifdef(usedMergedTemperature,{Fill, quantity=apriori.temperature, $
@


1.46
log
@add cldRadMin and cldRadMax
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.45 2003/04/04 01:19:26 livesey Exp $
d34 4
@


1.45
log
@Force h/v reg interpolations for h2o to be linear space because of
issues with using 0 to mean no smoothing.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.44 2003/04/01 21:02:55 livesey Exp $
d147 4
@


1.44
log
@Tightened up the 464hPa apriori error for CO and O3.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.43 2003/03/27 21:16:47 livesey Exp $
d271 2
a272 1
  Fill, quantity=vReg.h2o,   method=profile, profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ]
d298 2
a299 1
    Fill, quantity=vReg.h2o_HR, method=profile, profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ]
d324 2
a325 1
  Fill, quantity=hReg.h2o,   method=profile, profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ]
d351 2
a352 1
    Fill, quantity=hReg.h2o_HR, method=profile, profileValues=[ 146mb:0ppmv, 100mb:0.3ppmv ]
@


1.43
log
@Added hReg for high resolution extinctions
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.42 2003/03/25 21:18:52 livesey Exp $
d162 1
a162 1
    profileValues= [ 100mb : 1ppmv, 0.001mb : 100ppmv ]
d177 2
a178 1
  Fill, quantity=aprioriPrecision.o3,   method=explicit, /spread, explicitValues= 4 ppmv
@


1.42
log
@New approach to high resolution
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.41 2003/03/22 01:17:46 livesey Exp $
d348 13
@


1.41
log
@Moved trimHR into m4defs.  Added some high resolution extinction stuff
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.40 2003/03/01 02:11:32 livesey Exp $
d61 3
a63 3
  ;; This macro interpolates standard resolution quantities to the
  ;; hiRes equivalents. 
  !define(fillHiRes,{Fill, quantity=$1, sourceQuantity=!trimHR($1),!dnl
d66 14
a79 8
  !ifdef(skipHiRes,{},{
    !fillHiRes(apriori.temperature_HR)
    !forall(fillHiRes,!makelist(apriori.,{},!allHiResMolecules))
    !fillHiRes(apriori.tropH2O_HR)
    ;; Get RHI_HR from RHI.  Not sure if this should really be from
    ;; H2O_HR and temperature_HR
    !fillHiRes(apriori.RHI_HR)
  }) ;; End if not skipHiRes
d225 5
d231 3
a233 3
    !fillHiRes(aprioriPrecision.temperature_HR)
    !forall(fillHiRes,!makelist(aprioriPrecision.,{},!allHiResMolecules))
    !fillHiRes(aprioriPrecision.tropH2O_HR)
d236 1
a236 1
    !fillHiRes(aprioriPrecision.RHI_HR)
d239 1
a239 1
    !fillHiRes(aprioriPrecision.gph_HR)
d252 6
a257 6
    !fillHiRes(lowBound.temperature_HR)
    !fillHiRes(highBound.temperature_HR)
    !fillHiRes(lowBound.tropH2O_HR)
    !fillHiRes(highBound.tropH2O_HR)
    !forall(fillHiRes,!makelist(lowBound.,{},!allHiResMolecules))
    !forall(fillHiRes,!makelist(highBound.,{},!allHiResMolecules))
@


1.40
log
@More horizontal smoothing than Mark had for O3, (vertical and CO
unchanged).
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.39 2003/02/28 16:37:59 livesey Exp $
d62 1
a62 2
  ;; hiRes equivalents.  And a sub-macro to chop off {_HR}.
  !define(trimHR,{!substr($1,0,!eval(!len($1)-3))})
d186 6
a191 1
    method=explicit, /spread, explicitValues=1.0e-3})
d286 13
@


1.39
log
@Bug fix
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.38 2003/02/28 14:29:42 mjf Exp $
d300 1
a300 1
  Fill, quantity=hReg.o3,    method=profile, profileValues=[ 100mb:0.3ppmv ]
@


1.38
log
@Added hiRes regularisation (interpolate didn't seem to work).
Weakened CO and O3 regs.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.37 2003/02/27 00:39:38 livesey Exp $
d280 1
a280 1
    Fill, quantity=vReg.o3_HR, method=explicit, method=profile, profileValues=[ 100mb:1ppmv ]
@


1.37
log
@General tidy up and dead wood removal
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.36 2003/02/18 23:59:39 livesey Exp $
d253 2
a254 2
  Fill, quantity=hReg.co,    method=profile, profileValues=[ 316mb:5ppbv, $
    146mb:5ppbv, 1mb:100ppbv, 0.01mb:10ppmv ]
d262 1
a262 2
  Fill, quantity=vReg.o3,    method=profile, profileValues=[ 316mb:50ppbv, $
    146mb:50ppbv, 100mb:1ppmv ]
d278 6
d291 2
a292 2
  Fill, quantity=hReg.co,    method=profile, profileValues=[ 316mb:5ppbv, $
    146mb:5ppbv, 1mb:100ppbv, 0.01mb:10ppmv ]
d300 1
a300 2
  Fill, quantity=hReg.o3,    method=profile, profileValues=[ 316mb:10ppbv, $
    146mb:10ppbv, 100mb:0.3ppmv ]
d315 6
@


1.36
log
@Added strict1D
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.35 2003/01/31 00:10:03 dwu Exp $
d12 4
a15 1
  length: Vector, template=stateTemplate, /lengthScale
d51 1
a51 1
  })
d74 1
a74 1
  })
d94 1
a94 1
  })
d114 1
a114 1
  })
d136 1
a136 1
  })
d138 1
a138 1
})
d145 1
a145 1
;; -------------------------------- Apriori precisions and length scales
a182 27
  ;; Now we're going to fill the a priori length scales up
  !ifdef(standardLength,{},{!define(standardLength, 0 km)})

  Fill, quantity=length.bro,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.ch3cn,   method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.clo,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.co,      method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.h2o,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.hcl,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.hcn,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.hno3,    method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.ho2,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.hocl,    method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.n2o,     method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.o3,      method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.oh,      method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.so2,     method=explicit, /spread, explicitValues= !standardLength

  Fill, quantity=length.temperature, method=explicit, /spread, $
    explicitValues= !standardLength

  !ifdef(skipHiRes,{},{
    !fillHiRes(length.temperature_HR)
    !forall(fillHiRes,!makelist(length.,{},!allHiResMolecules))
    !fillHiRes(length.tropH2O_HR)
  })

a186 8
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantLinear$1, $
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedLinear$1, $
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantFull$1, $
    method=explicit, /spread, explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedFull$1, $
d225 1
a225 1
  })
d243 68
a310 1
  })
@


1.35
log
@change 1000mb H2O apriori to 4000ppmv
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.34 2003/01/27 17:02:22 dwu Exp $
d122 2
a123 1
    maxIterations=20
d131 2
a132 1
    maxIterations=20
@


1.34
log
@change aprioriPrecision.h2o
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.33 2003/01/22 07:09:32 livesey Exp $
d38 1
a38 1
  Fill, quantity=apriori.h2o, method=explicit, explicitValues=10000ppmv, /spread
@


1.33
log
@Added split full/linear extinctions
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.32 2003/01/14 23:49:05 livesey Exp $
d155 1
a155 1
    [ 464mb : 1000ppmv, 316mb : 500ppmv, $
@


1.32
log
@Dealt with magnetic field
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.31 2003/01/08 02:13:26 livesey Exp $
d205 14
a218 29
  Fill, quantity=aprioriPrecision.extinctionConstantR1A, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantR1B, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantR2, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantR3, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantR4, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantR5H, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionConstantR5V, method=explicit, /spread, $
    explicitValues=1.0e-3

  Fill, quantity=aprioriPrecision.extinctionShapedR1A, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedR1B, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedR2, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedR3, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedR4, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedR5H, method=explicit, /spread, $
    explicitValues=1.0e-3
  Fill, quantity=aprioriPrecision.extinctionShapedR5V, method=explicit, /spread, $
    explicitValues=1.0e-3
@


1.31
log
@New subset /reset stuff
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.30 2003/01/07 23:48:02 livesey Exp $
a102 1
  !ifdef(skipHydrostatic,{},{
d112 2
d134 3
@


1.30
log
@Added stuff to fix 1000hPa H2O
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.29 2002/12/16 15:57:41 mjf Exp $
d41 1
a41 1
  Subset, quantity=apriori.h2o, height=[1000mb:1.0e-6mb], mask=fill
@


1.29
log
@HiRes stuff, and removed some if(precisionEstimates) clauses.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.28 2002/11/22 12:42:00 mjf Exp $
d32 13
d141 2
a142 1
  Fill, quantity=aprioriPrecision.ch3cn,method=explicit, /spread, explicitValues= 2 ppbv; was 500 pptv
d144 3
d148 2
a149 3
    profileValues= [ 100 mb : 1 ppmv, 0.001 mb : 100 ppmv ]
    ; 500 ppbv too small in meso/thermosphere, 1 ppmv needed for extremes
    ; in troposphere.  Was 500 ppbv everywhere.
d151 2
a152 2
    [ 464mb : 10000ppmv, 316mb : 5000ppmv, $
      215mb : 1000ppmv, 147mb : 200ppmv, 100mb : 5.0ppmv ]
d154 2
a155 1
  Fill, quantity=aprioriPrecision.hcn,  method=explicit, /spread, explicitValues= 1 ppbv ; 0.2 ppbv is too small
d157 2
a158 1
  Fill, quantity=aprioriPrecision.ho2,  method=explicit, /spread, explicitValues= 100 ppbv ; 1 ppbv is too small
d160 3
a162 2
  Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 0.2 ppmv ; 0.2 ppmv is too small for the troposphere, but we don't
            ; have sensitivity there
d164 4
a167 2
  Fill, quantity=aprioriPrecision.oh,   method=explicit, /spread, explicitValues= 10 ppbv ; 1 ppbv is too small.  Better with a profile?
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 100 ppbv ; 100pptv is far too small
a200 32
  ;; Now do the same for extinction
;   !ifdef(precisionEstimates,{
;   Fill, quantity=aprioriPrecision.extinctionConstantR1A, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionConstantR1B, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionConstantR2, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionConstantR3, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionConstantR4, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionConstantR5H, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionConstantR5V, method=explicit, /spread, $
;     explicitValues=1.0e-5

;   Fill, quantity=aprioriPrecision.extinctionShapedR1A, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionShapedR1B, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionShapedR2, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionShapedR3, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionShapedR4, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionShapedR5H, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   Fill, quantity=aprioriPrecision.extinctionShapedR5V, method=explicit, /spread, $
;     explicitValues=1.0e-5
;   },{
a229 1
;   }) ;end !ifdef(precisionEstimates,
a232 17
;; Not sure what the baseline error is.  These values are from the SRD
;   !ifdef(precisionEstimates,{
;   Fill, quantity=aprioriPrecision.baselineR1A, method=explicit, /spread, $
;     explicitValues= 0.245 K
;   Fill, quantity=aprioriPrecision.baselineR1B, method=explicit, /spread, $
;     explicitValues= 0.245 K
;   Fill, quantity=aprioriPrecision.baselineR2, method=explicit, /spread, $
;     explicitValues= 0.653 K
;   Fill, quantity=aprioriPrecision.baselineR3, method=explicit, /spread, $
;     explicitValues= 0.653 K
;   Fill, quantity=aprioriPrecision.baselineR4, method=explicit, /spread, $
;     explicitValues= 1.96 K
;   Fill, quantity=aprioriPrecision.baselineR5H, method=explicit, /spread, $
;     explicitValues= 24.5 K
;   Fill, quantity=aprioriPrecision.baselineR5V, method=explicit, /spread, $
;     explicitValues= 24.5 K
;   },{
a246 1
;  })
@


1.28
log
@Interpolate standard quantities to hiRes.  Calculation of ptans (and
phitans) use the correct resolution temperature and H2O.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.27 2002/11/22 00:09:36 livesey Exp $
d37 6
d54 2
a55 1
    ;; Get RHI_HR from RHI_HR.  Not sure if this should really be from
a58 7

  ;; --------------------------------------------- trop H2O

  ;; Put H2O in trop h2o
  Fill, quantity=apriori.tropH2O, sourceQuantity=apriori.h2o, $
    method=vector, /interpolate

d128 1
a128 1
  Fill, quantity=aprioriPrecision.ch3cn,method=explicit, /spread, explicitValues= 500 pptv
d131 3
a133 2
    profileValues= [ 100 mb : 0.5 ppmv, 0.001 mb : 100 ppmv ]
    ; 500 ppbv too small in meso/thermosphere
d142 2
a143 1
  Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 0.2 ppmv ; 0.2 ppmv is too small for the troposphere
d151 1
a151 5

  !ifdef(skipHiRes,{},{
    !fillHiRes(aprioriPrecision.temperature_HR)
    !forall(fillHiRes,!makelist(aprioriPrecision.,{},!allHiResMolecules))
  })
d177 1
d181 31
d241 1
d286 12
d310 2
@


1.27
log
@Tigtened temperature a priori
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.26 2002/11/21 01:18:54 livesey Exp $
d37 18
d83 2
a84 2
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false
d87 2
a88 2
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false
d95 5
d102 2
a103 2
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, $
d110 2
a111 2
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, $
d149 6
d176 5
d263 7
@


1.26
log
@Wasn't filling aprioriPrecision.tropH2O or bounds for H2O
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.25 2002/11/20 19:48:59 mjf Exp $
d123 2
a124 1
  Fill, quantity=aprioriPrecision.temperature, method=explicit, /spread, explicitValues= 20 K
@


1.25
log
@Now unified PE and simulation a priori precisions.  These are changed
from the standard ones, which in some cases were too small.  Standard
length now 0 km: will be replaced by regularisation definitions.
Baseline needs input from Bob Jarnot: set to 5 K for all radiometers
now.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.24 2002/10/25 01:09:35 livesey Exp $
d212 8
d226 2
@


1.24
log
@Added upper bounds to TropH2O and generally bounds everywhere
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.23 2002/10/23 23:26:55 livesey Exp $
d54 6
a59 2
  !ifdef(precisionEstimates,{},{
  Fill, quantity=apriori.refGPH, method=explicit, explicitvalues=16 km,/spread
a103 19
  !ifdef(precisionEstimates,{
  Fill, quantity=aprioriPrecision.bro,  method=explicit, /spread, explicitValues= 1000 pptv
  Fill, quantity=aprioriPrecision.ch3cn,method=explicit, /spread, explicitValues= 1000 pptv
  Fill, quantity=aprioriPrecision.clo,  method=explicit, /spread, explicitValues= 4 ppbv
  Fill, quantity=aprioriPrecision.co,   method=explicit, /spread, explicitValues= 30000 ppmv
  Fill, quantity=aprioriPrecision.h2o,  method=explicit, /spread, explicitValues= 10000 ppmv
  Fill, quantity=aprioriPrecision.hcl,  method=explicit, /spread, explicitValues= 30 ppmv
  Fill, quantity=aprioriPrecision.hcn,  method=explicit, /spread, explicitValues= 30 ppbv
  Fill, quantity=aprioriPrecision.hno3, method=explicit, /spread, explicitValues= 3 ppmv
  Fill, quantity=aprioriPrecision.ho2,  method=explicit, /spread, explicitValues= 300 ppbv
  Fill, quantity=aprioriPrecision.hocl, method=explicit, /spread, explicitValues= 300 ppbv
  Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 10 ppmv
  Fill, quantity=aprioriPrecision.o3,   method=explicit, /spread, explicitValues= 30000 ppmv
  Fill, quantity=aprioriPrecision.oh,   method=explicit, /spread, explicitValues= 30 ppmv
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 1 ppmv

  Fill, quantity=aprioriPrecision.temperature,   method=explicit, /spread, explicitValues= 300 K
  Fill, quantity=aprioriPrecision.refGPH, method=explicit, /spread, explicitValues= 10 km
  },{
d107 6
a112 1
  Fill, quantity=aprioriPrecision.co,   method=explicit, /spread, explicitValues= 500 ppbv
d114 1
a114 1
  Fill, quantity=aprioriPrecision.hcn,  method=explicit, /spread, explicitValues= 0.2 ppbv
d116 1
a116 1
  Fill, quantity=aprioriPrecision.ho2,  method=explicit, /spread, explicitValues= 1 ppbv
d118 1
a118 1
  Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 0.2 ppmv
d120 2
a121 2
  Fill, quantity=aprioriPrecision.oh,   method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 100 pptv
d125 2
a126 5
  Fill, quantity=aprioriPrecision.h2o, method=profile, profileValues = $
    [ 464mb : 10000ppmv, 316mb : 5000ppmv, $
      215mb : 1000ppmv, 147mb : 200ppmv, 100mb : 5.0ppmv ]

  })
a127 6
  ;; Now we're going to fill the a priori length scales up
  !ifdef(precisionEstimates,{
  !ifdef(standardLength,{},{!define(standardLength, 2.67 km)})
  },{
  !ifdef(standardLength,{},{!define(standardLength, 5 km)})
  })
d179 17
a195 16
  !ifdef(precisionEstimates,{
  Fill, quantity=aprioriPrecision.baselineR1A, method=explicit, /spread, $
    explicitValues= 0.245 K
  Fill, quantity=aprioriPrecision.baselineR1B, method=explicit, /spread, $
    explicitValues= 0.245 K
  Fill, quantity=aprioriPrecision.baselineR2, method=explicit, /spread, $
    explicitValues= 0.653 K
  Fill, quantity=aprioriPrecision.baselineR3, method=explicit, /spread, $
    explicitValues= 0.653 K
  Fill, quantity=aprioriPrecision.baselineR4, method=explicit, /spread, $
    explicitValues= 1.96 K
  Fill, quantity=aprioriPrecision.baselineR5H, method=explicit, /spread, $
    explicitValues= 24.5 K
  Fill, quantity=aprioriPrecision.baselineR5V, method=explicit, /spread, $
    explicitValues= 24.5 K
  },{
d210 1
a210 1
  })
@


1.23
log
@Moved bound to tropH2O
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.22 2002/10/23 19:56:29 livesey Exp $
d231 3
d235 1
a237 2


@


1.22
log
@Added tropH2O stuff
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.21 2002/10/19 18:52:36 livesey Exp $
d231 1
a231 3
  ;; Fill, quantity=lowBound.temperature, method=explicit, explicitValues=50K, /spread
  Fill, quantity=lowBound.h2o, method=profile, $
    profileValues=[ 1000mb : 0.1ppmv, 101mb : 0.1ppmv, 100mb : -1.0e6 ppmv ]
@


1.21
log
@Bug fix in h2o low bound fill
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.20 2002/10/18 02:25:48 livesey Exp $
d36 4
@


1.20
log
@Removed bounds on temperature at least for the moment.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.19 2002/10/17 18:19:39 livesey Exp $
d229 1
a229 1
    profileValues=[ 1000mb : 0.1ppmv, 101mb : 0.1ppmv, 101mb : -1.0e6 ppmv ]
@


1.19
log
@Added low/high bound
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.18 2002/10/03 05:42:00 livesey Exp $
d227 1
a227 1
  Fill, quantity=lowBound.temperature, method=explicit, explicitValues=50K, /spread
@


1.18
log
@Calmed down extinction a priori
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.17 2002/10/02 23:23:21 livesey Exp $
d13 2
d225 5
@


1.17
log
@Now uses profile fill for h2o apriori precision
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.16 2002/10/02 23:06:00 pwagner Exp $
d161 1
a161 1
    explicitValues=1.0
d163 1
a163 1
    explicitValues=1.0
d165 1
a165 1
    explicitValues=1.0
d167 1
a167 1
    explicitValues=1.0
d169 1
a169 1
    explicitValues=1.0
d171 1
a171 1
    explicitValues=1.0
d173 1
a173 1
    explicitValues=1.0
d176 1
a176 1
    explicitValues=1.0
d178 1
a178 1
    explicitValues=1.0
d180 1
a180 1
    explicitValues=1.0
d182 1
a182 1
    explicitValues=1.0
d184 1
a184 1
    explicitValues=1.0
d186 1
a186 1
    explicitValues=1.0
d188 1
a188 1
    explicitValues=1.0
@


1.16
log
@RHI now separate fill methods
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.15 2002/09/27 00:00:14 livesey Exp $
a116 1
  Fill, quantity=aprioriPrecision.h2o,  method=explicit, /spread, explicitValues= 3 ppmv
d129 3
a132 9
  ;; Now make the h2o error 1000ppmv in the troposphere.
  ;; A bit messy this one.
end Fill
begin Retrieve
  Subset, quantity=aprioriPrecision.h2o, height=[1000.0mb:150.0mb], mask=fill
end Retrieve
begin Fill
  Fill, quantity=aprioriPrecision.h2o, method=explicit, /spread, $
    explicitValues=1000 ppmv
@


1.15
log
@New extinctions
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.14 2002/08/15 22:46:17 livesey Exp $
d32 1
a32 1
    temperatureQuantity=apriori.temperature, method=special, /dontMask
@


1.14
log
@Added extinction apriori
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.13 2002/08/04 16:14:27 mjf Exp $
d167 1
a167 1
  Fill, quantity=aprioriPrecision.extinctionR1A, method=explicit, /spread, $
d169 1
a169 1
  Fill, quantity=aprioriPrecision.extinctionR1B, method=explicit, /spread, $
d171 1
a171 1
  Fill, quantity=aprioriPrecision.extinctionR2, method=explicit, /spread, $
d173 1
a173 1
  Fill, quantity=aprioriPrecision.extinctionR3, method=explicit, /spread, $
d175 1
a175 1
  Fill, quantity=aprioriPrecision.extinctionR4, method=explicit, /spread, $
d177 1
a177 1
  Fill, quantity=aprioriPrecision.extinctionR5H, method=explicit, /spread, $
d179 16
a194 1
  Fill, quantity=aprioriPrecision.extinctionR5V, method=explicit, /spread, $
@


1.13
log
@Choose different fills and different a priori errors for precision
estimates.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.12 2002/07/17 19:29:37 livesey Exp $
d165 16
@


1.12
log
@Fill GPH
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.11 2002/07/07 23:37:26 livesey Exp $
d48 1
d50 1
d94 19
d140 1
d143 3
d147 1
d168 16
d198 1
@


1.11
log
@Set h2o apriori precision to 1000ppmv below 100hPa
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.10 2002/06/26 20:21:28 livesey Exp $
d61 4
@


1.10
log
@More iterations on pressure guesser
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.9 2002/06/26 01:26:58 livesey Exp $
d105 10
@


1.9
log
@New 2D pressure guesser
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.8 2002/06/21 00:59:39 livesey Exp $
d69 1
a69 1
    maxIterations=10
d77 1
a77 1
    maxIterations=10
@


1.8
log
@Updated apriori precisions
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.7 2002/06/15 00:11:53 livesey Exp $
d50 10
d67 2
d75 2
a79 9
  ;; Compute refracted phitans for apriori
  Fill, quantity=apriori.phiTanGHz, method=refract, $
    ptanQuantity=apriori.ptanGHz, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false
  Fill, quantity=apriori.phiTanTHz, method=refract, $
    ptanQuantity=apriori.ptanTHz, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false
@


1.7
log
@Fixed problem with phiTan not being filled correctly.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.6 2002/06/07 18:03:10 livesey Exp $
a64 1
})
d75 1
d83 3
a85 3
  Fill, quantity=aprioriPrecision.bro,  method=explicit, /spread, explicitValues= 100 pptv
  Fill, quantity=aprioriPrecision.ch3cn,method=explicit, /spread, explicitValues= 100 pptv
  Fill, quantity=aprioriPrecision.clo,  method=explicit, /spread, explicitValues= 5 ppbv
d87 4
a90 4
  Fill, quantity=aprioriPrecision.h2o,  method=explicit, /spread, explicitValues= 10 ppmv
  Fill, quantity=aprioriPrecision.hcl,  method=explicit, /spread, explicitValues= 5 ppbv
  Fill, quantity=aprioriPrecision.hcn,  method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.hno3, method=explicit, /spread, explicitValues= 20 ppbv
d92 3
a94 3
  Fill, quantity=aprioriPrecision.hocl, method=explicit, /spread, explicitValues= 100 pptv
  Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 500 ppbv
  Fill, quantity=aprioriPrecision.o3,   method=explicit, /spread, explicitValues= 10 ppmv
d98 1
a98 1
  Fill, quantity=aprioriPrecision.temperature,   method=explicit, /spread, explicitValues= 20 K
@


1.6
log
@Sorted out problems with if statements.
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.5 2002/06/04 23:23:15 livesey Exp $
d65 1
a75 1
})
@


1.5
log
@Added phiTan fills
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.4 2002/05/28 22:36:14 livesey Exp $
d64 1
d67 8
a74 11
;   Fill, quantity=apriori.phiTanGHz, method=refract, $
;     ptanQuantity=apriori.ptanGHz, $
;     h2oQuantity=apriori.h2o, $
;     temperatureQuantity=apriori.temperature, $
;     refract=false
;   Fill, quantity=apriori.phiTanTHz, method=refract, $
;     ptanQuantity=apriori.ptanTHz, $
;     h2oQuantity=apriori.h2o, $
;     temperatureQuantity=apriori.temperature, $
;     refract=false
  })
@


1.4
log
@Semi freeze of version
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.3 2002/05/17 20:24:08 livesey Exp $
d64 12
@


1.3
log
@First consolidated version
@
text
@d1 1
a1 1
;; $Id: fillapriori.l2cf,v 1.2 2002/05/13 17:24:25 livesey Exp $
d50 1
d64 1
@


1.2
log
@Getting close to being ready
@
text
@d1 1
a1 2
!divert(-1)
;; $Id: fillapriori.l2cf,v 1.1 2002/04/29 21:54:58 pwagner Exp $
d6 2
a7 1
!divert!dnl
a9 1

d13 21
d37 1
a37 5
;; Fill the standard species
!include(fillfromclimatology.l2cf)

;; Fill the sideband ratios
!include(fillsidebandratios.l2cf)
d40 1
a40 2
;; !ifdef(l2pcrun,{!include(filllesserstate_l2pc.m4)},{!include(filllesserstate.m4)})
!include(filllesserstate.m4)
d42 1
a42 3
;; Fill the minor isotopes
!define(vec,{apriori})!dnl
!include(fillisotopes.m4)
d46 1
d53 1
a53 1
    temperatureQuantity=apriori.temp, $
d59 1
a59 1
    temperatureQuantity=apriori.temp, $
d63 1
d65 5
d86 1
a86 1
  Fill, quantity=aprioriPrecision.temp,   method=explicit, /spread, explicitValues= 20 K
a91 2
  Fill, quantity=length.br_79_o, method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.br_81_o, method=explicit, /spread, explicitValues= !standardLength
a92 1
  Fill, quantity=length.cl_35_o, method=explicit, /spread, explicitValues= !standardLength
a95 2
  Fill, quantity=length.h2o_18,  method=explicit, /spread, explicitValues= !standardLength
  Fill, quantity=length.hcl_35,  method=explicit, /spread, explicitValues= !standardLength
a100 1
  Fill, quantity=length.hocl_35, method=explicit, /spread, explicitValues= !standardLength
d106 2
a107 1
  Fill, quantity=length.temp,    method=explicit, /spread, explicitValues= !standardLength
a126 5

;; Now also scale the apriori precisions into isotope space
!define(vec,{aprioriPrecision})!dnl
!include(fillisotopes.m4)

@


1.1
log
@First commit
@
text
@d2 1
a2 1
;; $Id: fillapriori.l2cf,v 2.3 2002/01/08 22:46:00 livesey Exp $
d18 1
a18 1
!include(fillfromclimatology.m4)
d21 1
a21 1
!include(fillsidebandratios.m4)
d116 3
@

