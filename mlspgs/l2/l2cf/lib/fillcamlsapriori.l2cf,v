head	1.1;
access;
symbols
	v5-02-NRT-19:1.1
	v6-00:1.1
	v5-02-NRT-18:1.1
	v5-02:1.1
	v5-01-NRT-17:1.1
	v5-01-NRT-16:1.1
	v5-01-NRT-15:1.1
	v5-01-NRT-14:1.1
	neuralnetworks-1-0:1.1.0.12
	cfm-single-freq-0-1:1.1.0.10
	v5-01:1.1
	v5-00:1.1
	v4-23-TA133:1.1.0.8
	mus-emls-1-70:1.1.0.6
	rel-1-0-englocks-work:1.1.0.4
	VUMLS1-00:1.1
	VPL1-00:1.1
	V4-22-NRT-08:1.1
	VAM1-00:1.1
	V4-21:1.1.0.2
	V4-13:1.1
	V4-12:1.1
	V4-11:1.1;
locks; strict;
comment	@# @;


1.1
date	2014.05.29.04.57.12;	author livesey;	state Exp;
branches;
next	;


desc
@@


1.1
log
@First version
@
text
@!divert(-1)
;; $Id: fillcamlsapriori.l2cf,v 1.158 2014/02/19 19:22:38 pwagner Exp $

;; This l2cf fragment is for setting up a priori vectors with
;; appropriate quantities

!divert!dnl
;; ----------------------------------------------- Setup vectors

;; First define the vectors in question
begin Fill
  apriori: Vector, template=stateTemplate
  aprioriPrecision: Vector, template=stateTemplate
  hReg: Vector, template=stateTemplate
  vReg: Vector, template=stateTemplate
  ;; The low/high bound options here make sure it defaults to
  ;; +/- huge, instead of the usual default of zero
  lowBound: Vector, template=stateTemplate, /lowBound
  highBound: Vector, template=stateTemplate, /highBound

end Fill

;; ----------------------------------- Fill species with climatology

begin Fill
  
  ;; This macro fills one apriori quantity with climatlogical data
  !define(fillWithClimatology,{Fill, quantity=apriori.$1, method=gridded, $
    sourceGrid=grid$1!nl})

  ;; Now invoke it for all relevant species
  !forall(fillWithClimatology,!allClimatologicalSpecies)

end Fill

;; ----------------------------------- Lesser state

;; Fill the lesser stuff
!define(GlobalSysTemp,{2000 K})
!include(filllessercamlsstate.l2cf)

;; ----------------------------------- Tangent pressures

begin Fill

  Fill, quantity=apriori.refGPH, method=explicit, explicitvalues=16 km,/spread

  ;; Compute non refracted phitans for apriori
  Fill, quantity=apriori.phiTan, method=refract, $
    ptanQuantity=apriori.ptan, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, refract=false

  ;; Get full GPH profile
  Fill, quantity=apriori.gph, method=hydrostatic, $
    temperatureQuantity=apriori.temperature, $
    refGPHquantity=apriori.refGPH

  !ifdef(flagSkipHydrostatic,{},{
  ;; Now compute the tangent presssures for apriori
  Fill, quantity=apriori.ptan, method=hydrostatic, $
    h2oQuantity=apriori.h2o, $
    temperatureQuantity=apriori.temperature, $
    refGPHQuantity=apriori.refGPH, $
    geocAltitudeQuantity=apriori.tngtGeocAlt, $
    orbitInclination=apriori.orbitInclination, $
    phiTan=apriori.phiTan, $
    maxIterations=20, $
    !ifdef(flagStrict1D,{phiWindow=0 profiles},{phiWindow=4 degrees})
  })

  
  ;; -------------------------------- Apriori precisions for species

  Fill, quantity=aprioriPrecision.bro,  method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.ch3cn,method=explicit, /spread, explicitValues= 2 ppbv
  ;; CH3CN was 500 pptv
  Fill, quantity=aprioriPrecision.clo,  method=explicit, /spread, explicitValues= 3 ppbv
;; CH3CL
  Fill, quantity=aprioriPrecision.ch3cl,method=explicit, /spread, explicitValues= 500 pptv
  Fill, quantity=aprioriPrecision.ch3oh,method=explicit, /spread, explicitValues= 5 ppbv
  Fill, quantity=aprioriPrecision.ch3ch2oh,method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.ch3coch3,method=explicit, /spread, explicitValues= 500 pptv


  Fill, quantity=aprioriPrecision.co,   method=profile, $
    profileValues= [ 100mb : 0.5ppmv, 50mb : 0.1ppmv, 31mb : 0.12ppmv, $
    10mb : 0.2ppmv, 3.1mb : 0.35ppmv, 1mb : 0.7ppmv, 0.31mb : 2ppmv, $
    0.1mb : 5ppmv, 0.01mb : 10ppmv,  0.001mb : 20ppmv ]
  Fill, quantity=aprioriPrecision.h2o, method=profile, profileValues = $
    [ 1000mb: 10000ppmv, 464mb : 10000ppmv, 316mb : 1500ppmv, $
      215mb : 300ppmv, 147mb : 300ppmv, 100mb : 3.0ppmv ]
  ;; 0.2 ppbv is too small for hcn
  Fill, quantity=aprioriPrecision.hcn,  method=explicit, /spread, explicitValues= 1 ppbv
  Fill, quantity=aprioriPrecision.hno3, method=profile, $
    profileValues= [ 316mb : 4ppbv, 100mb: 8ppbv, 50mb : 10ppbv ]
  ;; 1 ppbv is too small for ho2
  Fill, quantity=aprioriPrecision.ho2,  method=explicit, /spread, explicitValues= 10 ppbv
  Fill, quantity=aprioriPrecision.hocl, method=explicit, /spread, explicitValues= 3 ppbv
  ;; For N2O, 0.2 ppmv is too small for the troposphere, but we don't
  ;; have sensitivity there
  ;Fill, quantity=aprioriPrecision.n2o,  method=explicit, /spread, explicitValues= 0.2 ppmv
  Fill, quantity=aprioriPrecision.n2o, method=profile, profileValues = $
    [ 147mb: 50ppbv, 100mb : 200ppbv ]
  Fill, quantity=aprioriPrecision.o2,  method=explicit, /spread, explicitValues= 20000.0 ppmv
  Fill, quantity=aprioriPrecision.o3,   method=profile, $
    profileValues = [ 316mb : 500ppbv, 100mb:2ppmv, 46mb : 4 ppmv ]

  ;; 100pptv is far too small for so2
  Fill, quantity=aprioriPrecision.so2,  method=explicit, /spread, explicitValues= 10 ppbv

  Fill, quantity=aprioriPrecision.temperature, method=profile, $
    profileValues= [ 1000mb:5K, 220mb:10K, 68mb:20K ]
  Fill, quantity=aprioriPrecision.refGPH, method=explicit, /spread, explicitValues= 5 km
  Fill, quantity=aprioriPrecision.gph, method=explicit, /spread, explicitValues= 5 km

  ;; ------------------------------ A priori extinction precisions

  !define(fillExtinctionApriori,{
!ifelse(!index(!defn(v2ExtinctionRadiometers),$1),{-1},{
  Fill, quantity=aprioriPrecision.extinction$1, $
    method=explicit, /spread, explicitValues=1.0e-6!nl
},{!dnl
  Fill, quantity=aprioriPrecision.extinctionv2$1, $
    method=explicit, /spread, explicitValues=1.0e-6!nl})
})
  !forall({fillExtinctionApriori},!allRadiometers)

  ;; ------------------------------ Baseline precisions

  !define(fillBaselineMAFApriori,{
  Fill, quantity=aprioriPrecision.baselineMAF$1, method=explicit, $
        explicitvalues = 5K, /spread !nl})
  !forall({fillBaselineMAFApriori},!allRadiometers)


  ;; Now set the smoothing weights - we'll use a profile fill, even if
  ;; it's only one value.
  ;; In the cases where there are different smoothings for products in
  ;; different phases, I'm quoting there the one for the 'standard' product.

  ;; Vertical
  Fill, quantity=vReg.extinctionR1, method=explicit,/spread,explicitValues=1.0e-3

  Fill, quantity=vReg.bro, method=profile, $
    profileValues= [ 1mb:0.1ppbv]
  Fill, quantity=vReg.ch3cn, method=profile, $
    profileValues= [ 146mb:500pptv, 100mb:30pptv, 1mb:30pptv, 0.68mb:0pptv ]
  Fill, quantity=vReg.clo, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3cl, method=profile, $
    profileValues= [ 1mb:0.1ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3oh, method=profile, $
    profileValues= [ 1mb:10ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3ch2oh, method=profile, $
    profileValues= [ 1mb:10ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ch3coch3, method=profile, $
    profileValues= [ 1mb:0.1ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.co, method=profile, profileValues= $
    [ 10mb:15ppbv, 3.1mb:50ppbv,  1mb:150ppbv, 0.31mb: 0.5ppmv, 0.1mb:1.5ppmv, $
      0.03mb:5ppmv, 0.01mb: 15ppmv, 0.003mb: 50ppmv, 0.001mb:150ppmv ]
  Fill, quantity=vReg.h2o, method=profile, profileValues= $
    [ 1000mb:500ppmv, 300mb:50ppmv, 215mb:20ppmv, 147mb:10ppmv, 100mb:1.0ppmv,$
    1mb:0.3ppmv,0.1mb:5ppmv, 0.001mb:0ppmv ], logSpace=false

  Fill, quantity=vReg.hcn, method=profile, $
    profileValues= [ 0.1mb:20pptv, 0.001mb:80pptv ]
  Fill, quantity=vReg.hno3, method=profile, $
    profileValues= [ 200mb:0.2ppbv, 100mb:1ppbv, 1mb:3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.ho2, method=profile, $
    profileValues=[ 32mb:100pptv, 10mb:200pptv, 3.2mb:500pptv, 1mb:500pptv, 0.32mb:2000pptv, 0.15mb:10000pptv ], $
    /logSpace
  Fill, quantity=vReg.hocl, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=vReg.n2o, method=profile, $
    profileValues= [ 200mb:10ppbv, 100mb:20ppbv, 1mb:20ppbv, 0.1mb:0ppbv ]

  Fill, quantity=vReg.o3, method=profile, $
    profileValues= [ 200mb:0.2ppmv, 100mb:0.5ppmv, 0.1mb:1ppmv, 0.046mb:0ppmv ]

  Fill, quantity=vReg.temperature, method=profile, $
    profileValues=[ 1mb:1K ]

  Fill, quantity=vReg.o2, method=profile, $
    profileValues=[ 1mb:1000ppmv ]

  ;; Horizontal
  Fill, quantity=hReg.extinctionR1, method=explicit,/spread,explicitValues=1.0e-3

  Fill, quantity=hReg.bro, method=profile, $
    profileValues= [ 1mb:0.3ppbv ]
  Fill, quantity=hReg.ch3cn, method=profile, $
    profileValues= [ 146mb:500pptv, 100mb:30pptv, 1mb:30pptv, 0.68mb:0pptv ]
  Fill, quantity=hReg.clo, method=profile, $
    profileValues= [  1mb:0.1ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3cl, method=profile, $
    profileValues= [  1mb:0.1ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3oh, method=profile, $
    profileValues= [  1mb:5ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3ch2oh, method=profile, $
    profileValues= [  1mb:5ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.ch3coch3, method=profile, $
    profileValues= [  1mb:0.05ppbv, 0.68:0pptv ]
  Fill, quantity=hReg.co, method=profile, profileValues= $
    [ 100mb:15ppbv,  46mb:5ppbv, 10mb:5ppbv,   3mb: 15ppbv, 1mb:50ppbv, 0.3mb: 150ppbv, 0.1mb:0.5ppmv, $
      0.03mb: 1.5ppmv, 0.01mb:5ppmv, 0.003mb:15ppmv, 0.001mb: 50ppmv ]

  Fill, quantity=hReg.h2o, method=profile, $
     profileValues=[ 147mb:0ppmv, 121mb:2ppmv, 100mb:0.3ppmv, 10mb:0.3ppmv, 1mb:0.4ppmv, 0.1mb:3ppmv, $
     0.046mb:0ppmv ], logSpace=false


  Fill, quantity=hReg.hcn, method=profile, $
    profileValues= [ 1mb:20pptv, 0.1mb:0pptv ]
  Fill, quantity=hReg.hno3, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=hReg.ho2, method=profile, $
    profileValues=[ 32mb:50pptv, 10mb:50pptv, 3.2mb:100pptv, 1mb:50pptv, 0.32mb:500pptv, 0.15mb:1000pptv ], /logSpace
  Fill, quantity=hReg.hocl, method=profile, $
    profileValues= [ 1mb:0.3ppbv, 0.68mb:0ppbv ]
  Fill, quantity=hReg.n2o, method=profile, $
    profileValues= [ 1mb:10ppbv, 0.1mb:0ppbv ]

  Fill, quantity=hReg.o3, method=profile, $
    profileValues= [ 146mb:30ppbv, 100mb:0.3ppmv, 0.1mb:0.3ppmv, 0.046mb:0ppmv ]

  Fill, quantity=hReg.temperature, method=profile, $
    profileValues=[ 1mb:1K ]

  Fill, quantity=hReg.refGPH, method=explicit, explicitValues=10m, /spread

end Fill

@
