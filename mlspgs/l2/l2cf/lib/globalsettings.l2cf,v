head	1.9;
access;
symbols
	v5-02-NRT-19:1.9
	v6-00:1.9
	v5-02-NRT-18:1.9
	v5-02:1.6
	v5-01-NRT-17:1.8
	v5-01-NRT-16:1.8
	v5-01-NRT-15:1.8
	v5-01-NRT-14:1.8
	neuralnetworks-1-0:1.8.0.4
	cfm-single-freq-0-1:1.8.0.2
	v5-01:1.6
	v5-00:1.6
	v4-23-TA133:1.6.0.6
	mus-emls-1-70:1.6.0.4
	rel-1-0-englocks-work:1.6.0.2
	VUMLS1-00:1.5
	VPL1-00:1.5
	V4-22-NRT-08:1.5
	VAM1-00:1.4
	V4-21:1.4.0.2
	V4-13:1.4
	V4-12:1.4
	V4-11:1.4
	V4-10:1.4
	M4-00:1.1
	V3-33:1.1
	V3-31:1.1
	V3-30-NRT-05:1.1
	cfm-01-00:1.1;
locks; strict;
comment	@# @;


1.9
date	2023.12.14.21.23.47;	author pwagner;	state Exp;
branches;
next	1.8;

1.8
date	2020.03.05.23.56.11;	author pwagner;	state Exp;
branches;
next	1.7;

1.7
date	2019.12.12.00.58.33;	author pwagner;	state Exp;
branches;
next	1.6;

1.6
date	2018.03.13.23.20.36;	author pwagner;	state Exp;
branches;
next	1.5;

1.5
date	2015.10.07.21.05.54;	author pwagner;	state Exp;
branches;
next	1.4;

1.4
date	2014.04.03.17.40.04;	author pwagner;	state Exp;
branches;
next	1.3;

1.3
date	2013.12.11.18.12.19;	author pwagner;	state Exp;
branches;
next	1.2;

1.2
date	2013.10.17.22.31.17;	author pwagner;	state Exp;
branches;
next	1.1;

1.1
date	2010.04.21.23.36.37;	author pwagner;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Moved two macros to setupcalfiles.l2cf
@
text
@!divert(-1)
; $Id: globalsettings.l2cf,v 1.8 2020/03/05 23:56:11 pwagner Exp $

; This l2cf fragment 
; (1) defines macros we're going to need below; then
; (2) supplies the global settings section
; For special runs, you may wish to predefine *Bands before entering this section
; Its contents will also be affected by the flagUsingPCF, because
; the PCF will supply l1b files, starting and end times, leap seconds file

    ;; This list of bands defines what l2pc files might be read
    !defunlessdef(standardBands,{1,2,3,4,5,6,10,11,12,13,14,17,23,27,28,29,30,31,32,34})
    !defunlessdef(szaBands,{15,16,18,19})
    ;; 22 is both polarized and o3hr
    !defunlessdef(polarizedBands,{22})
    !defunlessdef(o3hrBands,{1,7,8,9,24,25,32,33,34})
    ;; Read our l2pc files
    !ifdef(flagUsingPCF,
    {!define(l2pcPrefix,{})
    !define(l2pcSuffixMonthly,{})
    !define(l2pcSuffixConstant,{})},
    {!define(l2pcPrefix,{!inpathl2pc/MLS-Aura_L2Cal-})
    !define(l2pcSuffixMonthly,{_!l2pcVersion_!month.h5})
    !define(l2pcSuffixConstant,{_!l2pcVersion_0000d000.h5})})

    !define(readStandardL2PC,{!dnl
    ForwardModelGlobal, l2pc='!l2pcPrefix{}L2PC-band$1-LATSCALARHIRES!l2pcSuffixMonthly'!nl})

    !define(readSZAL2PC,{!dnl
    ForwardModelGlobal, l2pc='!l2pcPrefix{}L2PC-band$1-SZASCALARHIRES!l2pcSuffixConstant'!nl})

    !define(readPolarL2PC,{!dnl
    ForwardModelGlobal, l2pc='!l2pcPrefix{}L2PC-band$1-LATPOLARHIRES!l2pcSuffixConstant'!nl})

    !define(readO3HRL2PC,{!dnl
    ForwardModelGlobal, l2pc='!l2pcPrefix{}L2PC-band$1-LATSCALARHIRESO3HR!l2pcSuffixMonthly'!nl})

    !define(readPolarO3HRL2PC,{!dnl
    ForwardModelGlobal, l2pc='!l2pcPrefix{}L2PC-band$1-LATPOLARHIRESO3HR!l2pcSuffixConstant'!nl})

    ;; This macro creates the list of DirectWriteFiles that sources are to be
    ;; distributed among automatically
    !define(oneToNineteen,{!forloop({i},1,18,{!i, })19})
    !ifdef(flagUsingPCF,{!dnl
    !define(makeOneDWFPair,{!dnl
    DirectWriteFile, file='DGG$1', type=l2dgg
    DirectWriteFile, file='DGM$1', type=l2aux!nl})
    },{!dnl
    !define(makeOneDWFPair,{!dnl
    DirectWriteFile, file='!l2gpFileName(DGG$1)', type=l2dgg
    DirectWriteFile, file='!l2auxFileName(DGM$1)', type=l2aux!nl})
    })

!divert!dnl
    !ifdef(flagWriteL2CFNameToStdErr, {}, {
; Write the name of the l2cf file to stderr
; where it can be intercepted by a wrapper script if needed
begin readAPriori
    l2cf: Boolean, formula="l2cf", /evaluate, /literal
    Dump, options='--Err', Boolean=l2cf
end readAPriori
})
; -------------------------------------------- Global settings ------
begin GlobalSettings

    !ifdef(flagUsingPCF, {},
    {
    ;; Setup the stuff for reading and dealing with l1b files

    !ifdef(SIDSRTVL,
    {
    l1boa, file='!inpathl1boa/MLS-Aura_L1BOA-Full_!l1boaVersion--t_!day.!l1boaHDFVersion'
    l1brad, file='!inpathl1brad/MLS-Aura_L1BRAD-GHz_!l1bradVersion-!cleanNoisy--t_!day.h5'
    l1brad, file='!inpathl1brad/MLS-Aura_L1BRAD-DACS_!l1bradVersion-!cleanNoisy--t_!day.h5'
    l1brad, file='!inpathl1brad/MLS-Aura_L1BRAD-THz_!l1bradVersion-!cleanNoisy--t_!day.h5'
    },{
    l1boa, file='!inpathl1boa/MLS-Aura_L1BOA_!l1bradVersion_!day.h5'
    l1brad, file='!inpathl1brad/MLS-Aura_L1BRADG_!l1bradVersion_!day.h5'
    l1brad, file='!inpathl1brad/MLS-Aura_L1BRADD_!l1bradVersion_!day.h5'
    l1brad, file='!inpathl1brad/MLS-Aura_L1BRADT_!l1bradVersion_!day.h5'
    })

    startTime = '!year(!day)-!doy(!day)T00:00:00.0000'
    !ifdef(flagDoingSnoop, {endTime = '!year(!day)-!doy(!day)T23:59:59.9999'},
    {endTime = '!year(!day)-!doy(!day)T23:59:59.4999'})
    !ifdef(flagUseLeapSecFile, {leapsecfile = '!inpathleapsec/leapsec.dat'})
    })

    ;; This is the list of DirectWriteFiles that sources are to be
    ;; distributed among automatically
!forall(makeOneDWFPair,!oneToNineteen)

    ;; Setup our vertical grids
    !include(constructstandardgrids.l2cf)

    ;; Setup our emiprical geometry.  This is for getting an empirical
    ;; value for longitude as a function of geodetic cangle
    empiricalGeometry, terms=[ $
                               -1.06863, 43.0943, -16.2062, 8.12730, -4.58416, 2.75786, -1.72880, $
                               1.11523, -0.733464, 0.489792, -0.331852, 0.227522, -0.156428, $
                               0.108031, -0.0757825, 0.0536980, -0.0375161, 0.0260555, $
                               -0.0188811, 0.0138453, -0.00959350]

    ;; Define the frequency grids for the extinciton quantities
    !include(extinctionfgrids.l2cf)
    !include(baselinefgrids.l2cf)

    ;; Read antenna patterns
    ForwardModelGlobal, $
      antennaPatterns='!antennaFile', $
      filterShapes='!filterFile', $
      DACSFiltershapes='!dacsFilterFile', $
      pointingGrids='!pfgFile', $
      pfaFiles= [$
        '!PFAFile(1)', $
        '!PFAFile(2)', $
        '!PFAFile(3)', $
        '!PFAFile(4)', $
        '!PFAFile(5)', $
        '!PFAFile(6)', $
        '!PFAFile(7)', $
        '!PFAFile(8)'  $
      ]
    
!forall(readStandardL2PC,!standardBands)

!forall(readSZAL2PC,!szaBands)

!forall(readPolarL2PC,!polarizedBands)

!forall(readO3HRL2PC,!o3hrBands)

!forall(readPolarO3HRL2PC,!polarizedBands)
    ;; Now define any forward models that will be used in more than one phase.

    ;; Define l2pc bin selectors
    elevationCost: BinSelector, type=fieldElevation, cost = 10 degrees
    strengthCost: BinSelector, type=fieldStrength, cost = 1 gauss
    latCost: BinSelector, type=latitude, cost = 1 degrees 
    szaCost: BinSelector, type=sza, cost=10 degrees
    hrBin: BinSelector, type=nameFragment, nameFragment='HIRES'
    lrBin: BinSelector, type=nameFragment, nameFragment='LORES'
    polarBin: BinSelector, type=nameFragment, nameFragment='POLAR'
    scalarBin: BinSelector, type=nameFragment, nameFragment='SCALAR'
    latBin: BinSelector, type=nameFragment, nameFragment='LAT'
    szaBin: BinSelector, type=nameFragment, nameFragment='SZA'
    o3hrBin: BinSelector, type=nameFragment, nameFragment='O3HR'

end GlobalSettings
!divert(-1)
; $Log: globalsettings.l2cf,v $
; Revision 1.8  2020/03/05 23:56:11  pwagner
; Supplies quote marks for ForwardModelGlobal files
;
; Revision 1.7  2019/12/12 00:58:33  pwagner
; Makes use of new macros; prints if dee=bug
;
; Revision 1.6  2018/03/13 23:20:36  pwagner
; Removed unused iterations field
;
; Revision 1.5  2015/10/07 21:05:54  pwagner
; flagWriteL2CFNameToStdErr now controls whether to do that
;
; Revision 1.4  2014/04/03 17:40:04  pwagner
; Removed l2ParSF; leapsecfile now optional
;
; Revision 1.3  2013/12/11 18:12:19  pwagner
; Repaired l2pcSuffixMonthly definition
;
; Revision 1.2  2013/10/17 22:31:17  pwagner
; scan models lacked specificQuantities, anyway, so removed them
;
; Revision 1.1  2010/04/21 23:36:37  pwagner
; First commit
;
!divert!dnl
@


1.8
log
@Supplies quote marks for ForwardModelGlobal files
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.7 2019/12/12 00:58:33 pwagner Exp $
a9 3
    ;; This is the list of bands that the readradiances macro is to read
    ;; from the level 1 data.
    !defunlessdef(relevantBands,{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,22,23,24,25,27,28,29,30,31,32,33,34})
a40 1
    !define(flagAutoSplitSources,1)
a53 4
    ;; Define the precision for the scan model.  We should really think
    ;; about a better place to put this!
    !define(scanModelPrecision,{30 m})

d57 1
a57 1
; where it can be intercepted by wrapper script if needed
d152 3
@


1.7
log
@Makes use of new macros; prints if dee=bug
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.6 2018/03/13 23:20:36 pwagner Exp $
d118 14
a131 5
      antennaPatterns=!antennaFile, $
      filterShapes=!filterFile, $
      DACSFiltershapes=!dacsFilterFile, $
      pointingGrids=!pfgFile, $
      pfaFiles=!pfaFiles
d160 3
@


1.6
log
@Removed unused iterations field
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.5 2015/10/07 21:05:54 pwagner Exp $
d12 1
a12 2
    !ifdef(relevantBands,{},
    {!define(relevantBands,{1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,22,23,24,25,27,28,29,30,31,32,33,34})})
d15 2
a16 5
    ;;;!define(standardBands,{1,2,3,4,5,6,7,8,9,10,11,12,13,14,17,23,24,25,27,28,29,30,31,32,33,34})
    !ifdef(standardBands,{},
    {!define(standardBands,{1,2,3,4,5,6,10,11,12,13,14,17,23,27,28,29,30,31,32,34})})
    !ifdef(szaBands,{},
    {!define(szaBands,{15,16,18,19})})
d18 2
a19 4
    !ifdef(polarizedBands,{},
    {!define(polarizedBands,{22})})
    !ifdef(o3hrBands,{},
    {!define(o3hrBands,{1,7,8,9,24,25,32,33,34})})
d151 3
@


1.5
log
@flagWriteL2CFNameToStdErr now controls whether to do that
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.4 2014/04/03 17:40:04 pwagner Exp $
d69 1
a69 1
    !ifdef(flagWriteL2CFNameToStdErr, {},
d116 1
a116 2
                               -0.0188811, 0.0138453, -0.00959350], $
      iterations=10
d157 3
@


1.4
log
@Removed l2ParSF; leapsecfile now optional
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.3 2013/12/11 18:12:19 pwagner Exp $
d69 8
d158 3
@


1.3
log
@Repaired l2pcSuffixMonthly definition
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.2 2013/10/17 22:31:17 pwagner Exp $
a88 2
    l2ParSF, file='!outpathtmp/MLS-Aura_L2Staging-Full_!l2version_!day.h5'

d91 2
a92 2
    {endTime = '!year(!day)-!doy(!day)T23:59:59.9999'})
    leapsecfile = '!inpathleapsec/leapsec.dat'
d150 3
@


1.2
log
@scan models lacked specificQuantities, anyway, so removed them
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.1 2010/04/21 23:36:37 pwagner Exp $
d32 1
a32 1
    !define(l2pcSuffixMonthly,{_!l2pcVersion_m!month.h5})
d152 3
@


1.1
log
@First commit
@
text
@d2 1
a2 1
; $Id: globalsettings.l2cf,v 1.142 2009/10/13 00:17:42 pwagner Exp $
a135 4
    ;; Define the scan models
    scanFwmGHz: ForwardModel, type=scan2d, module=GHz,  phiWindow=5 profiles
    scanFwmTHz: ForwardModel, type=scan2d, module=THz,  phiWindow=5 profiles

d151 4
a154 1
; $Log: retrievalmacros.l2cf,v $
@

