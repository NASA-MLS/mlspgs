head	1.2;
access;
symbols
	v5-02-NRT-19:1.2
	v6-00:1.2
	v5-02-NRT-18:1.2
	v5-02:1.2
	v5-01-NRT-17:1.2
	v5-01-NRT-16:1.2
	v5-01-NRT-15:1.2
	v5-01-NRT-14:1.2
	neuralnetworks-1-0:1.2.0.14
	cfm-single-freq-0-1:1.2.0.12
	v5-01:1.2
	v5-00:1.2
	v4-23-TA133:1.2.0.10
	mus-emls-1-70:1.2.0.8
	rel-1-0-englocks-work:1.2.0.6
	VUMLS1-00:1.2
	VPL1-00:1.2
	V4-22-NRT-08:1.2
	VAM1-00:1.2
	V4-21:1.2.0.4
	V4-13:1.2
	V4-12:1.2
	V4-11:1.2
	V4-10:1.2
	V3-43:1.2
	M4-00:1.2
	V3-41:1.2
	V3-40-PlusGM57:1.2.0.2
	V3-33:1.2
	V3-31:1.2
	V3-30-NRT-05:1.2
	cfm-01-00:1.2
	V3-30:1.2
	V3-20:1.2
	V3-10:1.2;
locks; strict;
comment	@# @;


1.2
date	2009.04.09.20.57.23;	author pwagner;	state Exp;
branches;
next	1.1;

1.1
date	2008.06.27.20.52.15;	author michael;	state Exp;
branches;
next	;


desc
@@


1.2
log
@May uncompress radiances from any radiometer(s)
@
text
@; This L2CF fragment deals with the uncompression of radiances
; $Id: retrievalmacros.l2cf,v 1.132 2009/04/09 20:38:25 pwagner Exp $

;;; Assumes that you have already defined appropriate triples for each
;;; radiometer you want to uncompress
;;; Do this by defining an array as the string value for the macro n amed
;;; for that particular radiometer
;;; e.g.
;;; !define(R1Aterms,{[0.01,250.0,3.0]})
;;;
;;;   macro        radiometer    Bands
;;;  R1Aterms        R1A       1,32,34,22
;;;  R2terms         R2        2,3,4,5,6
;;;  R3terms         R3        8,33
;;;  R4terms         R4        10,11,12,13,14
;;;  R5terms         R5        15,16,17



begin Construct
  !define(constructTotalPowerWeight,{band$1weight: Quantity, type=totalPowerWeight, signal=!signal($1)!nl})
  !forall(constructTotalPowerWeight,!allBands)
  !define(allTotalPowerWeights, {!makelist({band},{weight},!allBands)})
  totalPowerWeightsTemplate: VectorTemplate, quantities=[!allTotalPowerWeights]

  !define(constructTotalPower,{power$1: Quantity, type=baseline, fGrid=fGridBaseline$1, radiometer=$1!nl})
  !forall(constructTotalPower,!allRadiometers)  ; !allRadiometers)
  !define(allTotalPowers, {!makelist({power},{},!allRadiometers)}) ;!allRadiometers)})
  totalPowerTemplate: VectorTemplate, quantities=[!allTotalPowers]
end Construct

;; Compute the total power
begin fill
  totalPowerWeights: Vector, template=totalPowerWeightsTemplate
  totalPower: Vector, template=totalPowerTemplate

  !define(zeroTotalPowerWeight, {Fill, quantity=totalPowerWeights.band$1weight, method=explicit, explicitvalues=0, /spread !nl})
  !forall(zeroTotalPowerWeight, !allBands)

   Fill, quantity=totalPowerWeights.band1weight, method=explicit, explicitvalues = [ 596, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 596]
   Fill, quantity=totalPowerWeights.band32weight, method=explicit, explicitvalues = [750, 1250,  1350, 850]

   Fill, quantity=totalPowerWeights.band2weight, method=explicit, explicitvalues = [ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]
   Fill, quantity=totalPowerWeights.band3weight, method=explicit, explicitvalues = [  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0, 0, 0, 0,  0,  0, 24, 36, 48, 64, 64, 64, 96, 96,  0]
   Fill, quantity=totalPowerWeights.band4weight, method=explicit, explicitvalues = [ 446, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]
   Fill, quantity=totalPowerWeights.band5weight, method=explicit, explicitvalues = [ 246, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 446]
   Fill, quantity=totalPowerWeights.band6weight, method=explicit, explicitvalues = [ 246, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]


   Fill, quantity=totalPowerWeights.band7weight, method=explicit, explicitvalues = [ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]
   Fill, quantity=totalPowerWeights.band8weight, method=explicit, explicitvalues = [ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]
   Fill, quantity=totalPowerWeights.band9weight, method=explicit, explicitvalues = [ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]

   Fill, quantity=totalPowerWeights.band33weight, method=explicit, explicitvalues = [750, 750,  750, 750]

;R4 (these do not agree with Jarnot/perun because of normalization)
Fill, quantity=totalPowerWeights.band10weight, method=explicit, explicitvalues =[ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]
Fill, quantity=totalPowerWeights.band11weight, method=explicit, explicitvalues =[ 746, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
Fill, quantity=totalPowerWeights.band12weight, method=explicit, explicitvalues =[ 5496, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 746]
Fill, quantity=totalPowerWeights.band13weight, method=explicit, explicitvalues =[ 0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0,  0]
Fill, quantity=totalPowerWeights.band14weight, method=explicit, explicitvalues =[ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]

;for R5
Fill, quantity=totalPowerWeights.band15weight, method=explicit, explicitvalues =[ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 1164, 1164, 1164, 1196, 1196, 96]
Fill, quantity=totalPowerWeights.band16weight, method=explicit, explicitvalues =[ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 1164, 1164, 1196, 96, 96]
Fill, quantity=totalPowerWeights.band17weight, method=explicit, explicitvalues =[ 96, 96, 96, 64, 64, 64, 48, 36, 24, 16, 12, 8, 6, 8, 12, 16, 24, 36, 48, 64, 64, 64, 96, 96, 96]


  ComputeTotalPower, measurements=measurement, totalPowerVector=totalPower, weightsVector=totalPowerWeights

;DEBUG
dump, details=2, quantity=state.systemTemperature32
end fill

;; Uncompress the radiances
!ifdef(R1Aterms,{
;; R1 radiances
begin fill

  Fill, quantity=measurement.band1, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR1A, $
    terms=!R1Aterms, systemTemperature=state.systemTemperature1
  Fill, quantity=measurement.band32, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR1A, $
    terms=!R1Aterms, systemTemperature=state.systemTemperature32
  Fill, quantity=measurement.band34, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR1A, $
    terms=!R1Aterms, systemTemperature=state.systemTemperature34
  Fill, quantity=measurement.band22, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR1A, $
    terms=!R1Aterms, systemTemperature=state.systemTemperature22
end fill
})

;; Uncompress the radiances
!ifdef(R2terms,{
;; R2 radiances
begin fill

  Fill, quantity=measurement.band2, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR2, $
    terms=!R2terms, systemTemperature=state.systemTemperature2
  Fill, quantity=measurement.band3, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR2, $
    terms=!R2terms, systemTemperature=state.systemTemperature3
  Fill, quantity=measurement.band4, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR2, $
    terms=!R2terms, systemTemperature=state.systemTemperature4
  Fill, quantity=measurement.band5, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR2, $
    terms=!R2terms, systemTemperature=state.systemTemperature5
  Fill, quantity=measurement.band6, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR2, $
    terms=!R2terms, systemTemperature=state.systemTemperature6
end fill
})

!ifdef(R3terms,{
;; R3 radiances
begin fill
  Fill, quantity=measurement.band8, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR3, $
    terms=!R3terms, systemTemperature=state.systemTemperature8
  Fill, quantity=measurement.band33, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR3, $
    terms=!R3terms, systemTemperature=state.systemTemperature33
end fill
})

!ifdef(R4terms,{
;; R4 radiances
begin fill
  Fill, quantity=measurement.band10, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR4, $
    terms=!R4terms, systemTemperature=state.systemTemperature10
  Fill, quantity=measurement.band11, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR4, $
    terms=!R4terms, systemTemperature=state.systemTemperature11
  Fill, quantity=measurement.band12, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR4, $
    terms=!R4terms, systemTemperature=state.systemTemperature12
  Fill, quantity=measurement.band13, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR4, $
    terms=!R4terms, systemTemperature=state.systemTemperature13
  Fill, quantity=measurement.band14, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR4, $
    terms=!R4terms, systemTemperature=state.systemTemperature14
end fill
})

!ifdef(R5terms,{
;; R5 radiances
begin fill
  Fill, quantity=measurement.band15, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR5, $
    terms=!R5terms, systemTemperature=state.systemTemperature15
  Fill, quantity=measurement.band16, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR5, $
    terms=!R5terms, systemTemperature=state.systemTemperature16
  Fill, quantity=measurement.band17, method=uncompressRadiance, totalPowerQuantity=totalPower.powerR5, $
    terms=!R5terms, systemTemperature=state.systemTemperature17
end fill
})

; $Log: retrievalmacros.l2cf,v $
@


1.1
log
@Initial Check in.
@
text
@d2 15
a17 2
!ifdef(R1Aterms,{},{!define(R1Aterms,{[0.01,250.0,3.0]})})
!ifdef(R3terms,{},{!define(R3terms,{[0.03,250.0,3.0]})})
a26 2
 ; !forall(constructTotalPower,{R1A})  ; !allRadiometers)
 ; !forall(constructTotalPower,R1A,R3)  ; !allRadiometers)
a27 2
 ; !define(allTotalPowers, {!makelist({power},{},{R1A})}) ;!allRadiometers)})
 ; !define(allTotalPowers, {!makelist({power},{},R1A,R3)}) ;!allRadiometers)})
a71 2
;dump, details=2, quantity=state.systemTemperature3
;dump, details=0, template=totalPowerTemplate
d76 2
d88 24
d116 2
d119 25
d145 1
d147 1
@

