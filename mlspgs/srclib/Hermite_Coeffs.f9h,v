head	1.2;
access;
symbols
	v5-02-NRT-19:1.2
	v6-00:1.2
	v5-02-NRT-18:1.2
	v5-02:1.2
	v5-01-NRT-17:1.2
	v5-01-NRT-16:1.2
	v5-01-NRT-15:1.2
	v5-01-NRT-14:1.2
	neuralnetworks-1-0:1.2.0.14
	cfm-single-freq-0-1:1.2.0.12
	v5-01:1.2
	v5-00:1.2
	v4-23-TA133:1.2.0.10
	mus-emls-1-70:1.2.0.8
	rel-1-0-englocks-work:1.2.0.6
	VUMLS1-00:1.2
	VPL1-00:1.2
	V4-22-NRT-08:1.2
	VAM1-00:1.2
	V4-21:1.2.0.4
	V4-13:1.2
	V4-12:1.2
	V4-11:1.2
	V4-10:1.2
	V3-43:1.2
	M4-00:1.2
	V3-41:1.2
	V3-40-PlusGM57:1.2.0.2
	V2-24-NRT-04:1.2
	V3-33:1.2
	V2-24:1.2
	V3-31:1.2
	V3-30-NRT-05:1.2
	cfm-01-00:1.2
	V3-30:1.2
	V3-20:1.2
	V3-10:1.2
	V2-23-NRT-02:1.2
	V2-23:1.2
	V2-22-NRT-01:1.2
	V2-22:1.2
	V2-21:1.2
	V2-20:1.2
	V2-11:1.2
	V2-10:1.2;
locks; strict;
comment	@# @;


1.2
date	2006.07.31.20.02.41;	author vsnyder;	state Exp;
branches;
next	1.1;

1.1
date	2006.07.19.22.30.58;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


1.2
log
@Optimization
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

! $Id: Hermite_Coeffs.f9h,v 1.1 2006/07/19 22:30:58 vsnyder Exp $

! subroutine Hermite_Coeffs_* ( Funcs, Derivs, Coeffs )
  ! Given Funcs(0:n) and Derivs(0:n), compute Coeffs(0:3,1:n) of monomial
  ! basis polonomials that interpolate the given functions and derivatives
  ! in each of the N intervals.  Each interval is scaled on 0:1, so to
  ! compute f(xx) for x(i-1) <= xx <= x(i) use R = (xx-x(i-1))/(x(i)-x(i-1),
  ! then F = coeffs(0,i) + r*(coeffs(1,i) + r*(coeffs(2,i) + r*coeffs(3,i))).
    real(rk), intent(in), dimension(0:) :: Funcs, Derivs
    real(rk), intent(out), dimension(0:,1:) :: Coeffs

    real(rk) :: D ! funcs(i-1) - funcs(i)
    integer :: I  ! Index of interval, loop inductor

  !{ Starting with $p(x) = c_0 + c_1 x + c_2 x^2 + c_3 x^3$ and
  !  $p^\prime(x) = c_1 + 2 c_2 x + 3 c_3 x^2$, and evaluating
  !  $p(0)$, $p^\prime(0)$, $p(1)$ and $p^\prime(1)$ we have the
  !  following equation to solve:
  !  \begin{equation*}
  !  \left[ \begin{array}{llll}
  !   1 & 0 & 0 & 0 \\
  !   0 & 1 & 0 & 0 \\
  !   1 & 1 & 1 & 1 \\
  !   0 & 1 & 2 & 3 \\ \end{array} \right]
  !  \left[ \begin{array}{l}
  !   c_0 \\
  !   c_1 \\
  !   c_2 \\
  !   c_3 \\ \end{array} \right] =
  !  \left[ \begin{array}{l}
  !   p(0) \\
  !   p^\prime(0) \\
  !   p(1) \\
  !   p^\prime(1) \\ \end{array} \right]
  !   \text{ or }
  !  \left[ \begin{array}{l}
  !   c_0 \\
  !   c_1 \\
  !   c_2 \\
  !   c_3 \\ \end{array} \right] =
  !  \left[ \begin{array}{l}
  !   p(0) \\
  !   p^\prime(0) \\
  !   -3 p(0) + 3 p(1) - 2 p^\prime(0) - p^\prime(1) \\
  !   2 p(0) - 2 p(1) + p^\prime(0) + p^\prime(1) \\ \end{array} \right]
  !  \end{equation*}

    do i = 1, ubound(funcs,1)
      coeffs(0,i) = funcs(i-1)
      coeffs(1,i) = derivs(i-1)
      d = funcs(i-1) - funcs(i)
      coeffs(3,i) = d + d + derivs(i-1) + derivs(i)
      coeffs(2,i) = -(coeffs(3,i) + d + derivs(i-1))
    end do

! end subroutine Hermite_Coeffs_*

! $Log: Hermite_Coeffs.f9h,v $
! Revision 1.1  2006/07/19 22:30:58  vsnyder
! Initial commit
!
@


1.1
log
@Initial commit
@
text
@d12 1
a12 1
! $Id: $
d23 2
a24 1
    integer :: I ! Index of interval
d62 3
a64 4
      coeffs(2,i) = -3.0_rk * funcs(i-1) + 3.0_rk * funcs(i) &
        &           -2.0_rk * derivs(i-1) -         derivs(i)
      coeffs(3,i) = +2.0_rk * funcs(i-1) - 2.0_rk * funcs(i) &
        &           +         derivs(i-1) +         derivs(i)
d69 4
a72 1
! $Log: $
@

