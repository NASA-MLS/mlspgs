head	1.1;
access;
symbols
	v5-02-NRT-19:1.1
	v6-00:1.1
	v5-02-NRT-18:1.1
	v5-02:1.1
	v5-01-NRT-17:1.1
	v5-01-NRT-16:1.1
	v5-01-NRT-15:1.1
	v5-01-NRT-14:1.1
	neuralnetworks-1-0:1.1.0.14
	cfm-single-freq-0-1:1.1.0.12
	v5-01:1.1
	v5-00:1.1
	v4-23-TA133:1.1.0.10
	mus-emls-1-70:1.1.0.8
	rel-1-0-englocks-work:1.1.0.6
	VUMLS1-00:1.1
	VPL1-00:1.1
	V4-22-NRT-08:1.1
	VAM1-00:1.1
	V4-21:1.1.0.4
	V4-13:1.1
	V4-12:1.1
	V4-11:1.1
	V4-10:1.1
	V3-43:1.1
	M4-00:1.1
	V3-41:1.1
	V3-40-PlusGM57:1.1.0.2
	V2-24-NRT-04:1.1
	V3-33:1.1
	V2-24:1.1
	V3-31:1.1
	V3-30-NRT-05:1.1
	cfm-01-00:1.1
	V3-30:1.1
	V3-20:1.1
	V3-10:1.1
	V2-23-NRT-02:1.1
	V2-23:1.1
	V2-22-NRT-01:1.1
	V2-22:1.1
	V2-21:1.1
	V2-20:1.1
	V2-11:1.1
	V2-10:1.1
	V2-00:1.1
	V1-51:1.1
	V1-50:1.1
	V1-45:1.1
	V1-44:1.1
	V1-43:1.1;
locks; strict;
comment	@# @;


1.1
date	2004.01.23.18.18.09;	author pwagner;	state Exp;
branches;
next	;


desc
@@


1.1
log
@First commit
@
text
@!=================================
PROGRAM sleeper ! tests how date_and_time behaves crossing midnight
!=================================

   USE MLSCommon , ONLY: r8
   use OUTPUT_M, only: BLANKS, OUTPUT, PRUNIT
   use time_m, only: SET_STARTTIME, TIME_NOW, USE_WALL_CLOCK

   IMPLICIT NONE

!------------------- RCS Ident Info -----------------------
   CHARACTER(LEN=130) :: Id = &                                                    
   "$Id: hhmmss_value_text.f90,v 1.1 2002/02/19 23:28:19 pwagner Exp $"
   CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: hhmmss_value_text.f90,v $"
!----------------------------------------------------------

! Brief description of program
! This program sleeps for 10 minutes, prints date_and_time data, then repeats

! To use this, copy it into
! mlspgs/tests/lib
! then enter "make depends" followed by "make"


! Then run it, entering quote-surrounded strings of chars; a blank line terminates

! Variables

   ! The following arrys contains the maximum permissible day for each month
   ! where month=-1 means the whole year, month=1..12 means Jan, .., Dec
   integer, dimension(-1:12), parameter :: DAYMAXLY = (/ &
     & 366, 0, 31, 29, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 &
     & /)
   integer, dimension(-1:12), parameter :: DAYMAXNY = (/ &
     & 365, 0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 &
     & /)

   INTEGER, PARAMETER :: MAXLISTLENGTH=8
   INTEGER, PARAMETER :: ntimesteps=60  ! How many 10 minute intervals this will do that
   INTEGER, PARAMETER :: udelay=500000  ! corresponds to 1/2 second
	CHARACTER (LEN=MAXLISTLENGTH) :: date
	LOGICAL, PARAMETER :: strict = .false.
   real :: t1, t2
   integer :: mydaysoff
   integer :: timesteps
   logical, parameter :: total_times = .true.
   integer, dimension(8) :: values
   integer, dimension(8) :: dvalues
   character(len=80) :: switches, tempSwitches
   character(len=8) :: badSwitch
   character(len=2) :: quotes
   quotes = char(34) // char(39)
! Now test time_now function
  USE_WALL_CLOCK = .true.
  call time_now(t1)
  call output ( "Starting time  = " )
  call output ( dble(t1), advance = 'yes' )
  
  do timesteps=1, ntimesteps
    call take_ten
    call saytime
    call time_now(t1)
  enddo

contains

  subroutine take_ten 
  ! Sleep for 10 minutes
  integer :: timesteps
  integer, parameter :: ntimesteps = 20*60
  do timesteps=1, ntimesteps
    call usleep(udelay)
  enddo
  end subroutine take_ten

  subroutine SayTime ( values )
    integer, dimension(8), intent(in), optional :: values
    integer, dimension(8) :: myvalues
    call time_now ( t2, values )
    if ( present(values) ) then
      call output ( "(values: " )
      call output ( values, advance = 'no' )
      call output ( ")" )
      call blanks ( 2, advance = 'no' )
    endif
    if ( total_times ) then
      call output ( "Total time = " )
      call output ( dble(t2), advance = 'no' )
      call blanks ( 4, advance = 'no' )
    endif
    call output ( "increment  = " )
    call output ( dble(t2 - t1), advance = 'yes' )
    call date_and_time(date=date, values=myvalues)
    call output ( "(values: " )
    call output ( myvalues, advance = 'no' )
    call output ( ")" )
    call blanks ( 2, advance = 'no' )
    call output ( 'date: ' // date, advance = 'yes' )
  end subroutine SayTime
!==================
END PROGRAM sleeper
!==================

! $Log: hhmmss_value_text.f90,v $
@
