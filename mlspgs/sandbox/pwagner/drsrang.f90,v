head	1.1;
access;
symbols
	v5-02-NRT-19:1.1
	v6-00:1.1
	v5-02-NRT-18:1.1
	v5-02:1.1
	v5-01-NRT-17:1.1
	v5-01-NRT-16:1.1
	v5-01-NRT-15:1.1
	v5-01-NRT-14:1.1
	neuralnetworks-1-0:1.1.0.16
	cfm-single-freq-0-1:1.1.0.14
	v5-01:1.1
	v5-00:1.1
	v4-23-TA133:1.1.0.12
	mus-emls-1-70:1.1.0.10
	rel-1-0-englocks-work:1.1.0.8
	VUMLS1-00:1.1
	VPL1-00:1.1
	V4-22-NRT-08:1.1
	VAM1-00:1.1
	V4-21:1.1.0.6
	V4-13:1.1
	V4-12:1.1
	V4-11:1.1
	V4-10:1.1
	V3-43:1.1
	M4-00:1.1
	V3-41:1.1
	V3-40-PlusGM57:1.1.0.4
	V2-24-NRT-04:1.1
	V3-33:1.1
	V2-24:1.1
	V3-31:1.1
	V3-30-NRT-05:1.1
	cfm-01-00:1.1
	V3-30:1.1
	V3-20:1.1
	V3-10:1.1
	V2-23-NRT-02:1.1
	V2-23:1.1
	V2-22-NRT-01:1.1
	V2-22:1.1
	V2-21:1.1
	V2-20:1.1
	V2-11:1.1
	V2-10:1.1
	V2-00:1.1
	V1-51:1.1
	V1-50:1.1
	V1-45:1.1
	V1-44:1.1
	V1-43:1.1
	V1-42:1.1
	V1-41:1.1
	V1-32:1.1
	V1-40:1.1
	V1-31:1.1
	V1-13:1.1
	V1-12:1.1
	V1-11:1.1
	V1-10:1.1
	newfwm-feb03:1.1.0.2
	V1-04:1.1
	V1-03:1.1
	V1-02:1.1
	V1-00:1.1;
locks; strict;
comment	@# @;


1.1
date	2001.11.09.21.53.32;	author pwagner;	state Exp;
branches;
next	;


desc
@@


1.1
log
@First commit
@
text
@! Copyright (c) 2001, California Institute of Technology.  ALL RIGHTS RESERVED.
! U.S. Government Sponsorship under NASA Contract NAS7-1407 is acknowledged.

program drsrang

  ! Demonstration driver for srang

  use MLSRandomNumber, only: MLS_RANDOM_SEED, SRANG
  use MLSStrings, only: LowerCASE

!---------------------------- RCS Ident Info -------------------------------
  character (len=*), parameter :: IdParm = &
       "$Id: drsrang.f90,v 1.5 2001/07/25 19:57:30 vsnyder Exp $"
  character (len=len(idParm)) :: Id = idParm
  character (len=*), parameter :: ModuleName = "$RCSfile: drsrang.f90,v $"
!---------------------------------------------------------------------------

  logical, parameter :: RANDOMRESTARTS = .false.
  logical, parameter :: READMYSEED = .true.
  logical, parameter :: ASKTOUSEINTRINSIC = .true.
  character(LEN=1)   :: answer
  integer :: seed(2), count, values(8)
  integer, parameter :: NCELLS = 12+2
  integer, parameter :: N = 10000
  real, parameter :: zero = 0.0
  real, parameter :: y1=-3.0, y2=3.0
  real :: stats(5), ytab(1)
  integer :: ihist(ncells)
!
if ( ASKTOUSEINTRINSIC ) then
   print*, 'Do you want mls_random_number switch to using f95 intrinsic?(y/n)'
   print*, '(Otherwise, I will use MATH77-derived methods)'
   read *, answer
   if ( LowerCase(answer) == 'y' ) then
      call MLS_RANDOM_SEED( MATH77_ranpack=.false. )
      print *, 'Switching to intrinsic random_number'
   endif
endif

if ( READMYSEED ) then
   print*, 'Please enter two integers to be used in forming seed'
   print*, '(if both 0, I will use default seed)'
   print*, '(if exactly one 0, I will let mls_random_seed choose seed)'
   print*, '(if neither 0, I will use your seed)'
   read *, seed
   if ( seed(1) /= 0 .and. seed(2) /= 0 ) then
      call MLS_RANDOM_SEED( pput=seed )
   elseif ( seed(1) == 0 .and. seed(2) == 0 ) then
      call MLS_RANDOM_SEED( gget=seed )
      print *, 'using default seed ', seed
!   elseif ( seed(1) /= 0 .or. seed(2) /= 0 ) then
   else
      call MLS_RANDOM_SEED( new_seed=seed )
      print *, 'new seed ', seed
   endif
endif
stats(1) = zero
do i=1, N
  if ( RANDOMRESTARTS .and. i > 1 .and. mod(i-1, 97)==0 ) &
    & call MLS_RANDOM_SEED()
  ytab(1) = srang()
  call sstat1(ytab(1), 1, stats, ihist, ncells, y1, y2)
enddo

call date_and_time(values=values)
call system_clock(count=count)
print *, 'date and time millisec ', values(8)
print *, 'system_clock count ', count
print *, 'Enforcing random restarts from same seed? ', RANDOMRESTARTS
print *, 'Gaussian random numbers from srang()'
call sstat2(stats, ihist, ncells, y1, y2)  
end program drsrang

! $Log: drsrang.f90,v $
@
