head	1.2;
access;
symbols
	V0_1:1.1;
locks; strict;
comment	@# @;


1.2
date	2001.01.31.01.14.51;	author zvi;	state dead;
branches;
next	1.1;

1.1
date	2000.06.21.21.56.12;	author zvi;	state Exp;
branches;
next	;


desc
@@


1.2
log
@No longer needed
@
text
@module EARTH_INTERSECTION_M
  use ELLIPSE, only: A2, CPS, CPTS, C2, C2OA2, EARTHX, HT, NPHI_S, &
                     PHI_S, PHI_TAN, ROC, SPS, SPTS
  use MLSCommon, only: R8
  implicit NONE
  private
  public :: Earth_Intersection
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: earth_intersection_m.f90,v 1.1 2000/06/21 21:56:12 zvi Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= &
       "$RCSfile: earth_intersection_m.f90,v $"
!---------------------------------------------------------------------------
contains
! This routine solves for the Phi_s and Rs for Earth intersection case.
!  ** Note: This routine is using The Equivalent Circle concept
!
  Subroutine Earth_Intersection ( Rs )
    real(r8), intent(out) :: RS
!
    real(r8) :: V
    EarthX = .true.            ! Set Earth Intersecting Ray flag
!
    Phi_s = Phi_tan - Acos( (ht+RoC)/RoC )
    sps = Sin(Phi_s)
    cps = Cos(Phi_s)
    NPhi_s = a2 / Sqrt(a2*cps*cps + c2*sps*sps)
    v = 2.0_r8 * Phi_s - Phi_tan
    spts = Sin(v)
    cpts = Cos(v)
!
    v = c2oa2 * sps
    Rs = NPhi_s * Sqrt(cps*cps + v*v)
!
    Return
  End Subroutine Earth_Intersection
end module EARTH_INTERSECTION_M
! $Log: earth_intersection_m.f90,v $
! Revision 1.1  2000/06/21 21:56:12  zvi
! First version D.P.
!
! Revision 1.1  2000/05/04 18:12:05  vsnyder
! Initial conversion to Fortran 90
!
@


1.1
log
@First version D.P.
@
text
@d10 1
a10 1
       "$Id: earth_intersection_m.f90,v 1.1 2000/05/04 18:12:05 vsnyder Exp $"
d39 3
@

