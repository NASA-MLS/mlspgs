head	1.3;
access;
symbols
	V0_1:1.1;
locks; strict;
comment	@# @;


1.3
date	2001.01.31.01.14.50;	author zvi;	state dead;
branches;
next	1.2;

1.2
date	2000.08.16.01.02.22;	author zvi;	state Exp;
branches;
next	1.1;

1.1
date	2000.06.21.21.56.09;	author zvi;	state Exp;
branches;
next	;


desc
@@


1.3
log
@No longer needed
@
text
@module AITKEN_INT_M
  use D_CSPLINE_M, only: CSPLINE
  use DAITKEN_MODULE, only: AITKEN
  use DSIMPSON_MODULE, only: SIMPS
  use MLSCommon, only: I4, R4, R8
  implicit NONE
  private
  public :: Aitken_int
!---------------------------- RCS Ident Info -------------------------------
  CHARACTER (LEN=256) :: Id = &
       "$Id: aitken_int_m.f90,v 1.2 2000/08/16 01:02:22 zvi Exp $"
  CHARACTER (LEN=*), PARAMETER :: ModuleName= "$RCSfile: aitken_int_m.f90,v $"
!---------------------------------------------------------------------------
contains
  Function Aitken_int (F_GRID, F_GRID_FLTR, FLTR_FUNC, RAD, JP, NFP, IER)
    real(r8) :: Aitken_int
    real(r8), intent(in) :: F_GRID(:)
    real(r8) :: F_GRID_FLTR(*)
    real(r8), intent(in) :: FLTR_FUNC(:)
    real(r8), intent(in) :: RAD(:)
    integer(i4), intent(in) :: JP
    integer(i4), intent(in) :: NFP
    integer(i4), intent(out) :: IER
    Integer(i4) :: N, KZ, JUMP
    Integer(i4), Parameter :: M = 161       ! For 161 maxfiltpts
    Real(r8) :: A(3)
    Real(r8) :: RXF(m), TMPARY(m), TMPF(m), DF
    ier = 2000
    if ( nfp > m ) then
      Print *, '** Error in subroutine Aitken_Int !'
      Print *, '   Number of filter points too large:', nfp
      Print *, '   Maximum allowed:', m
      Return
    endif
    ier = 0
    jump = 1
    df = f_grid_fltr(2) - f_grid_fltr(1)
    do kz = 1, 3
      n = jp/jump
      tmpf(1:n) = f_grid(1:jp:jump)
      rxf(1:n) = rad(1:jp:jump)
      Call Cspline ( tmpf, f_grid_fltr, rxf, tmpary, n, nfp )
      rxf = tmpary * fltr_func
      Call Simps ( rxf, df, nfp, a(kz) )
      jump = 2 * jump
    end do
    Aitken_int = Aitken(a(3),a(2),a(1))
    Return
  End Function Aitken_int
end module AITKEN_INT_M
! $Log: aitken_int_m.f90,v $
! Revision 1.2  2000/08/16 01:02:22  zvi
! Correcting array bounds erros in calling seq. SUN & SGI f90 pass on these
!
! Revision 1.1  2000/06/21 21:56:09  zvi
! First version D.P.
!
! Revision 1.1  2000/05/04 18:12:04  vsnyder
! Initial conversion to Fortran 90
!
@


1.2
log
@Correcting array bounds erros in calling seq. SUN & SGI f90 pass on these
@
text
@d11 1
a11 1
       "$Id: aitken_int_m.f90,v 1.1 2000/06/21 21:56:09 zvi Exp $"
d52 3
@


1.1
log
@First version D.P.
@
text
@d11 1
a11 1
       "$Id: aitken_int_m.f90,v 1.1 2000/05/04 18:12:04 vsnyder Exp $"
d17 1
a17 1
    real(r8), intent(in) :: F_GRID(*)
d19 2
a20 2
    real(r8), intent(in) :: FLTR_FUNC(nfp)
    real(r8), intent(in) :: RAD(*)
d27 1
a27 1
    Real(r8) :: RXF(nfp), TMPARY(nfp), TMPF(m), DF
d52 3
@

