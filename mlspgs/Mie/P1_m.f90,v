head	1.3;
access;
symbols
	v5-02-NRT-19:1.3
	v6-00:1.3
	v5-02-NRT-18:1.3
	v5-02:1.3
	v5-01-NRT-17:1.3
	v5-01-NRT-16:1.3
	v5-01-NRT-15:1.3
	v5-01-NRT-14:1.3
	neuralnetworks-1-0:1.3.0.12
	cfm-single-freq-0-1:1.3.0.10
	v5-01:1.3
	v5-00:1.3
	v4-23-TA133:1.3.0.8
	mus-emls-1-70:1.3.0.6
	rel-1-0-englocks-work:1.3.0.4
	VUMLS1-00:1.3
	VPL1-00:1.3
	V4-22-NRT-08:1.3
	VAM1-00:1.3
	V4-21:1.3.0.2
	V4-13:1.3
	V4-12:1.3
	V4-11:1.3
	V4-10:1.3
	V3-43:1.2
	M4-00:1.2
	V3-41:1.2
	V3-40-PlusGM57:1.2.0.2
	V3-33:1.2
	V3-31:1.2
	V3-30-NRT-05:1.2
	cfm-01-00:1.2
	V3-30:1.2
	V3-20:1.2
	V3-10:1.2;
locks; strict;
comment	@# @;


1.3
date	2013.12.20.19.52.01;	author vsnyder;	state Exp;
branches;
next	1.2;

1.2
date	2009.07.06.22.08.38;	author vsnyder;	state Exp;
branches;
next	1.1;

1.1
date	2008.04.19.01.15.27;	author vsnyder;	state Exp;
branches;
next	;


desc
@@


1.3
log
@Repair some LaTeX
@
text
@! Copyright 2005, by the California Institute of Technology. ALL
! RIGHTS RESERVED. United States Government Sponsorship acknowledged. Any
! commercial use must be negotiated with the Office of Technology Transfer
! at the California Institute of Technology.

! This software may be subject to U.S. export control laws. By accepting this
! software, the user agrees to comply with all applicable U.S. export laws and
! regulations. User has the responsibility to obtain export licenses, or other
! export authority as may be required before exporting such information to
! foreign countries or providing access to foreign persons.

module P1_m

  implicit NONE

  private

  public Coeffs, Compute_P1, Compute_P1_Derivs

!---------------------------- RCS Module Info ------------------------------
  character (len=*), private, parameter :: ModuleName= &
       "$RCSfile: P1_m.f90,v $"
  private :: not_used_here
!---------------------------------------------------------------------------

contains

  pure subroutine Coeffs ( C1, C2, W )

  ! Compute the coefficients C1(j) = (2*j-1)/(j-1),
  !                          C2(j) = j/(j-1)
  !                          W(j) = (2*j+1)/(j*(j+1)) = C1(j+1)/(j+1)

  ! C1 and C2 are used to compute Legendre functions of the first
  ! kind and degree 1, divided by sin(theta), using
  ! P1(0) = 0, P1(1) = 1, P1(j) = C1(j)*P1(j-1)*cos(theta) - C2(j)*P1(j-2)

  ! W is used to compute the scattering phase functions.

    use MLSKinds, only: RK => R8

    real(rk), intent(out) :: C1(2:), C2(2:), W(:) ! Assumed all the same ubound

    integer :: J

    w(1) = 1.5
    do j = 2, ubound(c1,1)
      c1(j) = (2*j-1.0_rk)/(j-1.0_rk)
      c2(j) = j/(j-1.0_rk)
      w(j) = (2*j+1.0_rk)/(j*(j+1.0_rk))
    end do

  end subroutine Coeffs

  pure subroutine Compute_P1 ( C1, C2, theta, P1 )

  !{ Evaluate Legendre functions of the first kind and degree 1,
  ! $P_j^1/\sin\theta$, using
  ! P1(0) = 0, P1(1) = 1, P1(j) = C1(j)*P1(j-1)*cos(theta) - C2(j)*P1(j-2)
  ! where P1(j) is $P_j^1(\cos\theta)$.

    use MLSKinds, only: RK => R8

    real(rk), intent(in) :: C1(2:), C2(2:) ! From Coeffs
    real(rk), intent(in) :: Theta
    real(rk), intent(out) :: P1(0:) ! Assumed same upper bound as C1 and C2

    integer :: J
    real(rk) :: CT

    ct = cos(theta)
    P1(0) = 0.0
    P1(1) = 1.0
    do j = 2, ubound(c1,1)
      P1(j) = c1(j) * P1(j-1) * ct - c2(j) * P1(j-2)
    end do

  end subroutine Compute_P1

  pure subroutine Compute_P1_Derivs ( C1, C2, theta, P1, dP1_dTheta )

  !{ Evaluate Legendre functions of the first kind and degree 1,
  ! $P_j^1/\sin\theta$, using
  ! $P1(0) = 0, P1(1) = 1, P1(j) = C1(j) P1(j-1) \cos(\theta) - C2(j) P1(j-2)$
  ! where $P1(j)$ is $P_j^1(\cos\theta)$.  Evaluate their derivatives using
  ! $dP_j^1 (\cos(\theta))/d\theta = j \cos(\theta) P(j) - (j+1) P(j-1)$

    use MLSKinds, only: RK => R8

    real(rk), intent(in) :: C1(2:), C2(2:) ! From Coeffs
    real(rk), intent(in) :: Theta
    real(rk), intent(out) :: P1(0:) ! Assumed same upper bound as C1 and C2
    real(rk), intent(out) :: dP1_dTheta(:)

    integer :: J
    real(rk) :: CT

    ct = cos(theta)
    P1(0) = 0.0
    P1(1) = 1.0
    dP1_dTheta(1) = ct
    do j = 2, ubound(c1,1)
      P1(j) = c1(j) * P1(j-1) * ct - c2(j) * P1(j-2)
      dP1_dTheta(j) = j * ct * P1(j) - (j+1) * P1(j-1)
    end do

  end subroutine Compute_P1_Derivs

  logical function not_used_here()
!---------------------------- RCS Ident Info -------------------------------
  character (len=*), parameter :: IdParm = &
       "$Id: P1_m.f90,v 1.2 2009/07/06 22:08:38 vsnyder Exp $"
  character (len=len(idParm)), save :: Id = idParm
!---------------------------------------------------------------------------
    not_used_here = (id(1:1) == ModuleName(1:1))
    print *, id ! .mod files sometimes change if PRINT is added
  end function not_used_here

end module P1_m

! $Log: P1_m.f90,v $
! Revision 1.2  2009/07/06 22:08:38  vsnyder
! Added print to not_used_here to preserve Id
!
! Revision 1.1  2008/04/19 01:15:27  vsnyder
! Initial commit
!
@


1.2
log
@Added print to not_used_here to preserve Id
@
text
@d84 3
a86 3
  ! P1(0) = 0, P1(1) = 1, P1(j) = C1(j)*P1(j-1)*cos(theta) - C2(j)*P1(j-2)
  ! where P1(j) is $P_j^1(\cos\theta)$.  Evaluate their derivatives using
  ! dP_j^1(cos(theta))/dTheta = j*cos(theta)*P(j) - (j+1)*P(j-1)
d112 1
a112 1
       "$Id: P1_m.f90,v 1.1 2008/04/19 01:15:27 vsnyder Exp $"
d122 3
@


1.1
log
@Initial commit
@
text
@d22 1
a22 1
       "$RCSfile: RefractiveIndex.f90,v $"
d112 1
a112 1
       "$Id: RefractiveIndex.f90,v 2.4 2007/10/05 23:59:54 vsnyder Exp $"
d116 1
d121 4
a124 1
! $Log: $
@

